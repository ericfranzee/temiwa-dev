"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[8330],{80905:(e,l,i)=>{i.d(l,{j:()=>r});var t=i(9950),n=i(95491),a=i.n(n),d=i(99674),s=i(90650),o=i(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:i=400,hasMore:n,...r}=e;const[u,c]=(0,t.useState)(!1),[v,h]=(0,t.useState)([]),[g,p]=(0,t.useState)(!1),[A,x]=(0,t.useState)(null),[j,y]=(0,t.useState)(1),m=(0,t.useMemo)((()=>a()((e=>{h([]),x(e),c(!0),l({search:e}).then((e=>{h(e),y(2),c(!1)})).finally((()=>p(!1)))}),i)),[l,i,j]);return(0,o.jsxs)(d.A,{showSearch:!0,allowClear:!0,onPopupScroll:async e=>{const i=e.target;g||i.scrollTop+i.offsetHeight!==i.scrollHeight||n&&(p(!0),i.scrollTo(0,i.scrollHeight),l({search:A,page:j}).then((e=>{y((e=>e+1)),h([...v,...e])})).finally((()=>p(!1))))},labelInValue:!0,filterOption:!1,onSearch:m,notFoundContent:u?(0,o.jsx)(s.A,{size:"small"}):"no results",onFocus:()=>{v.length||m("")},...r,children:[v.map(((e,l)=>(0,o.jsx)(d.A.Option,{value:e.value,children:e.label},l))),g&&(0,o.jsx)(d.A.Option,{children:(0,o.jsx)(s.A,{size:"small"})})]})}},8297:(e,l,i)=>{i.d(l,{A:()=>o});var t=i(9950),n=i(55902),a=i(41397),d=i(60767),s=i(44414);function o(e){let{handleChange:l,defaultValue:i,resetSearch:o,...r}=e;const[u,c]=(0,t.useState)(i),v=(0,t.useMemo)((()=>(0,a.debounce)((e=>{l(e)}),800)),[]);return(0,t.useEffect)((()=>{c(i)}),[o]),(0,s.jsx)(n.A,{value:u,onChange:e=>{c(e.target.value),v(e.target.value)},prefix:(0,s.jsx)(d.A,{}),...r})}},68330:(e,l,i)=>{i.r(l),i.d(l,{default:()=>M});var t=i(9950),n=i(25933),a=i(80737),d=i(48538),s=i(23263),o=i(52913),r=i(55386),u=i(91854),c=i(74623),v=i(85923),h=i(70030),g=i(12400),p=i(8297),A=i(88986),x=i(64988),j=i(42074),y=i(59233),m=i(82706),f=i(90650),b=i(87094),S=i(41988),_=i(55902),k=i(71999),C=i(78687),I=i(80905),O=i(82206),w=i(2905),q=i(44414);function V(e){let{visible:l,setVisible:i,id:a,setId:s}=e;const[o]=y.A.useForm(),r=(0,u.wA)(),{t:c}=(0,h.B)(),{defaultLang:p,languages:A}=(0,u.d4)((e=>e.formLang),u.bN),[j,V]=(0,t.useState)(!1),[z,F]=(0,t.useState)(!1),[M,B]=(0,t.useState)(null),N=()=>{B(null),i(!1),o.resetFields(),s(null)};function R(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,i=A.map((e=>{var i;return{["title[".concat(null===e||void 0===e?void 0:e.locale,"]")]:null===(i=l.find((l=>(null===l||void 0===l?void 0:l.locale)===(null===e||void 0===e?void 0:e.locale))))||void 0===i?void 0:i.title}}));return Object.assign({},...i)}return(0,t.useEffect)((()=>{a&&(F(!0),x.A.show(a).then((e=>{var l,i,t,n,a,d,s,r,u;let{data:c}=e;B(c),o.setFieldsValue({active:null===c||void 0===c?void 0:c.active,country_id:{label:null===c||void 0===c||null===(l=c.country)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title,value:null===c||void 0===c||null===(t=c.country)||void 0===t?void 0:t.id},region_id:{label:null===c||void 0===c||null===(n=c.region)||void 0===n||null===(a=n.translation)||void 0===a?void 0:a.title,value:null===c||void 0===c||null===(d=c.region)||void 0===d?void 0:d.id},city_id:{label:null===c||void 0===c||null===(s=c.city)||void 0===s||null===(r=s.translation)||void 0===r?void 0:r.title,value:null===c||void 0===c||null===(u=c.city)||void 0===u?void 0:u.id},...R(c)})})).finally((()=>F(!1))))}),[a]),(0,q.jsx)(m.A,{visible:l,onCancel:N,onOk:N,footer:null,loading:z,title:c("add.area"),children:(0,q.jsxs)(y.A,{form:o,onFinish:e=>{var l,i,t;V(!0);const n={country_id:null===e||void 0===e||null===(l=e.country_id)||void 0===l?void 0:l.value,region_id:null===e||void 0===e||null===(i=e.region_id)||void 0===i?void 0:i.value,city_id:null===e||void 0===e||null===(t=e.city_id)||void 0===t?void 0:t.value,active:e.active,title:{...Object.assign({},...A.map((l=>({[l.locale]:e["title[".concat(l.locale,"]")]}))))}};null!==M&&void 0!==M&&M.id?(e=>{x.A.update(M.id,e).then((()=>{v.oR.success(c("successfully.updated")),(0,u.vA)((()=>{r((0,g.S)({}))})),N()})).finally((()=>V(!1)))})(n):(e=>{x.A.create(e).then((()=>{v.oR.success(c("successfully.added")),(0,u.vA)((()=>{r((0,g.S)({}))})),N()})).finally((()=>V(!1)))})(n)},layout:"vertical",initialValues:{active:!0},children:[(0,q.jsx)(f.A,{spinning:z,children:(0,q.jsxs)(b.A,{gutter:24,children:[(0,q.jsx)(S.A,{span:24,children:(0,q.jsx)(k.A,{})}),(0,q.jsx)(S.A,{span:24,children:A.map((e=>(0,q.jsx)(y.A.Item,{label:c("title"),name:"title[".concat(e.locale,"]"),hidden:e.locale!==p,rules:[{required:(null===e||void 0===e?void 0:e.locale)===p,message:c("required")}],children:(0,q.jsx)(_.A,{})},"title"+e.id)))}),(0,q.jsx)(S.A,{span:24,children:(0,q.jsx)(y.A.Item,{name:"region_id",label:c("region_id"),rules:[{required:!0,message:c("required")}],children:(0,q.jsx)(I.j,{fetchOptions:e=>{let{search:l,page:i}=e;return w.A.get({search:null!==l&&void 0!==l&&l.length?l:void 0,page:i}).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))))}})})}),(0,q.jsx)(S.A,{span:24,children:(0,q.jsx)(y.A.Item,{name:"country_id",label:c("country_id"),rules:[{required:!0,message:c("required")}],children:(0,q.jsx)(I.j,{fetchOptions:e=>{let{search:l,page:i}=e;return C.A.get({search:null!==l&&void 0!==l&&l.length?l:void 0,page:i}).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))))}})})}),(0,q.jsx)(S.A,{span:24,children:(0,q.jsx)(y.A.Item,{name:"city_id",label:c("city_id"),rules:[{required:!0,message:c("required")}],children:(0,q.jsx)(I.j,{fetchOptions:e=>{let{search:l,page:i}=e;return O.A.get({search:null!==l&&void 0!==l&&l.length?l:void 0,page:i}).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))))}})})}),(0,q.jsx)(S.A,{span:4,children:(0,q.jsx)(y.A.Item,{label:c("active"),name:"active",valuePropName:"checked",children:(0,q.jsx)(n.A,{defaultChecked:!0})})})]})}),(0,q.jsx)(d.A,{type:"primary",htmlType:"submit",loading:j,children:c("submit")})]})})}var z=i(24513),F=i(44070);const M=()=>{const{t:e}=(0,h.B)(),l=(0,u.wA)();let[i,y]=(0,j.ok)();const{setIsModalVisible:m}=(0,t.useContext)(r.o),{activeMenu:f}=(0,u.d4)((e=>e.menu),u.bN),b=null===f||void 0===f?void 0:f.data,S=i.get("city_id"),{list:_,meta:k,loading:C}=(0,u.d4)((e=>e.deliveryArea),u.bN),[I,O]=(0,t.useState)(!1),[w,M]=(0,t.useState)(!1),[B,N]=(0,t.useState)(!1),[R,T]=(0,t.useState)(null),E=[{title:e("id"),dataIndex:"id",key:"id"},{title:e("name"),dataIndex:"translation",key:"translation",render:(e,l)=>(null===e||void 0===e?void 0:e.title)||"-"},{title:e("active"),dataIndex:"active",key:"active",render:(i,t)=>(0,q.jsx)(n.A,{onChange:()=>(i=>{O(i),x.A.status(i).then((()=>{m(!1),l((0,g.S)({city_id:S})),v.oR.success(e("successfully.updated"))})).finally((()=>{O(null)}))})(t.id),checked:i,loading:Boolean(I===t.id)},t.id)},{title:e("options"),dataIndex:"options",is_show:!0,render:(i,t)=>(0,q.jsxs)(a.A,{children:[(0,q.jsx)(d.A,{type:"primary",icon:(0,q.jsx)(z.A,{}),onClick:()=>(e=>{M(!0),T(e)})(t.id)}),(0,q.jsx)(d.A,{loading:Boolean(B===t.id),icon:(0,q.jsx)(F.A,{onClick:()=>(i=>{N(i),x.A.delete(i).then((()=>{l((0,g.S)()),v.oR.success(e("successfully.deleted"))})).finally((()=>{N(!1)}))})(t.id)})})]})}];(0,t.useEffect)((()=>{f.refetch&&(l((0,g.S)({city_id:S})),l((0,c.km)(f)))}),[f.refetch]),(0,A.A)((()=>{const e={search:null===b||void 0===b?void 0:b.search,city_id:S};l((0,g.S)(e))}),[null===f||void 0===f?void 0:f.data]);return(0,q.jsxs)(s.A,{title:e("areas"),extra:(0,q.jsxs)(a.A,{children:[(0,q.jsx)(p.A,{placeholder:e("search"),handleChange:e=>{return i=e,t="search",void l((0,c.Ok)({activeMenu:f,data:{...b,[t]:i}}));var i,t},defaultValue:null===b||void 0===b?void 0:b.search,resetSearch:!(null!==b&&void 0!==b&&b.search)}),(0,q.jsx)(d.A,{type:"primary",onClick:()=>M(!0),children:e("add.area")})]}),children:[(0,q.jsx)(o.A,{columns:E,dataSource:_,pagination:{pageSize:k.per_page,page:k.current_page,total:k.total},rowKey:e=>e.id,loading:C,onChange:e=>{const{pageSize:i,current:t}=e;l((0,g.S)({perPage:i,page:t,city_id:S}))}}),(0,q.jsx)(V,{visible:w,setVisible:M,id:R,setId:T})]})}}}]);