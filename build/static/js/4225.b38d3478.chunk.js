"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[4225],{47992:(e,t,a)=>{a.d(t,{G:()=>o});var l=a(9950),s=a(95491),n=a.n(s),d=a(99674),r=a(90650),i=a(44414);const o=e=>{let{fetchOptions:t,debounceTimeout:a=400,onClear:s,refetchOptions:o=!1,...u}=e;const[c,m]=(0,l.useState)(!1),[v,p]=(0,l.useState)([]),h=(0,l.useMemo)((()=>n()((e=>{p([]),m(!0),t(e).then((e=>{p(e),m(!1)}))}),a)),[t,a]);return(0,i.jsx)(d.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),s&&s()},notFoundContent:c?(0,i.jsx)(r.A,{size:"small"}):"no results",...u,options:v,onFocus:()=>{v.length&&!o||h("")}})}},8002:(e,t,a)=>{a.d(t,{A:()=>s});var l=a(82371);const s={getAll:e=>l.A.get("dashboard/seller/stocks/select-paginate",{params:e})}},14225:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var l=a(9950),s=a(28429),n=a(85923),d=a(59233),r=a(23263),i=a(87094),o=a(41988),u=a(99674),c=a(40577),m=a(86971),v=a(48538),p=a(59051),h=a.n(p),x=a(91854),A=a(74623),f=a(35765),j=a(73439),g=a(47992),Y=a(70030),b=a(48970),y=a(8002),M=a(44738),N=a(44414);function D(){var e,t;const{t:a}=(0,Y.B)(),{activeMenu:p}=(0,x.d4)((e=>e.menu),x.bN),D=(0,x.wA)(),[q]=d.A.useForm(),S=(0,s.Zp)(),[w,O]=(0,l.useState)(!1),{myShop:k}=(0,x.d4)((e=>e.myShop),x.bN),[I,C]=(0,l.useState)(null!==(e=p.data)&&void 0!==e&&e.images?[null===(t=p.data)||void 0===t?void 0:t.images[0]]:[]);(0,l.useEffect)((()=>()=>{const e=q.getFieldsValue(!0),t=JSON.stringify(e.start),a=JSON.stringify(e.end),l={...e,start:t,end:a};D((0,A.Ok)({activeMenu:p,data:l}))}),[]);return(0,N.jsx)(r.A,{title:a("add.discount"),className:"h-100",children:(0,N.jsxs)(d.A,{name:"discount-add",layout:"vertical",onFinish:e=>{var t;if(h()(e.start).format("YYYY-MM-DD")>h()(e.end).format("YYYY-MM-DD"))return n.oR.error(a("start.date.must.be.before.end.date"));const l={price:e.price,type:e.type,stocks:e.products.map((e=>e.value)),start:e.start?h()(e.start).format("YYYY-MM-DD"):void 0,end:e.end?h()(e.end).format("YYYY-MM-DD"):void 0,images:[null===(t=I[0])||void 0===t?void 0:t.name]};O(!0);const s="seller/discounts";f.A.create(l).then((()=>{n.oR.success(a("successfully.created")),(0,x.vA)((()=>{D((0,A.EK)({...p,nextUrl:s})),D((0,j.X)({}))})),S("/".concat(s))})).finally((()=>O(!1)))},form:q,initialValues:{...(()=>{var e,t,a,l;const s=p.data;if(null===(e=p.data)||void 0===e||!e.start||null===(t=p.data)||void 0===t||!t.end)return s;const n=null===(a=p.data)||void 0===a?void 0:a.start,d=null===(l=p.data)||void 0===l?void 0:l.end;return{...s,start:h()(n,"YYYY-MM-DD"),end:h()(d,"YYYY-MM-DD")}})(),...p.data},className:"d-flex flex-column h-100",children:[(0,N.jsxs)(i.A,{gutter:12,children:[(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:a("type"),name:"type",rules:[{required:!0,message:a("required")}],children:(0,N.jsxs)(u.A,{children:[(0,N.jsx)(u.A.Option,{value:"fix",children:a("fix")}),(0,N.jsx)(u.A.Option,{value:"percent",children:a("percent")})]})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:a("price"),name:"price",rules:[{required:!0,message:a("required")}],children:(0,N.jsx)(c.A,{min:0,className:"w-100"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:a("start.date"),name:"start",rules:[{required:!0,message:a("required")}],valuePropName:"date",children:(0,N.jsx)(m.A,{className:"w-100",placeholder:"",disabledDate:e=>h()().add(-1,"days")>=e})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(d.A.Item,{label:a("end.date"),name:"end",rules:[{required:!0,message:a("required")}],valuePropName:"date",children:(0,N.jsx)(m.A,{className:"w-100",placeholder:"",disabledDate:e=>h()().add(-1,"days")>=e})})}),(0,N.jsx)(o.A,{span:24,children:(0,N.jsx)(d.A.Item,{label:a("products"),name:"products",rules:[{required:!0,message:a("required")}],children:(0,N.jsx)(g.G,{fetchOptions:async function(e){const t={search:null!==e&&void 0!==e&&e.length?e:void 0,shop_id:k.id};return y.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t,l,s,n;return{label:"".concat(null===e||void 0===e||null===(t=e.product)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title," => ").concat(null===e||void 0===e||null===(s=e.extras)||void 0===s||null===(n=s.map((e=>{var t,l,s,n,d;return"".concat((null===e||void 0===e||null===(t=e.group)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title)||a("N/A"),": ").concat("color"===(null===e||void 0===e||null===(s=e.group)||void 0===s?void 0:s.type)?(0,M.n)(null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.value):(null===e||void 0===e||null===(d=e.value)||void 0===d?void 0:d.value)||a("N/A"))})))||void 0===n?void 0:n.join(", ")),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},mode:"multiple"})})}),(0,N.jsx)(o.A,{span:24,children:(0,N.jsx)(d.A.Item,{label:a("image"),name:"images",rules:[{required:!I.length,message:a("required")}],children:(0,N.jsx)(b.A,{type:"discounts",imageList:I,setImageList:C,form:q,multiple:!1,name:"image"})})})]}),(0,N.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,N.jsx)("div",{className:"pb-5",children:(0,N.jsx)(v.A,{type:"primary",htmlType:"submit",loading:w,children:a("submit")})})})]})})}}}]);