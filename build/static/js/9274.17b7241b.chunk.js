"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[9274],{27276:(e,l,t)=>{t.d(l,{v:()=>s});var i=t(9950),a=t(90777),r=t(90650),n=t(44414);const s=e=>{let{fetchOptions:l,refetch:t=!1,...s}=e;const[d,o]=(0,i.useState)(!1),[c,u]=(0,i.useState)([]);return(0,n.jsx)(a.A,{treeLine:!0,treeData:d?[]:c,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{c.length&&!t||(o(!0),l().then((e=>{u(e),o(!1)})))},notFoundContent:d?(0,n.jsx)(r.A,{size:"small"}):"no results",...s})}},69274:(e,l,t)=>{t.r(l),t.d(l,{default:()=>E});var i=t(9950),a=t(59233),r=t(23263),n=t(87094),s=t(41988),d=t(55902),o=t(99674),c=t(25933),u=t(48538),v=t(90650),m=t(85923),p=t(28429),h=t(71999),g=t(98591),y=t(91854),j=t(74623),x=t(62572),A=t(63620),b=t(70030),f=t(48970),w=t(66133),k=t(27276),_=t(44414);const E=()=>{var e,l;const{t:t}=(0,b.B)(),E=(0,p.Zp)(),I=(0,y.wA)(),[P,S]=(0,i.useState)("service"),[F,q]=(0,i.useState)(!1),{activeMenu:N}=(0,y.d4)((e=>e.menu),y.bN),{state:z}=(0,p.zy)(),[L,V]=(0,i.useState)(!1),[C,O]=(0,i.useState)(null!==(e=N.data)&&void 0!==e&&e.image?[null===(l=N.data)||void 0===l?void 0:l.image]:[]),[B]=a.A.useForm(),[D,M]=(0,i.useState)(!1),[K,R]=(0,i.useState)(null),{uuid:T}=(0,p.g)(),{params:U}=(0,y.d4)((e=>e.category),y.bN),{defaultLang:Y,languages:Z}=(0,y.d4)((e=>e.formLang),y.bN);(0,i.useEffect)((()=>()=>{const e=B.getFieldsValue(!0);I((0,j.Ok)({activeMenu:N,data:e})),I((0,w.Y)({...U,type:P,parent_id:null===z||void 0===z?void 0:z.parentId}))}),[]);const G=e=>({name:e,url:A.sE+e});function H(e){if(!e)return{};const{translations:l}=e,t=Z.map((e=>{var t,i;return{["title[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title,["description[".concat(e.locale,"]")]:null===(i=l.find((l=>l.locale===e.locale)))||void 0===i?void 0:i.description}}));return Object.assign({},...t)}(0,i.useEffect)((()=>{var e;e=T,V(!0),x.A.getById(e).then((e=>{var l,t,i,a;let r=e.data;const n={...r,...H(r),image:[G(r.img)],keywords:null===r||void 0===r||null===(l=r.keywords)||void 0===l?void 0:l.split(","),parent_id:{label:null===(t=r.parent)||void 0===t||null===(i=t.translation)||void 0===i?void 0:i.title,value:r.parent_id,key:r.parent_id}};S(null===r||void 0===r?void 0:r.type),B.setFieldsValue(n),O([G(r.img)]),(null===r||void 0===r||null===(a=r.children)||void 0===a?void 0:a.length)>0&&"service"===(null===r||void 0===r?void 0:r.type)&&q(!0)})).finally((()=>{V(!1),I((0,j.km)(N))}))}),[N.refetch,T,null===z||void 0===z?void 0:z.parentId]);return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(r.A,{title:null!==z&&void 0!==z&&z.parentId?t("edit.sub.service.category"):t("edit.service.category"),extra:(0,_.jsx)(h.A,{}),children:L?(0,_.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,_.jsx)(v.A,{size:"large",className:"mt-5 pt-5"})}):(0,_.jsxs)(a.A,{name:"basic",layout:"vertical",onFinish:e=>{var l,i,a;M(!0);const r={...e,type:null!==(l=e.parent_id)&&void 0!==l&&l.value?P:"service",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(i=e.parent_id)||void 0===i?void 0:i.value,"images[0]":null===(a=C[0])||void 0===a?void 0:a.name},n="catalog/service-categories";x.A.update(T,r).then((()=>{m.oR.success(t("successfully.updated")),I((0,j.EK)({...N,nextUrl:n})),E("/".concat(n))})).catch((e=>R(e.response.data.params))).finally((()=>M(!1)))},initialValues:{active:!0,...N.data},form:B,children:[(0,_.jsxs)(n.A,{gutter:12,children:[(0,_.jsx)(s.A,{span:12,children:Z.map(((e,l)=>(0,_.jsx)(a.A.Item,{label:t("name"),name:"title[".concat(e.locale,"]"),help:K&&K["title.".concat(Y)]?K["title.".concat(Y)][0]:null,validateStatus:K?"error":"success",rules:[{validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==Y?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(t("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(t("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(t("required")))}],hidden:e.locale!==Y,children:(0,_.jsx)(d.A,{})},e.title+l)))}),(0,_.jsx)(s.A,{span:12,children:Z.map(((e,l)=>(0,_.jsx)(a.A.Item,{label:t("description"),name:"description[".concat(e.locale,"]"),rules:[{validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==Y?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(t("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(t("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(t("required")))}],hidden:e.locale!==Y,children:(0,_.jsx)(g.A,{rows:4})},e.locale+l)))}),(0,_.jsx)(s.A,{span:12,children:(0,_.jsx)(a.A.Item,{label:t("keywords"),name:"keywords",rules:[{required:!0,message:t("required")}],children:(0,_.jsx)(o.A,{mode:"tags",style:{width:"100%"}})})}),(0,_.jsx)(s.A,{span:12,children:(0,_.jsx)(a.A.Item,{label:t("parent.category"),name:"parent_id",rules:[{required:!1,message:t("required")}],children:(0,_.jsx)(k.v,{fetchOptions:async function(){const{id:e}=B.getFieldValue();return x.A.getAll({perPage:100,type:"service"}).then((l=>l.data.filter((l=>l.id!==e)).map((l=>{var t,i;return{label:null===(t=l.translation)||void 0===t?void 0:t.title,value:l.id,key:l.id,type:"service",children:null===(i=l.children)||void 0===i?void 0:i.map((l=>{var t,i;return{label:null===(t=l.translation)||void 0===t?void 0:t.title,value:l.id,key:l.id,type:"sub_service",disabled:l.id===e,children:null===(i=l.children)||void 0===i?void 0:i.map((e=>{var l;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,disabled:!0,type:"child_service"}}))}}))}}))))},onSelect:(e,l)=>{const{type:t}=l||{};S("service"===t?"sub_service":"sub_service"===t?"child_service":"service")},allowClear:!0,disabled:F})})}),(0,_.jsx)(s.A,{span:4,children:(0,_.jsx)(a.A.Item,{label:t("image"),name:"images",rules:[{validator:()=>0===(null===C||void 0===C?void 0:C.length)?Promise.reject(new Error(t("required"))):Promise.resolve()}],children:(0,_.jsx)(f.A,{type:"categories",imageList:C,setImageList:O,form:B,multiple:!1})})}),(0,_.jsx)(s.A,{span:2,children:(0,_.jsx)(a.A.Item,{label:t("active"),name:"active",valuePropName:"checked",children:(0,_.jsx)(c.A,{})})})]}),(0,_.jsx)(u.A,{type:"primary",htmlType:"submit",loading:D,children:t("submit")})]})})})}}}]);