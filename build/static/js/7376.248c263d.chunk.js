"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[7376],{85023:(e,t,i)=>{i.d(t,{D:()=>l});var n=i(9950),s=i(99674),r=i(90650),a=i(44414);const l=e=>{let{fetchOptions:t,refetch:i=!1,value:l,...o}=e;const[d,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)([]);"object"===typeof(null===l||void 0===l?void 0:l.label)&&null!==(null===l||void 0===l?void 0:l.label)&&(l.label=l.label.value);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.A,{labelInValue:!0,filterOption:!1,notFoundContent:d?(0,a.jsx)(r.A,{size:"small"}):"no results",value:l,...o,options:d?[]:m,onFocus:()=>{m.length&&!i||(c(!0),t().then((e=>{u(e),c(!1)})))},getPopupContainer:e=>e.parentNode})})}},7376:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var n=i(9950),s=i(28429),r=i(85923),a=i(86366),l=i(59233),o=i(23263),d=i(90650),c=i(63620),m=i(91854),u=i(74623),p=i(70030),g=i(71999),v=i(64986),h=i(69292),x=i(44414);const{Step:j}=a.A,A=()=>{var e,t,i;const{t:A}=(0,p.B)(),{activeMenu:b}=(0,m.d4)((e=>e.menu),m.bN),{id:y}=(0,s.g)(),f=(0,m.wA)(),{defaultLang:k,languages:q}=(0,m.d4)((e=>e.formLang),m.bN),[_,w]=(0,n.useState)((null===(e=b.data)||void 0===e?void 0:e.step)||0),[I,N]=(0,n.useState)(null!==(t=b.data)&&void 0!==t&&t.image?[null===(i=b.data)||void 0===i?void 0:i.image]:[]),F=()=>{w(_+1)},C=()=>{w(_-1)},[E]=l.A.useForm(),P=(0,s.Zp)(),[L,S]=(0,n.useState)(!1),[T,O]=(0,n.useState)(!1);(0,n.useEffect)((()=>()=>{const e=E.getFieldsValue(!0);f((0,u.Ok)({activeMenu:b,data:e}))}),[]);return(0,n.useEffect)((()=>{b.refetch&&(e=>{S(!0),h.A.getById(e).then((e=>{var t;let i=e.data;var n;console.log("recept",i),E.setFieldsValue({...i,active_time:Number(i.active_time),total_time:Number(i.total_time),title:{[k]:i.translation.title},description:{[k]:i.translation.description},instruction:Object.assign({},...i.instructions.map((e=>({[e.locale]:e.title})))),ingredient:Object.assign({},...i.ingredients.map((e=>({[e.locale]:e.title})))),nutrition:null===(t=i.nutritions)||void 0===t?void 0:t.map((e=>({percentage:Number(null===e||void 0===e?void 0:e.percentage),weight:Number(null===e||void 0===e?void 0:e.weight),...Object.assign({},...e.translations.flatMap((e=>({[e.locale]:e.title}))))}))),category_id:{value:i.category.id,label:i.category.translation.title},stocks:i.stocks.map((e=>({stock_id:{value:e.id,label:e.product.translation.title},...e})))}),N([(n=i.img,{name:n,url:c.sE+n})])})).finally((()=>{S(!1),f((0,u.km)(b))}))})(y)}),[b.refetch]),(0,x.jsx)(o.A,{title:A("edit.recepe"),extra:(0,x.jsx)(g.A,{}),children:L?(0,x.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,x.jsx)(d.A,{size:"large",className:"py-5"})}):(0,x.jsxs)(l.A,{layout:"vertical",onFinish:e=>{var t;E.validateFields();const i={...e,total_time:e.total_time.toString(),active_time:e.active_time.toString(),category_id:e.category_id.value,images:null===I||void 0===I?void 0:I.map((e=>e.name)),stocks:e.stocks.map((e=>({min_quantity:e.min_quantity,stock_id:e.stock_id.value}))),nutrition:null===(t=e.nutrition)||void 0===t?void 0:t.map((e=>{var t;return{...e,percentage:null===e||void 0===e||null===(t=e.percentage)||void 0===t?void 0:t.toString(),weight:e.weight.toString()}}))};O(!0);const n="seller/recept";h.A.update(y,i).then((()=>{r.oR.success(A("successfully.updated")),P("/".concat(n)),f((0,u.EK)({...b,nextUrl:n}))})).finally((()=>O(!1)))},form:E,initialValues:{active:!0,...b.data},children:[(0,x.jsx)(a.A,{current:_,children:v.C.map((e=>(0,x.jsx)(j,{title:A(e.title)},e.title)))}),v.C.map((e=>{const t=e.content;return(0,x.jsx)("div",{className:"steps-content ".concat(e.step!==_+1&&"hidden"),children:(0,x.jsx)(t,{next:F,prev:C,loading:T,image:I,setImage:N})},e.title)}))]})})}},64986:(e,t,i)=>{i.d(t,{C:()=>N});var n=i(59233),s=i(87094),r=i(41988),a=i(80737),l=i(48538),o=(i(9950),i(91854)),d=i(36455),c=i(19181),m=i.n(c),u=i(70030),p=i(44414);const g=e=>{let{next:t,prev:i}=e;const{t:c}=(0,u.B)(),g=n.A.useFormInstance(),{defaultLang:v,languages:h}=(0,o.d4)((e=>e.formLang),o.bN);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(s.A,{gutter:12,children:(0,p.jsx)(r.A,{span:24,children:h.map((e=>(0,p.jsx)(n.A.Item,{label:c("ingredients"),name:["ingredient",e.locale],valuePropName:"data",getValueFromEvent:(e,t)=>t.getData(),rules:[{required:e.locale===v,message:c("required")}],hidden:e.locale!==v,children:(0,p.jsx)(d.CKEditor,{editor:m()})})))})}),(0,p.jsxs)(a.A,{children:[(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>i(),children:c("prev")}),(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>{g.validateFields([["ingredient",v]]).then((()=>{t()}))},children:c("next")})]})]})},v=e=>{let{next:t,prev:i}=e;const{t:c}=(0,u.B)(),g=n.A.useFormInstance(),{defaultLang:v,languages:h}=(0,o.d4)((e=>e.formLang),o.bN);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(s.A,{gutter:12,children:(0,p.jsx)(r.A,{span:24,children:h.map((e=>(0,p.jsx)(n.A.Item,{label:c("instructions"),name:["instruction",e.locale],valuePropName:"data",getValueFromEvent:(e,t)=>t.getData(),rules:[{required:e.locale===v,message:c("required")}],hidden:e.locale!==v,children:(0,p.jsx)(d.CKEditor,{editor:m()})})))})}),(0,p.jsxs)(a.A,{children:[(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>i(),children:c("prev")}),(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>{g.validateFields([["instruction",v]]).then((()=>{t()}))},children:c("next")})]})]})};var h=i(55902),x=i(40577),j=i(99674),A=i(48970),b=i(12598),y=i(85023);const{TextArea:f}=h.A,k=e=>{let{next:t,image:i,setImage:a}=e;const{t:d}=(0,u.B)(),c=n.A.useFormInstance(),{defaultLang:m,languages:g}=(0,o.d4)((e=>e.formLang),o.bN);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(s.A,{gutter:12,children:[(0,p.jsx)(r.A,{span:12,children:g.map((e=>(0,p.jsx)(n.A.Item,{label:d("name"),name:["title",e.locale],rules:[{validator:(t,i)=>i||(null===e||void 0===e?void 0:e.locale)!==m?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(d("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(d("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(d("required")))}],hidden:e.locale!==m,children:(0,p.jsx)(h.A,{})},"name"+e.id)))}),(0,p.jsx)(r.A,{span:12,children:(0,p.jsx)(n.A.Item,{label:d("category"),name:"category_id",rules:[{required:!0,message:d("required")}],children:(0,p.jsx)(y.D,{fetchOptions:function(){return b.A.getAll({active:1,type:"receipt"}).then((e=>e.data.map((e=>({label:e.translation.title,value:e.id})))))},debounceTimeout:200})},"category_id")}),(0,p.jsx)(r.A,{span:12,children:g.map((e=>(0,p.jsx)(n.A.Item,{label:d("description"),name:["description",e.locale],rules:[{validator:(t,i)=>i||(null===e||void 0===e?void 0:e.locale)!==m?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(d("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(d("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(d("required")))}],hidden:e.locale!==m,children:(0,p.jsx)(f,{rows:3})},"description"+e.id)))}),(0,p.jsx)(r.A,{span:6,children:(0,p.jsx)(n.A.Item,{label:d("calories"),name:"calories",rules:[{required:!0,message:d("required")},{type:"number",min:0,message:d("must.be.positive")}],children:(0,p.jsx)(x.A,{className:"w-100"})},"calories")}),(0,p.jsx)(r.A,{span:6,children:(0,p.jsx)(n.A.Item,{label:d("servings"),name:"servings",rules:[{required:!0,message:d("required")},{type:"number",min:0,message:d("must.be.positive")}],children:(0,p.jsx)(x.A,{className:"w-100"})},"servings")}),(0,p.jsx)(r.A,{span:6,children:(0,p.jsx)(n.A.Item,{label:d("active.time"),name:"active_time",rules:[{required:!0,message:d("required")},{type:"number",min:0,message:d("must.be.positive")}],children:(0,p.jsx)(x.A,{className:"w-100"})},"active_time")}),(0,p.jsx)(r.A,{span:6,children:(0,p.jsx)(n.A.Item,{label:d("total.time"),name:"total_time",rules:[{required:!0,message:d("required")},{type:"number",min:0,message:d("must.be.positive")}],children:(0,p.jsx)(x.A,{className:"w-100"})},"total_time")}),(0,p.jsx)(r.A,{span:12,children:(0,p.jsx)(n.A.Item,{label:d("discount.type"),name:"discount_type",rules:[{required:!0,message:d("required")}],children:(0,p.jsx)(j.A,{options:[{label:d("fix"),value:"fix"},{label:d("percent"),value:"percent"}]})})}),(0,p.jsx)(r.A,{span:12,children:(0,p.jsx)(n.A.Item,{label:d("discount.price"),name:"discount_price",rules:[{required:!0,message:d("required")},{type:"number",min:0,message:d("must.be.positive")}],children:(0,p.jsx)(x.A,{className:"w-100"})})}),(0,p.jsx)(r.A,{span:12,children:(0,p.jsx)(n.A.Item,{label:d("image"),name:"images",rules:[{validator:()=>0===(null===i||void 0===i?void 0:i.length)?Promise.reject(new Error(d("required"))):Promise.resolve()}],children:(0,p.jsx)(A.A,{type:"receipts",imageList:i,setImageList:a,form:c,multiple:!1})})})]}),(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>{c.validateFields([["title",m],["description",m],"calories","servings","active_time","total_time","discount_type","discount_price","category_id","images"]).then((e=>{t()}))},children:d("next")})]})};var q=i(44070),_=i(8750);const w=e=>{let{prev:t,loading:i}=e;const{t:d}=(0,u.B)(),{defaultLang:c,languages:m}=(0,o.d4)((e=>e.formLang),o.bN);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(s.A,{gutter:12,children:(0,p.jsx)(r.A,{span:24,children:(0,p.jsx)(n.A.List,{name:"nutrition",initialValue:[{weight:void 0,percentage:void 0,en:void 0,ru:void 0}],children:(e,t)=>{let{add:i,remove:a}=t;return(0,p.jsxs)(p.Fragment,{children:[e.map(((e,t)=>{let{key:i,name:o,...u}=e;return(0,p.jsxs)(s.A,{gutter:12,align:"middle",children:[(0,p.jsx)(r.A,{span:7,children:m.map((e=>(0,p.jsx)(n.A.Item,{label:d("name"),name:[o,e.locale],rules:[{validator:(t,i)=>i||(null===e||void 0===e?void 0:e.locale)!==c?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(d("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(d("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(d("required")))}],hidden:e.locale!==c,children:(0,p.jsx)(h.A,{})},"name"+e.id)))}),(0,p.jsx)(r.A,{span:7,children:(0,p.jsx)(n.A.Item,{...u,label:d("weight"),name:[o,"weight"],rules:[{required:!0,message:d("required")},{type:"number",min:0,message:d("must.be.positive")}],children:(0,p.jsx)(x.A,{className:"w-100",addonAfter:"g"})})}),(0,p.jsx)(r.A,{span:7,children:(0,p.jsx)(n.A.Item,{...u,label:d("percentage"),name:[o,"percentage"],rules:[{required:!0,message:d("required")},{type:"number",min:0,max:100,message:d("must.be.between.0.and.100")}],children:(0,p.jsx)(x.A,{className:"w-100",addonAfter:"%"})})}),0!==t&&(0,p.jsx)(r.A,{span:3,className:"d-flex justify-content-end",children:(0,p.jsx)(l.A,{onClick:()=>a(o),danger:!0,className:"w-100",type:"primary",icon:(0,p.jsx)(q.A,{})})})]})})),(0,p.jsx)(n.A.Item,{children:(0,p.jsx)(l.A,{onClick:()=>i(),block:!0,icon:(0,p.jsx)(_.A,{}),children:d("add.nutrition")})})]})}})})}),(0,p.jsxs)(a.A,{children:[(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>t(),children:d("prev")}),(0,p.jsx)(l.A,{type:"primary",htmlType:"submit",loading:i,children:d("submit")})]})]})};var I=i(67231);const N=[{step:1,title:"recipe",content:k},{step:2,title:"instructions",content:v},{step:3,title:"ingredients",content:g},{step:4,title:"stocks",content:e=>{let{next:t,prev:i}=e;const{t:o}=(0,u.B)(),d=n.A.useFormInstance(),c=n.A.useWatch("stocks",d);function m(e){const t={perPage:10,page:1,search:e,active:1};return I.A.getStock(t).then((e=>e.data.filter((e=>!c.map((e=>{var t;return null===e||void 0===e||null===(t=e.stock_id)||void 0===t?void 0:t.value})).includes(e.id))).map((e=>({label:e.product.translation.title+" "+e.extras.map((e=>e.value)).join(", "),value:e.id})))))}return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(s.A,{gutter:12,children:(0,p.jsx)(r.A,{span:24,children:(0,p.jsx)(n.A.List,{name:"stocks",initialValue:[{stock_id:void 0,min_quantity:void 0}],children:(e,t)=>{let{add:i,remove:a}=t;return(0,p.jsxs)(p.Fragment,{children:[e.map(((e,t)=>{let{key:i,name:d,...c}=e;return(0,p.jsxs)(s.A,{gutter:12,align:"middle",children:[(0,p.jsx)(r.A,{span:11,children:(0,p.jsx)(n.A.Item,{...c,label:o("stock"),name:[d,"stock_id"],rules:[{required:!0,message:o("required")}],children:(0,p.jsx)(y.D,{fetchOptions:m,debounceTimeout:200})})}),(0,p.jsx)(r.A,{span:11,children:(0,p.jsx)(n.A.Item,{...c,label:o("min.quantity"),name:[d,"min_quantity"],rules:[{required:!0,message:o("required")},{type:"number",min:1,message:o("must.be.at.least.1")}],children:(0,p.jsx)(x.A,{className:"w-100"})})}),0!==t&&(0,p.jsx)(r.A,{span:2,className:"d-flex justify-content-end",children:(0,p.jsx)(l.A,{onClick:()=>a(d),danger:!0,className:"w-100",type:"primary",icon:(0,p.jsx)(q.A,{})})})]})})),(0,p.jsx)(n.A.Item,{children:(0,p.jsx)(l.A,{onClick:()=>i(),block:!0,icon:(0,p.jsx)(_.A,{}),children:o("add.stock")})})]})}})})}),(0,p.jsxs)(a.A,{children:[(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>i(),children:o("prev")}),(0,p.jsx)(l.A,{type:"primary",htmlType:"button",onClick:()=>{d.validateFields(c.flatMap(((e,t)=>[["stocks",t,"stock_id"],["stocks",t,"min_quantity"]]))).then((()=>{t()}))},children:o("next")})]})]})}},{step:5,title:"nutritions",content:w}]}}]);