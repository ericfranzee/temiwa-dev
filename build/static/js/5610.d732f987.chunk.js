"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5610],{25610:(e,l,i)=>{i.r(l),i.d(l,{default:()=>E});var t=i(9950),n=i(87094),s=i(41988),r=i(23263),a=i(80737),d=i(12916),o=i(72243),c=i(82706),u=i(28429),v=i(91854),h=i(74623),m=i(62572),p=i(63620),j=i(70030),g=i(27068),x=i(59233),A=i(99674),y=i(55902),b=i(25933),f=i(48538),w=i(85923),k=i(98591),I=i(48970),_=i(44414);const P=e=>{var l,i;let{parent:r={},setId:a,setIsRefetch:d}=e;const{t:o}=(0,j.B)(),{activeMenu:c}=(0,v.d4)((e=>e.menu),v.bN),[u,h]=(0,t.useState)(null!==(l=c.data)&&void 0!==l&&l.image?[null===(i=c.data)||void 0===i?void 0:i.image]:[]),[p]=x.A.useForm(),[g,P]=(0,t.useState)(!1),[E,q]=(0,t.useState)(null),{defaultLang:S,languages:N}=(0,v.d4)((e=>e.formLang),v.bN);(0,t.useEffect)((()=>()=>{p.resetFields()}),[]);return null!==r&&void 0!==r&&r.id?(0,_.jsxs)(x.A,{name:"basic",layout:"vertical",onFinish:e=>{var l,i;P(!0);const t={...e,type:"service"===(null===r||void 0===r?void 0:r.type)?"sub_service":"child_service",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(l=e.parent_id)||void 0===l?void 0:l.value,"images[0]":null===(i=u[0])||void 0===i?void 0:i.name};m.A.create(t).then((()=>{w.oR.success(o("successfully.created")),a(null),p.resetFields(),d(!0)})).catch((e=>q(e.response.data.params))).finally((()=>P(!1)))},initialValues:{active:!0,...r},form:p,children:[(0,_.jsxs)(n.A,{gutter:24,children:[(0,_.jsx)(s.A,{span:24,children:(0,_.jsx)(x.A.Item,{label:o("parent.category"),name:"parent_id",rules:[{required:!1,message:o("required")}],children:(0,_.jsx)(A.A,{disabled:!0})})}),(0,_.jsx)(s.A,{span:24,children:N.map(((e,l)=>(0,_.jsx)(x.A.Item,{label:o("name"),name:"title[".concat(e.locale,"]"),help:E&&E["title.".concat(S)]?E["title.".concat(S)][0]:null,validateStatus:E?"error":"success",rules:[{required:!0,validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==S?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(o("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(o("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(o("required")))}],hidden:e.locale!==S,children:(0,_.jsx)(y.A,{placeholder:o("name")})},e.title+l)))}),(0,_.jsx)(s.A,{span:24,children:N.map(((e,l)=>(0,_.jsx)(x.A.Item,{label:o("description"),name:"description[".concat(e.locale,"]"),rules:[{required:!0,validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==S?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(o("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(o("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(o("required")))}],hidden:e.locale!==S,children:(0,_.jsx)(k.A,{rows:4})},e.locale+l)))}),(0,_.jsx)(s.A,{span:24,children:(0,_.jsx)(x.A.Item,{label:o("keywords"),name:"keywords",rules:[{required:!0,message:o("required")}],children:(0,_.jsx)(A.A,{mode:"tags",style:{width:"100%"}})})}),(0,_.jsx)(s.A,{span:12,children:(0,_.jsx)(x.A.Item,{label:o("image"),name:"images",rules:[{validator:()=>0===(null===u||void 0===u?void 0:u.length)?Promise.reject(new Error(o("required"))):Promise.resolve()}],children:(0,_.jsx)(I.A,{type:"categories",imageList:u,setImageList:h,form:p,multiple:!1})})}),(0,_.jsx)(s.A,{span:12,children:(0,_.jsx)(x.A.Item,{label:o("active"),name:"active",valuePropName:"checked",children:(0,_.jsx)(b.A,{})})})]}),(0,_.jsx)(f.A,{type:"primary",htmlType:"submit",loading:g,className:"w-100",children:o("submit")})]}):""},E=()=>{var e,l,i,x,A;const{t:y}=(0,j.B)(),{uuid:b}=(0,u.g)(),f=(0,v.wA)(),[w,k]=(0,t.useState)({}),[I,E]=(0,t.useState)(null),[q,S]=(0,t.useState)(null),[N,L]=(0,t.useState)(null),{activeMenu:F}=(0,v.d4)((e=>e.menu),v.bN),[C,R]=(0,t.useState)(!1),{languages:z,defaultLang:B}=(0,v.d4)((e=>e.formLang),v.bN);function M(e){if(!e)return{};const{translations:l}=e,i=z.map((e=>{var i,t;return{["title[".concat(e.locale,"]")]:null===(i=l.find((l=>l.locale===e.locale)))||void 0===i?void 0:i.title,["description[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.description}}));return Object.assign({},...i)}return(0,t.useEffect)((()=>{var e;console.log("Wrong fetching",b),b&&(e=b,R(!0),m.A.getById(e).then((e=>{var l,i,t;let n=e.data;const s={...n,...M(n),image:[(r=n.img,{name:r,url:p.sE+r})],keywords:null===n||void 0===n||null===(l=n.keywords)||void 0===l?void 0:l.split(","),parent_id:{label:null===(i=n.parent)||void 0===i||null===(t=i.translation)||void 0===t?void 0:t.title,value:n.parent_id,key:n.parent_id}};var r;k(s),E(n.id)})).finally((()=>{R(!1),f((0,h.km)(F))})))}),[F.refetch,b]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(n.A,{gutter:[24,24],className:"mb-4",children:[(0,_.jsx)(s.A,{span:24,children:(0,_.jsx)(r.A,{title:y("basic.info"),style:{height:"100%"},loading:C,children:(0,_.jsxs)(n.A,{gutter:[24,24],children:[(0,_.jsx)(s.A,{span:24,children:(0,_.jsxs)(a.A,{children:[(0,_.jsxs)("strong",{children:[y("category.name"),":"]}),(0,_.jsx)("span",{children:null===w||void 0===w||null===(e=w.translation)||void 0===e?void 0:e.title})]})}),(0,_.jsx)(s.A,{span:24,children:(0,_.jsxs)(a.A,{children:[(0,_.jsxs)("strong",{children:[y("category.description"),":"]}),(0,_.jsx)("span",{children:w["description[".concat(B||"en","]")]})]})})]})})}),(0,_.jsx)(s.A,{span:12,children:(0,_.jsx)(r.A,{title:y("organization"),style:{height:"100%"},loading:C,children:(0,_.jsxs)(n.A,{gutter:[24,24],children:[(0,_.jsx)(s.A,{span:24,children:(0,_.jsxs)(a.A,{children:[(0,_.jsxs)("strong",{children:[y("keyword"),":"]}),null===w||void 0===w||null===(l=w.keywords)||void 0===l?void 0:l.map(((e,l)=>(0,_.jsx)(d.A,{children:e},l)))]})}),(0,_.jsx)(s.A,{span:24,children:(0,_.jsxs)(a.A,{children:[(0,_.jsxs)("strong",{children:[y("parent.category"),":"]}),(0,_.jsx)("span",{children:null===w||void 0===w||null===(i=w.parent)||void 0===i||null===(x=i.translation)||void 0===x?void 0:x.title})]})})]})})}),(0,_.jsx)(s.A,{span:12,children:(0,_.jsx)(r.A,{title:y("media"),style:{height:"100%"},loading:C,children:(0,_.jsx)(a.A,{wrap:!0,children:null===w||void 0===w||null===(A=w.image)||void 0===A?void 0:A.map((e=>(0,_.jsx)(o.A,{src:e.url,width:100,height:100})))})})})]}),!!I&&(0,_.jsx)(g.A,{type:"service"===(null===w||void 0===w?void 0:w.type)?"sub_service":"child_service",parent_type:null===w||void 0===w?void 0:w.type,parentId:I,handleAddAction:e=>{S(e)},isRefetch:N}),(0,_.jsx)(c.A,{title:y("add.subcategory"),visible:q,onCancel:()=>{S(null)},centered:!0,footer:null,destroyOnClose:!0,children:(0,_.jsx)(P,{setId:S,id:q,setIsRefetch:L,parent:{parent_id:{label:w["title[".concat(B,"]")],value:null===w||void 0===w?void 0:w.id},id:null===w||void 0===w?void 0:w.id,type:null===w||void 0===w?void 0:w.type}})})]})}}}]);