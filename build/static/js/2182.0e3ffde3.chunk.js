"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[2182],{12196:(e,i,a)=>{a.d(i,{A:()=>j});var l=a(9950),t=a(59233),s=a(72243),n=a(87094),r=a(41988),d=a(80737),o=a(66876),m=a(82706),c=a(48538),u=a(8750),p=a(44070),v=a(48970),h=a(64924),x=a(70030),g=a(44414);const j=e=>{var i;let{mediaList:a,setMediaList:j,name:A="products"}=e;const{t:b}=(0,x.B)(),[f]=t.A.useForm(),[y,w]=(0,l.useState)(null),[N,_]=(0,l.useState)([]),[q,I]=(0,l.useState)(!1),[L,k]=(0,l.useState)(!1),V=async e=>{let{file:i,type:a}=e;i.name?(w("video"===a?(0,g.jsx)("video",{controls:!0,src:i.name,width:450,height:450}):(0,g.jsx)(s.A,{src:i.name,width:"100%",height:450,alt:"preview-img"})),I(!0)):w(null)},F=e=>({uid:e.title,name:e.title,status:"done",url:e.title,created:!0});return(0,g.jsxs)(n.A,{gutter:[24,24],children:[(0,g.jsx)(r.A,{span:24,children:(0,g.jsx)(d.A,{className:"align-items-start",children:(0,g.jsx)(o.A,{customRequest:e=>{let{file:i,onSuccess:a}=e;k(!0);const l=new FormData;l.append("image",i),l.append("type",A),h.A.upload(l).then((e=>{let{data:i}=e;j((e=>({...e,images:[...e.images,{...F(i),isVideo:!0}]}))),a("ok")}))},accept:"video/*",listType:"text",className:"video-upload",multiple:!1,fileList:[],children:(0,g.jsxs)("div",{className:"media-upload",children:[(0,g.jsx)(u.A,{})," ",(0,g.jsx)("span",{children:b("upload.video")})]})})})}),(0,g.jsx)(r.A,{span:24,children:null===a||void 0===a||null===(i=a.previews)||void 0===i?void 0:i.map(((e,i)=>{var l,t;return(0,g.jsxs)(d.A,{className:"uploaded-file",wrap:!0,children:[(0,g.jsx)("span",{className:"media-item",onClick:()=>V({type:"img",file:null===a||void 0===a?void 0:a.previews[i]}),children:null===a||void 0===a||null===(l=a.previews[i])||void 0===l?void 0:l.name}),(0,g.jsx)("span",{className:"media-item",onClick:()=>V({type:"video",file:null===a||void 0===a?void 0:a.images[i]}),children:null===a||void 0===a||null===(t=a.images[i])||void 0===t?void 0:t.name}),(0,g.jsx)(p.A,{className:"delete-media-item",onClick:()=>(e=>{const i=a.images.filter(((i,a)=>{if(a!==e)return i})),l=a.previews.filter(((i,a)=>{if(a!==e)return i}));j({images:i,previews:l})})(i)})]})}))}),(0,g.jsx)(m.A,{title:"Video Preview",visible:q,onCancel:()=>{I(!1)},footer:null,children:y}),(0,g.jsx)(m.A,{title:"Preview image",visible:L,footer:null,onCancel:()=>k(!1),children:(0,g.jsx)(t.A,{form:f,onFinish:()=>{j((e=>({...e,previews:[...e.previews,...N]}))),_([]),k(!1)},layout:"vertical",children:(0,g.jsxs)(n.A,{gutter:[24,24],children:[(0,g.jsx)(r.A,{span:24,children:(0,g.jsx)(t.A.Item,{label:b("preview.image"),name:"preview-image",rules:[{required:!(null!==N&&void 0!==N&&N.length),message:b("required")}],children:(0,g.jsx)(v.A,{type:A,imageList:N,setImageList:_,multiple:!1,text:"upload.image",form:f})})}),(0,g.jsx)(r.A,{span:24,className:"d-flex justify-content-end",children:(0,g.jsx)(c.A,{type:"primary",onClick:()=>f.submit(),children:b("save")})})]})})})]})}},31281:(e,i,a)=>{function l(e,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const l=e.map((e=>({[e.locale]:""===i["".concat(a,"[").concat(e.locale,"]")]?void 0:i["".concat(a,"[").concat(e.locale,"]")]})));return Object.assign({},...l)}a.d(i,{A:()=>l})},2182:(e,i,a)=>{a.r(i),a.d(i,{default:()=>n});a(9950);var l=a(28429),t=a(97792),s=a(44414);const n=()=>{const{id:e}=(0,l.g)();return(0,s.jsx)(t.A,{id:e})}},97792:(e,i,a)=>{a.d(i,{A:()=>I});var l=a(9950),t=a(91854),s=a(70030),n=a(59233),r=a(23263),d=a(90650),o=a(87094),m=a(41988),c=a(55902),u=a(99674),p=a(40577),v=a(25933),h=a(48538),x=a(28429),g=a(75114),j=a(85923),A=a(31281),b=a(71999),f=a(74623),y=a(74635),w=a(48970),N=a(12196),_=a(44414);const q=[{value:"main",label:(0,y.t)("main")},{value:"standard",label:(0,y.t)("standard")},{value:"main_top_banner",label:(0,y.t)("main_top_banner")},{value:"main_banner",label:(0,y.t)("main_banner")},{value:"main_left_banner",label:(0,y.t)("main_left_banner")},{value:"standard_top_banner",label:(0,y.t)("standard_top_banner")}],I=e=>{var i,a,y;let{id:I}=e;const{t:L}=(0,s.B)(),k=(0,t.wA)(),V=(0,x.Zp)(),[F]=n.A.useForm(),{activeMenu:P}=(0,t.d4)((e=>e.menu),t.bN),{defaultLang:S,languages:C}=(0,t.d4)((e=>e.formLang),t.bN),[E,M]=(0,l.useState)((null===(i=P.data)||void 0===i||null===(a=i.img)||void 0===a?void 0:a.filter((e=>!(null!==e&&void 0!==e&&e.isVideo))))||[]),[O,B]=(0,l.useState)((null===P||void 0===P||null===(y=P.data)||void 0===y?void 0:y.initialMediaFile)||{images:[],previews:[]}),z=(0,l.useMemo)((()=>[{value:"minute",label:L("minute")},{value:"hour",label:L("hour")},{value:"day",label:L("day")},{value:"month",label:L("month")},{value:"year",label:L("year")}]),[]),[R,K]=(0,l.useState)(!1),[T,U]=(0,l.useState)(!1),D=e=>{K(!0);const i="catalog/advert";g.A.create(e).then((e=>{V("/".concat(i)),j.oR.success(L("successfully.created")),k((0,f.EK)({...P,nextUrl:i}))})).finally((()=>K(!1)))},Z=e=>{K(!0);g.A.update(I,e).then((e=>{V("/catalog/advert"),j.oR.success(L("successfully.updated")),k((0,f.EK)({...P,nextUrl:"catalog/advert"}))})).finally((()=>K(!1)))};function G(e){if(!e)return{};const{translations:i}=e,a=C.map((e=>{var a,l;return{["title[".concat(e.locale,"]")]:null===(a=i.find((i=>i.locale===e.locale)))||void 0===a?void 0:a.title,["description[".concat(e.locale,"]")]:null===(l=i.find((i=>i.locale===e.locale)))||void 0===l?void 0:l.description}}));return Object.assign({},...a)}const H=e=>e.map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:Boolean(e.preview)}))),J=e=>{const i={images:[],previews:[]},a=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.preview,url:e.preview}))),l=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:!0})));return i.previews=a,i.images=l,i};return(0,l.useEffect)((()=>{var e;I&&(e=I,U(!0),g.A.getById(e).then((e=>{let i=e.data;const a={...i,time_type:{value:i.time_type,label:L(i.time_type)},img:H(i.galleries),initialMediaFile:J(e.data.galleries),...G(i)};M(H(i.galleries).filter((e=>!e.isVideo))),B(J(e.data.galleries)),F.setFieldsValue(a),k((0,f.Ok)({activeMenu:P,data:a}))})).finally((()=>{k((0,f.km)(P)),U(!1)})))}),[I]),T?(0,_.jsx)(r.A,{title:L("edit.ad"),children:(0,_.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,_.jsx)(d.A,{size:"large",className:"py-5"})})}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(r.A,{title:L(I?"edit.ad":"add.ad"),extra:(0,_.jsx)(b.A,{})}),(0,_.jsx)(n.A,{layout:"vertical",form:F,initialValues:{active:!0},onFinish:e=>{var i;const a=O.images.map((e=>e.name)),l=O.previews.map((e=>e.name)),t={...e,images:[...a,...E.map((e=>null===e||void 0===e?void 0:e.name))],previews:l,title:(0,A.A)(C,e,"title"),description:(0,A.A)(C,e,"description"),active:Number(e.active),time_type:e.time_type.value,type:(null===(i=e.type)||void 0===i?void 0:i.value)||e.type};I?Z(t):D(t)},children:(0,_.jsxs)(o.A,{gutter:[24,24],children:[(0,_.jsx)(m.A,{span:12,children:(0,_.jsxs)(r.A,{title:L("basic.info"),className:"h-100",children:[C.map((e=>(0,_.jsx)(n.A.Item,{label:L("name"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===S,message:L("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(L("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.length)<2?Promise.reject(new Error(L("min.2.letters"))):Promise.resolve()}],hidden:e.locale!==S,children:(0,_.jsx)(c.A,{maxLength:50})},"title"+e.id))),C.map((e=>(0,_.jsx)(n.A.Item,{label:L("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===S,message:L("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(L("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(L("must.be.at.least.5"))):Promise.resolve()}],hidden:e.locale!==S,children:(0,_.jsx)(c.A,{maxLength:150})},"description"+e.locale))),(0,_.jsx)(n.A.Item,{label:L("type"),name:"type",rules:[{required:!0,message:L("required")}],children:(0,_.jsx)(u.A,{labelInValue:!0,filterOption:!1,options:q})})]})}),(0,_.jsx)(m.A,{span:12,children:(0,_.jsxs)(r.A,{title:L("time.and.price"),className:"h-100",children:[(0,_.jsx)(n.A.Item,{label:L("time.type"),name:"time_type",rules:[{required:!0,message:L("required")}],children:(0,_.jsx)(u.A,{labelInValue:!0,filterOption:!1,options:z})}),(0,_.jsx)(n.A.Item,{label:L("time"),name:"time",rules:[{required:!0,message:L("required")},{type:"number",min:0,message:L("must.be.positive")},{type:"number",max:32e3,message:L("must.be.less.than.32000")}],children:(0,_.jsx)(p.A,{className:"w-100"})}),(0,_.jsx)(n.A.Item,{label:L("price"),name:"price",rules:[{required:!0,message:L("required")},{type:"number",max:1e20,message:L("max.length.20")}],children:(0,_.jsx)(p.A,{className:"w-100",min:0})}),(0,_.jsx)(n.A.Item,{label:L("active"),name:"active",valuePropName:"checked",children:(0,_.jsx)(v.A,{})})]})}),(0,_.jsx)(m.A,{span:16,children:(0,_.jsx)(r.A,{title:L("video"),className:"h-100",children:(0,_.jsx)(N.A,{form:F,name:"other",mediaList:O,setMediaList:B})})}),(0,_.jsx)(m.A,{span:8,children:(0,_.jsx)(r.A,{title:L("media"),className:"h-100",children:(0,_.jsx)(n.A.Item,{rules:[{required:!(null!==E&&void 0!==E&&E.length),message:L("required")}],name:"images",children:(0,_.jsx)(w.A,{type:"other",imageList:E,setImageList:M,form:F,multiple:!1})})})}),(0,_.jsx)(m.A,{span:24,className:"d-flex justify-content-end",children:(0,_.jsx)(h.A,{type:"primary",htmlType:"submit",loading:R,children:L("submit")})})]})})]})}}}]);