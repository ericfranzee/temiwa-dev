"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[7911],{80905:(e,l,t)=>{t.d(l,{j:()=>r});var i=t(9950),n=t(95491),a=t.n(n),o=t(99674),d=t(90650),s=t(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:t=400,hasMore:n,...r}=e;const[u,c]=(0,i.useState)(!1),[v,h]=(0,i.useState)([]),[p,g]=(0,i.useState)(!1),[A,x]=(0,i.useState)(null),[y,j]=(0,i.useState)(1),f=(0,i.useMemo)((()=>a()((e=>{h([]),x(e),c(!0),l({search:e}).then((e=>{h(e),j(2),c(!1)})).finally((()=>g(!1)))}),t)),[l,t,y]);return(0,s.jsxs)(o.A,{showSearch:!0,allowClear:!0,onPopupScroll:async e=>{const t=e.target;p||t.scrollTop+t.offsetHeight!==t.scrollHeight||n&&(g(!0),t.scrollTo(0,t.scrollHeight),l({search:A,page:y}).then((e=>{j((e=>e+1)),h([...v,...e])})).finally((()=>g(!1))))},labelInValue:!0,filterOption:!1,onSearch:f,notFoundContent:u?(0,s.jsx)(d.A,{size:"small"}):"no results",onFocus:()=>{v.length||f("")},...r,children:[v.map(((e,l)=>(0,s.jsx)(o.A.Option,{value:e.value,children:e.label},l))),p&&(0,s.jsx)(o.A.Option,{children:(0,s.jsx)(d.A,{size:"small"})})]})}},8297:(e,l,t)=>{t.d(l,{A:()=>s});var i=t(9950),n=t(55902),a=t(41397),o=t(60767),d=t(44414);function s(e){let{handleChange:l,defaultValue:t,resetSearch:s,...r}=e;const[u,c]=(0,i.useState)(t),v=(0,i.useMemo)((()=>(0,a.debounce)((e=>{l(e)}),800)),[]);return(0,i.useEffect)((()=>{c(t)}),[s]),(0,d.jsx)(n.A,{value:u,onChange:e=>{c(e.target.value),v(e.target.value)},prefix:(0,d.jsx)(o.A,{}),...r})}},47911:(e,l,t)=>{t.r(l),t.d(l,{default:()=>M});var i=t(9950),n=t(25933),a=t(80737),o=t(48538),d=t(23263),s=t(52913),r=t(55386),u=t(91854),c=t(74623),v=t(85923),h=t(70030),p=t(66882),g=t(8297),A=t(88986),x=t(82206),y=t(28429),j=t(42074),f=t(24513),m=t(44070),b=t(59233),S=t(82706),_=t(90650),k=t(87094),C=t(41988),I=t(55902),O=t(71999),w=t(78687),z=t(80905),V=t(2905),q=t(44414);function F(e){let{visible:l,setVisible:t,id:a,setId:d}=e;const[s]=b.A.useForm(),r=(0,u.wA)(),{t:c}=(0,h.B)(),{defaultLang:g,languages:A}=(0,u.d4)((e=>e.formLang),u.bN),[y,j]=(0,i.useState)(!1),[f,m]=(0,i.useState)(!1),[F,M]=(0,i.useState)(null),B=()=>{M(null),t(!1),s.resetFields(),d(null)};function N(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,t=A.map((e=>{var t;return{["title[".concat(null===e||void 0===e?void 0:e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title}}));return Object.assign({},...t)}return(0,i.useEffect)((()=>{a&&(m(!0),x.A.show(a).then((e=>{var l,t,i,n,a,o;let{data:d}=e;M(d),s.setFieldsValue({active:null===d||void 0===d?void 0:d.active,country_id:{label:null===d||void 0===d||null===(l=d.country)||void 0===l||null===(t=l.translation)||void 0===t?void 0:t.title,value:null===d||void 0===d||null===(i=d.country)||void 0===i?void 0:i.id},region_id:{label:null===d||void 0===d||null===(n=d.region)||void 0===n||null===(a=n.translation)||void 0===a?void 0:a.title,value:null===d||void 0===d||null===(o=d.region)||void 0===o?void 0:o.id},...N(d)})})).finally((()=>m(!1))))}),[a]),(0,q.jsx)(S.A,{visible:l,onCancel:B,onOk:B,footer:null,loading:f,title:c("add.city"),children:(0,q.jsxs)(b.A,{form:s,onFinish:e=>{var l,t;j(!0);const i={country_id:null===e||void 0===e||null===(l=e.country_id)||void 0===l?void 0:l.value,region_id:null===e||void 0===e||null===(t=e.region_id)||void 0===t?void 0:t.value,active:null===e||void 0===e?void 0:e.active,title:{...Object.assign({},...null===A||void 0===A?void 0:A.map((l=>({[null===l||void 0===l?void 0:l.locale]:e["title[".concat(null===l||void 0===l?void 0:l.locale,"]")]}))))}};null!==F&&void 0!==F&&F.id?(e=>{x.A.update(F.id,e).then((()=>{v.oR.success(c("successfully.updated")),(0,u.vA)((()=>{r((0,p.e)({}))})),B()})).finally((()=>j(!1)))})(i):(e=>{x.A.create(e).then((()=>{v.oR.success(c("successfully.added")),(0,u.vA)((()=>{r((0,p.e)({}))})),B()})).finally((()=>j(!1)))})(i)},layout:"vertical",initialValues:{active:!0},children:[(0,q.jsx)(_.A,{spinning:f,children:(0,q.jsxs)(k.A,{gutter:24,children:[(0,q.jsx)(C.A,{span:24,children:(0,q.jsx)(O.A,{})}),(0,q.jsx)(C.A,{span:24,children:A.map((e=>(0,q.jsx)(b.A.Item,{label:c("title"),name:"title[".concat(e.locale,"]"),hidden:e.locale!==g,rules:[{required:(null===e||void 0===e?void 0:e.locale)===g,message:c("required")}],children:(0,q.jsx)(I.A,{})},"title"+e.id)))}),(0,q.jsx)(C.A,{span:24,children:(0,q.jsx)(b.A.Item,{name:"region_id",label:c("region_id"),rules:[{required:!0,message:c("required")}],children:(0,q.jsx)(z.j,{fetchOptions:e=>{let{search:l,page:t}=e;return V.A.get({search:null!==l&&void 0!==l&&l.length?l:void 0,page:t}).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))))}})})}),(0,q.jsx)(C.A,{span:24,children:(0,q.jsx)(b.A.Item,{name:"country_id",label:c("country_id"),rules:[{required:!0,message:c("required")}],children:(0,q.jsx)(z.j,{fetchOptions:e=>{let{search:l,page:t}=e;return w.A.get({search:null!==l&&void 0!==l&&l.length?l:void 0,page:t}).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id}}))))}})})}),(0,q.jsx)(C.A,{span:4,children:(0,q.jsx)(b.A.Item,{label:c("active"),name:"active",valuePropName:"checked",children:(0,q.jsx)(n.A,{defaultChecked:!0})})})]})}),(0,q.jsx)(o.A,{type:"primary",htmlType:"submit",loading:y,children:c("submit")})]})})}const M=()=>{const{t:e}=(0,h.B)(),l=(0,u.wA)(),t=(0,y.Zp)();let[b,S]=(0,j.ok)();const{setIsModalVisible:_}=(0,i.useContext)(r.o),{activeMenu:k}=(0,u.d4)((e=>e.menu),u.bN),C=null===k||void 0===k?void 0:k.data,I=b.get("country_id"),{list:O,meta:w,loading:z}=(0,u.d4)((e=>e.deliveryCity),u.bN),[V,M]=(0,i.useState)(!1),[B,N]=(0,i.useState)(!1),[R,T]=(0,i.useState)(!1),[E,H]=(0,i.useState)(null),P=[{title:e("id"),dataIndex:"id",key:"id"},{title:e("name"),dataIndex:"translation",key:"translation",render:(i,n)=>(0,q.jsx)("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>(i=>{l((0,c.X4)({url:"deliveryzone/area?city_id=".concat(i.id),id:"area",name:e("area")})),t("/deliveryzone/area?city_id=".concat(i.id))})(n),children:(null===i||void 0===i?void 0:i.title)||"-"})},{title:e("active"),dataIndex:"active",key:"active",render:(t,i)=>(0,q.jsx)(n.A,{onChange:()=>(t=>{M(t),x.A.status(t).then((()=>{_(!1),l((0,p.e)({country_id:I})),v.oR.success(e("successfully.updated"))})).finally((()=>{M(null)}))})(i.id),checked:t,loading:Boolean(V===i.id)},i.id)},{title:e("options"),dataIndex:"options",is_show:!0,render:(t,i)=>(0,q.jsxs)(a.A,{children:[(0,q.jsx)(o.A,{type:"primary",icon:(0,q.jsx)(f.A,{}),onClick:()=>(e=>{N(!0),H(e)})(i.id)}),(0,q.jsx)(o.A,{loading:Boolean(R===i.id),icon:(0,q.jsx)(m.A,{onClick:()=>(t=>{T(t),x.A.delete(t).then((()=>{l((0,p.e)()),v.oR.success(e("successfully.deleted"))})).finally((()=>{T(!1)}))})(i.id)})})]})}];(0,i.useEffect)((()=>{k.refetch&&(l((0,p.e)({country_id:I})),l((0,c.km)(k)))}),[k.refetch]),(0,A.A)((()=>{const e={search:null===C||void 0===C?void 0:C.search,country_id:I};l((0,p.e)(e))}),[null===k||void 0===k?void 0:k.data]);return(0,q.jsxs)(d.A,{title:e("cities"),extra:(0,q.jsxs)(a.A,{children:[(0,q.jsx)(g.A,{placeholder:e("search"),handleChange:e=>{return t=e,i="search",void l((0,c.Ok)({activeMenu:k,data:{...C,[i]:t}}));var t,i},defaultValue:null===C||void 0===C?void 0:C.search,resetSearch:!(null!==C&&void 0!==C&&C.search)}),(0,q.jsx)(o.A,{type:"primary",onClick:()=>N(!0),children:e("add.city")})]}),children:[(0,q.jsx)(s.A,{columns:P,dataSource:O,pagination:{pageSize:w.per_page,page:w.current_page,total:w.total},rowKey:e=>e.id,loading:z,onChange:e=>{const{pageSize:t,current:i}=e;l((0,p.e)({perPage:t,page:i,country_id:I}))}}),(0,q.jsx)(F,{visible:B,setVisible:N,id:E,setId:H})]})}}}]);