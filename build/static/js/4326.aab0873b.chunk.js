"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[4326],{35116:(e,l,t)=>{t.d(l,{A:()=>r});t(9950);var n=t(48538),i=t(44070),d=t(85923),o=t(70030),a=t(13311),s=t(44414);function r(e){let{size:l="",onClick:t,type:r="default",...u}=e;const{t:v}=(0,o.B)(),{isDemo:c}=(0,a.A)();return(0,s.jsx)(n.A,{size:l,icon:(0,s.jsx)(i.A,{}),onClick:e=>{c?d.oR.warning(v("cannot.work.demo")):t(e)},type:r,...u})}},28645:(e,l,t)=>{t.d(l,{A:()=>p});var n=t(9950),i=t(66362),d=t(69216),o=t(80737),a=t(25933),s=t(57811),r=t(81541),u=t(48538),v=t(89323),c=t(70030),h=t(44414);const{Text:m}=i.A,p=e=>{let{columns:l=[],setColumns:t,style:i,size:p="",iconOnly:x}=e;const{t:y}=(0,c.B)(),[g,f]=(0,n.useState)(!1),A=(0,h.jsx)(d.A,{children:null===l||void 0===l?void 0:l.map(((e,n)=>(0,h.jsx)(d.A.Item,{children:(0,h.jsxs)(o.A,{className:"d-flex justify-content-between",children:[(0,h.jsx)(m,{children:e.title}),(0,h.jsx)(a.A,{defaultChecked:!0,onClick:()=>function(e){const n=null===l||void 0===l?void 0:l.map((l=>(l.dataIndex===e.dataIndex&&(l.is_show=!(null!==l&&void 0!==l&&l.is_show)),l)));t(n)}(e),disabled:1===n})]})},e+n)))});return(0,h.jsx)(s.A,{overlay:A,trigger:["click"],onVisibleChange:e=>{f(e)},visible:g,children:(0,h.jsx)(r.A,{title:y("change.columns"),children:(0,h.jsx)(u.A,{style:{...i},size:p,icon:(0,h.jsx)(v.A,{}),children:x?null:y("Columns")})})})}},8297:(e,l,t)=>{t.d(l,{A:()=>s});var n=t(9950),i=t(55902),d=t(41397),o=t(60767),a=t(44414);function s(e){let{handleChange:l,defaultValue:t,resetSearch:s,...r}=e;const[u,v]=(0,n.useState)(t),c=(0,n.useMemo)((()=>(0,d.debounce)((e=>{l(e)}),800)),[]);return(0,n.useEffect)((()=>{v(t)}),[s]),(0,a.jsx)(i.A,{value:u,onChange:e=>{v(e.target.value),c(e.target.value)},prefix:(0,a.jsx)(o.A,{}),...r})}},47992:(e,l,t)=>{t.d(l,{G:()=>r});var n=t(9950),i=t(95491),d=t.n(i),o=t(99674),a=t(90650),s=t(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:t=400,onClear:i,refetchOptions:r=!1,...u}=e;const[v,c]=(0,n.useState)(!1),[h,m]=(0,n.useState)([]),p=(0,n.useMemo)((()=>d()((e=>{m([]),c(!0),l(e).then((e=>{m(e),c(!1)}))}),t)),[l,t]);return(0,s.jsx)(o.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),i&&i()},notFoundContent:v?(0,s.jsx)(a.A,{size:"small"}):"no results",...u,options:h,onFocus:()=>{h.length&&!r||p("")}})}},80415:(e,l,t)=>{t.d(l,{G:()=>o,HV:()=>i,LH:()=>n,PR:()=>d,wO:()=>s,xt:()=>a});const n={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5],cooking:[1,2,3,4,5]},i=(new Date,new Date,["new","accepted","ready","on_a_way","pause","delivered","canceled"]),d=30,o="HH:mm",a="hh:mm a",s=!0},83645:(e,l,t)=>{t.d(l,{A:()=>o});var n=t(17706),i=t(80415);const d=2147483647;function o(e){let l=((e,l,t)=>{const d=Number(null===(e=n.M.getState())||void 0===e||null===(l=e.globalSettings)||void 0===l||null===(t=l.settings)||void 0===t?void 0:t.order_refresh_timeout);return!isNaN(d)?d:i.PR})();return l?(l>d&&(l=d),setInterval((()=>{e()}),1e3*Number(l))):null}},8168:(e,l,t)=>{function n(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}t.d(l,{A:()=>n})},51066:(e,l,t)=>{t.d(l,{Q:()=>d});var n=t(17706),i=t(80415);const d=()=>{var e,l,t,d;return null!==(e=null===(l=n.M.getState())||void 0===l||null===(t=l.globalSettings)||void 0===t||null===(d=t.settings)||void 0===d?void 0:d.hour_format)&&void 0!==e?e:i.G}},53774:(e,l,t)=>{function n(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const t=Number(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===l?"".concat(t," ").concat(e):"".concat(e," ").concat(t)}t.r(l),t.d(l,{default:()=>n})},65820:(e,l,t)=>{t.d(l,{s:()=>o});var n=t(28429),i=t(21215),d=t.n(i);const o=()=>{const e=(0,n.Zp)(),l=(0,n.zy)(),t=d().parse(l.search,{ignoreQueryPrefix:!0});return{values:t,set:(l,n)=>e({search:d().stringify({...t,[l]:n})}),reset:l=>{const n={...t};n[l]&&delete n[l],e({search:d().stringify({...n})})},clear:()=>e({search:d().stringify({})}),merge:l=>e({search:d().stringify({...t,...l})})}}},58891:(e,l,t)=>{t.d(l,{A:()=>r});var n=t(24893),i=(t(9950),t(50384)),d=t(26678),o=t(28429),a=t(44414);const s=[{value:"seller/orders-board",title:"Board",icon:(0,a.jsx)(d.oeo,{size:20})},{value:"seller/orders",title:"List",icon:(0,a.jsx)(i.AyK,{size:20})}],r=e=>{let{listType:l}=e;const{type:t}=(0,o.g)(),i=(0,o.Zp)();return(0,a.jsx)(n.Ay.Group,{value:l,onChange:e=>{i("/".concat(e.target.value).concat(t?"/".concat(t):""))},className:"float-right",buttonStyle:"solid",children:null===s||void 0===s?void 0:s.map((e=>(0,a.jsx)(n.Ay.Button,{value:e.value,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"10px"},children:[e.icon,e.title]})},e.value)))})}},94326:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Q});var n=t(9950),i=t(86971),d=t(54909),o=t(12916),a=t(80737),s=t(48538),r=t(23263),u=t(99674),v=t(52913),c=t(28429),h=t(24513),m=t(12678),p=t(44070),x=t(53387),y=t(13700),g=t(91854),f=t(74623),A=t(70030),j=t(88986),b=t(20626),_=t(8168),k=t(8297),w=t(51242),C=t(53774),S=t(47992),I=t(66209),M=t(28645),N=t(90352),D=t(35116),Y=t(55386),O=t(85923),z=t(76083),P=t(57056),B=t(10156),F=t(69447),G=t(58891),V=t(65820),R=t(59051),T=t.n(R),L=t(83645),E=t(51066),q=t(44414);const{RangePicker:H}=i.A,{TabPane:K}=d.A;function Q(){var e,l,t,i,R,Q,Z,X,$,J,U;const W=(0,g.wA)(),ee=(0,c.Zp)(),{t:le}=(0,A.B)(),te=(0,c.g)(),[ne,ie]=(0,n.useState)(null),[de,oe]=(0,n.useState)(null),{setIsModalVisible:ae}=(0,n.useContext)(Y.o),[se,re]=(0,n.useState)(!1),{defaultCurrency:ue}=(0,g.d4)((e=>e.currency),g.bN),{statusList:ve}=(0,g.d4)((e=>e.orderStatus),g.bN),ce=null===te||void 0===te?void 0:te.type,he=[{name:"all",id:0,active:!0,sort:0},...ve],[me,pe]=(0,n.useState)(null),[xe,ye]=(0,n.useState)(null),ge=(0,E.Q)(),[fe,Ae]=(0,n.useState)([{title:le("id"),dataIndex:"id",key:"id",sorter:!0,is_show:!0},{title:le("client"),dataIndex:"user",key:"user",is_show:!0,render:e=>e?(0,q.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.firstname)||""," ",(null===e||void 0===e?void 0:e.lastname)||""]}):(0,q.jsx)(o.A,{color:"red",children:le("deleted.user")})},{title:le("status"),is_show:!0,dataIndex:"status",key:"status",render:(e,l)=>(0,q.jsxs)("div",{className:"cursor-pointer",children:["new"===e?(0,q.jsx)(o.A,{color:"blue",children:le(e)}):"canceled"===e?(0,q.jsx)(o.A,{color:"error",children:le(e)}):(0,q.jsx)(o.A,{color:"cyan",children:le(e)}),"delivered"!==e&&"canceled"!==e&&1!==l.type?(0,q.jsx)(h.A,{onClick:e=>{e.stopPropagation(),ye(null===l||void 0===l?void 0:l.id)}}):""]})},{title:le("deliveryman"),is_show:!0,dataIndex:"deliveryman",key:"deliveryman",render:e=>(0,q.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.firstname)||"-"," ",(null===e||void 0===e?void 0:e.lastname)||"-"]})},{title:le("number.of.products"),dataIndex:"order_details_count",key:"order_details_count",is_show:!0,render:e=>(0,q.jsxs)("div",{className:"text-lowercase",children:[e||0," ",le("products")]})},{title:le("amount"),dataIndex:"total_price",key:"total_price",is_show:!0,render:e=>(0,C.default)(e,null===ue||void 0===ue?void 0:ue.symbol)},{title:le("payment.type"),dataIndex:"transaction",key:"transaction",is_show:!0,render:e=>{var l;return le(null===e||void 0===e||null===(l=e.payment_system)||void 0===l?void 0:l.tag)||"-"}},{title:le("created.at"),is_show:!0,dataIndex:"created_at",key:"created_at",render:e=>T()(e).format("YYYY-MM-DD ".concat(ge))},{title:le("delivery.date"),is_show:!0,dataIndex:"delivery_date",key:"delivery_date",render:e=>T()(e).format("YYYY-MM-DD ".concat(ge))},{title:le("options"),key:"options",is_show:!0,render:(e,l)=>(0,q.jsxs)(a.A,{children:[(0,q.jsx)(s.A,{icon:(0,q.jsx)(m.A,{}),onClick:()=>(e=>{W((0,f.X4)({url:"seller/order/details/".concat(e.id),id:"order_details",name:le("order.details")})),ee("/seller/order/details/".concat(e.id))})(l)}),(0,q.jsx)(D.A,{icon:(0,q.jsx)(p.A,{}),onClick:()=>{ie([l.id]),ae(!0),oe(!0)}})]})}]),{activeMenu:je}=(0,g.d4)((e=>e.menu),g.bN),be=(0,V.s)(),[_e,ke]=(0,n.useState)(be.values.status||"all"),we=(null===(e=je.data)||void 0===e?void 0:e.role)||_e,{orders:Ce,meta:Se,loading:Ie,params:Me}=(0,g.d4)((e=>e.sellerOrders),g.bN),[Ne,De]=(0,n.useState)(null);console.log("dateRange",Ne);const Ye=null===je||void 0===je?void 0:je.data,Oe={search:null===Ye||void 0===Ye?void 0:Ye.search,sort:null===Ye||void 0===Ye?void 0:Ye.sort,column:null===Ye||void 0===Ye?void 0:Ye.column,perPage:null===Ye||void 0===Ye?void 0:Ye.perPage,page:null===Ye||void 0===Ye?void 0:Ye.page,user_id:null===Ye||void 0===Ye?void 0:Ye.user_id,status:"all"===we?void 0:we,shop_id:null!==(null===(l=je.data)||void 0===l?void 0:l.shop_id)?null===(t=je.data)||void 0===t?void 0:t.shop_id:null,delivery_type:ce||(null!==(null===(i=je.data)||void 0===i?void 0:i.delivery_type)?null===(R=je.data)||void 0===R?void 0:R.delivery_type:null),date_from:(null===Ne||void 0===Ne||null===(Q=Ne[0])||void 0===Q?void 0:Q.format("YYYY-MM-DD"))||void 0,date_to:(null===Ne||void 0===Ne||null===(Z=Ne[1])||void 0===Z?void 0:Z.format("YYYY-MM-DD"))||void 0};(0,j.A)((()=>{W((0,b.Gb)(Oe))}),[null===je||void 0===je?void 0:je.data,Ne]),(0,n.useEffect)((()=>{null!==je&&void 0!==je&&je.refetch&&(0,g.vA)((()=>{W((0,b.Gb)(Oe)),W((0,N.nr)({})),W((0,f.km)(je))}));const e=(0,L.A)((()=>{W((0,b.Gb)(Oe))}));return()=>clearInterval(e)}),[null===je||void 0===je?void 0:je.refetch]);const ze=(e,l)=>{W((0,f.Ok)({activeMenu:je,data:{...Ye,[l]:e}}))};const Pe={selectedRowKeys:ne,onChange:e=>{ie(e)}},Be=()=>{pe(null),ye(null)};return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(a.A,{className:"justify-content-end w-100 mb-3",children:[(0,q.jsx)(G.A,{listType:"seller/orders"}),(0,q.jsx)(s.A,{type:"primary",icon:(0,q.jsx)(x.A,{}),onClick:()=>{W((0,w.Uy)()),W((0,f.X4)({id:"pos.system",url:"seller/pos-system",name:le("add.order")})),ee("/seller/pos-system",{state:{delivery_type:ce}})},style:{width:"100%"},children:le("add.order")})]}),(0,q.jsx)(r.A,{children:(0,q.jsxs)(a.A,{wrap:!0,className:"p-0 mb-0",children:[(0,q.jsx)(k.A,{placeholder:le("search"),handleChange:e=>ze(e,"search"),defaultValue:null===(X=je.data)||void 0===X?void 0:X.search}),(0,q.jsx)(S.G,{placeholder:le("select.client"),fetchOptions:async function(e){const l={search:e,perPage:10};return I.A.getAll(l).then((e=>{let{data:l}=e;return l.map((e=>({label:"".concat(e.firstname," ").concat(e.lastname),value:e.id,key:e.id})))}))},onSelect:e=>ze(e.value,"search"),onDeselect:()=>ze(null,"search"),style:{minWidth:200}}),(0,q.jsx)(H,{value:Ne,onChange:e=>{ze(JSON.stringify(e),"data_time"),De(e)},disabledDate:e=>e&&e>T()().endOf("day"),style:{width:"100%"}}),!ce&&(0,q.jsx)(u.A,{value:null===Ye||void 0===Ye?void 0:Ye.delivery_type,placeholder:le("order.type"),onSelect:e=>ze(e,"delivery_type"),options:[{label:le("pickup"),value:"pickup"},{label:le("delivery"),value:"delivery"}],allowClear:!0,style:{width:"100%"},onDeselect:()=>ze(null,"delivery_type")}),(0,q.jsx)(s.A,{icon:(0,q.jsx)(y.A,{}),onClick:()=>{(0,g.vA)((()=>{W((0,b.gw)()),W((0,f.Ok)({activeMenu:je,data:null}))})),W((0,b.Gb)({status:"all",page:null===Ye||void 0===Ye?void 0:Ye.page,perPage:10}))},children:le("clear")}),(0,q.jsx)(D.A,{size:"",onClick:()=>{null===ne||0===ne.length?O.oR.warning(le("select.the.product")):(ae(!0),oe(!1))},children:le("delete.selected")}),(0,q.jsx)(M.A,{columns:fe,setColumns:Ae})]})}),(0,q.jsxs)(r.A,{children:[(0,q.jsx)(d.A,{onChange:e=>{const l=e;W((0,f.Ok)({activeMenu:je,data:{role:l,page:1}})),ke(e),ee("?status=".concat(l))},type:"card",activeKey:we,children:he.filter((e=>!0===e.active)).map((e=>(0,q.jsx)(K,{tab:le(e.name)},e.name)))}),(0,q.jsx)(v.A,{scroll:{x:!0},rowSelection:Pe,columns:null===fe||void 0===fe?void 0:fe.filter((e=>e.is_show)),dataSource:Ce,loading:Ie,pagination:{pageSize:Me.perPage,page:(null===($=je.data)||void 0===$?void 0:$.page)||1,total:null===Se||void 0===Se?void 0:Se.total,defaultCurrent:null===(J=je.data)||void 0===J?void 0:J.page,current:null===(U=je.data)||void 0===U?void 0:U.page},rowKey:e=>e.id,onChange:function(e,l,t){const{pageSize:n,current:i}=e,{field:d,order:o}=t,a=(0,_.A)(o);W((0,f.Ok)({activeMenu:je,data:{...Ye,perPage:n,page:i,column:d,sort:a}}))}}),(0,q.jsx)(z.A,{click:()=>{re(!0);const e={...Object.assign({},...ne.map(((e,l)=>({["ids[".concat(l,"]")]:e}))))};P.A.delete(e).then((()=>{O.oR.success(le("successfully.deleted")),ae(!1),W((0,b.Gb)(Oe)),oe(null)})).finally((()=>re(!1)))},text:le(de?"delete":"all.delete"),loading:se,setText:ie})]}),xe&&(0,q.jsx)(F.A,{orderId:xe,handleCancel:Be,refetchPage:()=>(0,g.vA)((()=>{W((0,b.Gb)(Oe)),W((0,f.km)(je))}))}),me&&(0,q.jsx)(B.A,{orderDetails:me,handleCancel:Be})]})}},10156:(e,l,t)=>{t.d(l,{A:()=>y});var n=t(9950),i=t(59233),d=t(82706),o=t(48538),a=t(87094),s=t(41988),r=t(91854),u=t(57056),v=t(74623),c=t(70030),h=t(29514),m=t(47992),p=t(66209),x=t(44414);function y(e){var l;let{orderDetails:t,handleCancel:y}=e;const{t:g}=(0,c.B)(),{activeMenu:f}=(0,r.d4)((e=>e.menu),r.bN),{deliverymans:A}=(0,r.d4)((e=>e.deliveryman),r.bN),[j]=i.A.useForm(),b=(0,r.wA)(),[_,k]=(0,n.useState)(!1);(0,n.useEffect)((()=>{b((0,h.d8)())}),[]);return(0,x.jsx)(d.A,{visible:!!t,title:t.title,onCancel:y,footer:[(0,x.jsx)(o.A,{type:"primary",onClick:()=>j.submit(),loading:_,children:g("save")}),(0,x.jsx)(o.A,{type:"default",onClick:y,children:g("cancel")})],children:(0,x.jsx)(i.A,{form:j,layout:"vertical",onFinish:e=>{const l={deliveryman:e.deliveryman.value};k(!0),u.A.updateDelivery(t.id,l).then((()=>{y(),b((0,v.Ms)(f))})).finally((()=>k(!1)))},initialValues:{deliveryman:null===(l=t.deliveryman)||void 0===l?void 0:l.id},children:(0,x.jsx)(a.A,{gutter:12,children:(0,x.jsx)(s.A,{span:24,children:(0,x.jsx)(i.A.Item,{label:g("deliveryman"),name:"deliveryman",rules:[{required:!0,message:g("required")}],children:(0,x.jsx)(m.G,{fetchOptions:e=>{const l={perPage:10,page:1,search:e};return p.A.getDeliverymans(l).then((e=>e.data.map((e=>({label:e.firstname,value:e.id})))))}})})})})})})}},69447:(e,l,t)=>{t.d(l,{A:()=>w});var n=t(9950),i=t(98412),d=t(59233),o=t(82706),a=t(48538),s=t(87094),r=t(41988),u=t(55902),v=t(40895),c=t(99674),h=t(91854),m=t(70030),p=t(57056),x=t(81446),y=t(71999),g=t(87210),f=t(24513),A=t(59051),j=t.n(A),b=t(51066),_=t(44414);const{Panel:k}=i.A;function w(e){var l;let{orderId:t,handleCancel:A,refetchPage:w}=e;const{statusList:C}=(0,h.d4)((e=>e.orderStatus),h.bN),{defaultLang:S,languages:I}=(0,h.d4)((e=>e.formLang),h.bN),[M]=d.A.useForm(),{t:N}=(0,m.B)(),D=(0,n.useRef)(null),[Y,O]=(0,n.useState)(!1),[z,P]=(0,n.useState)(!1),[B,F]=(0,n.useState)(null!==C&&void 0!==C&&C.length?C.map((e=>({value:null===e||void 0===e?void 0:e.name,label:N(null===e||void 0===e?void 0:e.name),key:null===e||void 0===e?void 0:e.id}))):[]),[G,V]=(0,n.useState)(null),[R,T]=(0,n.useState)(null),[L,E]=(0,n.useState)(null),[q,H]=(0,n.useState)(null),K=(0,b.Q)();(0,n.useEffect)((()=>{O(!0),p.A.getById(t).then((e=>{var l,t,n,i;V(e.data),T(null===(l=e.data)||void 0===l||null===(t=l.notes)||void 0===t?void 0:t.filter((e=>{var l;return!(null===e||void 0===e||null===(l=e.notes)||void 0===l||!l.length)}))),H(null===(n=e.data)||void 0===n?void 0:n.status),M.setFieldsValue({status:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.status})})).finally((()=>O(!1)))}),[t]),(0,n.useEffect)((()=>{var e,l;if("pause"===(null===G||void 0===G?void 0:G.status))return void F(null===C||void 0===C?void 0:C.map((e=>({value:null===e||void 0===e?void 0:e.name,label:N(null===e||void 0===e?void 0:e.name),key:null===e||void 0===e?void 0:e.id}))));const t=C.findIndex((e=>e.name===(null===G||void 0===G?void 0:G.status))),n=t>=0?[C[t],t<C.length-1?"pause"===(null===(e=C[t+1])||void 0===e?void 0:e.name)?C[t+2]:C[t+1]:null]:[t<C.length-1?C[t+1]:null];var i;("on_a_way"===(null===(l=C[t])||void 0===l?void 0:l.name)&&n.push(C[t+4]),null!==C&&void 0!==C&&C.filter((e=>"pause"===(null===e||void 0===e?void 0:e.name)&&(null===e||void 0===e?void 0:e.active))))&&(null===n||void 0===n||n.push(null===C||void 0===C||null===(i=C.filter((e=>"pause"===(null===e||void 0===e?void 0:e.name)&&(null===e||void 0===e?void 0:e.active))))||void 0===i?void 0:i[0]));n.push({name:"canceled",id:8,active:!0,sort:(null===C||void 0===C?void 0:C.length)+1}),F(n.filter(Boolean).map((e=>({value:null===e||void 0===e?void 0:e.name,label:N(null===e||void 0===e?void 0:e.name),key:null===e||void 0===e?void 0:e.id}))))}),[G]);const Q=e=>{const l=Object.entries(e).filter((e=>{let[l,t]=e;return!!t}));if(0!==(null===l||void 0===l?void 0:l.length))return Object.fromEntries(l)};return(0,n.useEffect)((()=>{var e;M.setFieldsValue({["title[".concat(S||"en","]")]:null===L||void 0===L||null===(e=L.title)||void 0===e?void 0:e[S||"en"]})}),[S]),(0,_.jsx)(o.A,{visible:!!t,title:[N("order.status")],onCancel:A,footer:[(0,_.jsx)(a.A,{type:"primary",onClick:()=>M.submit(),loading:z,children:N("save")},"save-form"),(0,_.jsx)(a.A,{type:"default",onClick:A,children:N("cancel")},"cansel-modal")],children:Y?(0,_.jsx)(x.A,{}):(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(d.A,{form:M,layout:"vertical",onFinish:e=>{var l;let t=null;P(!0),L&&(null===e||void 0===e?void 0:e.status)===(null===G||void 0===G?void 0:G.status)&&(t={...Object.assign({},...I.map((l=>({[l.locale]:e["title[".concat(l.locale,"]")]}))))},t=Q(t));const n=Q({...Object.assign({},...I.map((l=>({[l.locale]:e["note[".concat(l.locale,"]")]}))))}),i=n?{title:n}:null,d=(null===G||void 0===G?void 0:G.status)===(null===e||void 0===e?void 0:e.status)?null===G||void 0===G||null===(l=G.notes)||void 0===l?void 0:l.filter((l=>(null===l||void 0===l?void 0:l.status)===(null===e||void 0===e?void 0:e.status))).flatMap((e=>{var l;return null===e||void 0===e||null===(l=e.notes)||void 0===l?void 0:l.map(((e,l)=>l===(null===L||void 0===L?void 0:L.index)?{...e,title:{...null===e||void 0===e?void 0:e.title,...t}}:e))})).filter(Boolean):[],o={status:null===e||void 0===e?void 0:e.status,notes:[...d,i].filter(Boolean)};p.A.updateStatus(G.id,o).then((()=>{A(),w()})).finally((()=>P(!1)))},name:"order-status-change-form",children:[(0,_.jsx)(s.A,{gutter:12,style:{marginBottom:"20px"},children:(0,_.jsx)(r.A,{span:24,children:(0,_.jsx)(y.A,{})})}),!(null===G||void 0===G||null===(l=G.notes)||void 0===l||!l.some((e=>{var l;return!(null===e||void 0===e||null===(l=e.notes)||void 0===l||!l.length)})))&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(i.A,{children:null===R||void 0===R?void 0:R.map((e=>{var l;return(0,_.jsx)(k,{header:N(null===e||void 0===e?void 0:e.status),children:(null===e||void 0===e||null===(l=e.notes)||void 0===l?void 0:l.map(((l,t)=>{var n,i,o;return(0,_.jsxs)(s.A,{style:{marginBottom:"15px",display:"flex",justifyContent:"space-between"},gutter:12,children:[(0,_.jsxs)(r.A,{span:(null===e||void 0===e?void 0:e.status)===(null===G||void 0===G?void 0:G.status)&&q===(null===G||void 0===G?void 0:G.status)?22:24,children:[(0,_.jsxs)("div",{style:{display:"flex",columnGap:"10px"},children:[(0,_.jsxs)("span",{style:{marginTop:"3px"},children:[t+1,"."," "]}),(0,_.jsxs)("div",{style:{width:"100%"},children:[(0,_.jsx)("p",{style:{margin:0,fontSize:"15px",wordBreak:"break-all"},hidden:(null===L||void 0===L?void 0:L.orderId)===(null===e||void 0===e?void 0:e.id)&&(null===L||void 0===L?void 0:L.index)===t&&(null===G||void 0===G?void 0:G.status)===q,children:(null===l||void 0===l||null===(n=l.title)||void 0===n?void 0:n[S||"en"])||"--"}),(0,_.jsx)(d.A.Item,{name:"title[".concat(S||"en","]"),hidden:(null===L||void 0===L?void 0:L.orderId)!==(null===e||void 0===e?void 0:e.id)||(null===L||void 0===L?void 0:L.index)!==t||(null===G||void 0===G?void 0:G.status)!==q,children:(0,_.jsx)(u.A.TextArea,{maxLength:200,style:{width:"100%"},rows:Math.floor((null===l||void 0===l||null===(i=l.title)||void 0===i||null===(o=i[S||"en"])||void 0===o?void 0:o.length)/41||0)+1,ref:D},t)})]})]}),(0,_.jsx)("p",{style:{fontSize:"12px",margin:0,float:"right"},children:j()(null===l||void 0===l?void 0:l.created_at).format("DD-MM-YYYY ".concat(K))})]}),(null===e||void 0===e?void 0:e.status)===(null===G||void 0===G?void 0:G.status)&&(null===G||void 0===G?void 0:G.status)===q&&(0,_.jsx)(r.A,{span:2,children:(null===L||void 0===L?void 0:L.orderId)===(null===e||void 0===e?void 0:e.id)&&t===(null===L||void 0===L?void 0:L.index)?(0,_.jsx)(a.A,{type:"primary",icon:(0,_.jsx)(g.A,{}),size:"small",onClick:()=>M.submit(),loading:z}):(null===e||void 0===e?void 0:e.status)===(null===G||void 0===G?void 0:G.status)&&(0,_.jsx)(a.A,{icon:(0,_.jsx)(f.A,{}),size:"small",onClick:()=>{var n;D.current.focus(),E({orderId:null===e||void 0===e?void 0:e.id,index:t,title:null===l||void 0===l?void 0:l.title}),M.setFieldsValue({["title[".concat(S||"en","]")]:null===l||void 0===l||null===(n=l.title)||void 0===n?void 0:n[S||"en"]})}})})]},t)})))||"--"},null===e||void 0===e?void 0:e.id)}))}),(0,_.jsx)(v.A,{})]}),(0,_.jsxs)(s.A,{gutter:12,children:[(0,_.jsx)(r.A,{span:24,children:(0,_.jsx)(d.A.Item,{label:N("status"),name:"status",rules:[{required:!0,message:N("required")}],children:(0,_.jsx)(c.A,{options:B,onSelect:e=>H(e)})})}),(0,_.jsx)(r.A,{span:24,children:I.map((e=>(0,_.jsx)(d.A.Item,{name:"note[".concat(null===e||void 0===e?void 0:e.locale,"]"),label:N("note"),hidden:(null===e||void 0===e?void 0:e.locale)!==S,children:(0,_.jsx)(u.A.TextArea,{maxLength:200})},"note_".concat(null===e||void 0===e?void 0:e.id))))})]})]})})})}}}]);