"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5505],{27276:(e,a,t)=>{t.d(a,{v:()=>d});var l=t(9950),i=t(90777),s=t(90650),n=t(44414);const d=e=>{let{fetchOptions:a,refetch:t=!1,...d}=e;const[r,u]=(0,l.useState)(!1),[o,c]=(0,l.useState)([]);return(0,n.jsx)(i.A,{treeLine:!0,treeData:r?[]:o,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{o.length&&!t||(u(!0),a().then((e=>{c(e),u(!1)})))},notFoundContent:r?(0,n.jsx)(s.A,{size:"small"}):"no results",...d})}},55505:(e,a,t)=>{t.r(a),t.d(a,{default:()=>I});var l=t(9950),i=t(59233),s=t(23263),n=t(87094),d=t(40577),r=t(41988),u=t(55902),o=t(99674),c=t(48538),m=t(90650),v=t(85923),p=t(28429),h=t(71999),g=t(98591),y=t(91854),A=t(74623),x=t(12598),j=t(63620),b=t(70030),f=t(48970),k=t(8228),q=t(3462),w=t(27276),_=t(44414);const I=()=>{var e,a;const{t:t}=(0,b.B)(),I=(0,p.Zp)(),S=(0,y.wA)(),{activeMenu:F}=(0,y.d4)((e=>e.menu),y.bN),{params:N}=(0,y.d4)((e=>e.requestModels),y.bN),[C,E]=(0,l.useState)(!1),[L,V]=(0,l.useState)(null!==(e=F.data)&&void 0!==e&&e.image?[null===(a=F.data)||void 0===a?void 0:a.image]:[]),[z]=i.A.useForm(),[M,O]=(0,l.useState)(!1),[B,D]=(0,l.useState)(null),[U,K]=(0,l.useState)("main"),{user:P}=(0,y.d4)((e=>e.auth),y.bN),{id:R}=(0,p.g)(),{defaultLang:T,languages:Z}=(0,y.d4)((e=>e.formLang),y.bN);(0,l.useEffect)((()=>()=>{const e=z.getFieldsValue(!0);S((0,A.Ok)({activeMenu:F,data:e}))}),[]);(0,l.useEffect)((()=>{var e;F.refetch&&(e=R,E(!0),k.A.getById(e).then((e=>{var a,t,l,i;let s=e.data;const n={...null===s||void 0===s?void 0:s.data,keywords:null===(a=s.data)||void 0===a?void 0:a.keywords.split(","),parent_id:{label:null===(t=s.parent)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title,value:s.data.parent_id,key:s.data.parent_id}};var d;z.setFieldsValue(n),V([(d=null===(i=s.data.images)||void 0===i?void 0:i.at(0),{name:d,url:j.sE+d})])})).finally((()=>{E(!1),S((0,A.km)(F))})))}),[F.refetch]);return(0,_.jsx)(s.A,{title:t("edit.request"),extra:(0,_.jsx)(h.A,{}),children:C?(0,_.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,_.jsx)(m.A,{size:"large",className:"mt-5 pt-5"})}):(0,_.jsxs)(i.A,{name:"basic",layout:"vertical",onFinish:e=>{var a,l;O(!0);const i={id:e.id,type:"category",data:{...e,type:null!==(a=e.parent_id)&&void 0!==a&&a.value?U:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(l=e.parent_id)||void 0===l?void 0:l.value,images:null===L||void 0===L?void 0:L.map((e=>e.name))}},s={...N,shop_id:null===P||void 0===P?void 0:P.shop_id},n="seller/categories";k.A.requestChangeUpdate(R,i).then((()=>{v.oR.success(t("successfully.updated")),S((0,A.EK)({...F,nextUrl:n})),S((0,q.ji)(s)),I("/".concat(n),{state:{tab:"request"}})})).catch((e=>D(e.response.data.params))).finally((()=>O(!1)))},initialValues:{active:!0,...F.data},form:z,children:[(0,_.jsxs)(n.A,{gutter:12,children:[(0,_.jsx)(i.A.Item,{name:"id",hidden:!0,children:(0,_.jsx)(d.A,{})}),(0,_.jsx)(r.A,{span:12,children:Z.map(((e,a)=>(0,_.jsx)(i.A.Item,{label:t("name"),name:["title",e.locale],help:B&&B.title[T]?B.title[T][0]:null,validateStatus:B?"error":"success",rules:[{required:e.locale===T,message:t("required")}],hidden:e.locale!==T,children:(0,_.jsx)(u.A,{})},e.title+a)))}),(0,_.jsx)(r.A,{span:12,children:Z.map(((e,a)=>(0,_.jsx)(i.A.Item,{label:t("description"),name:["description",e.locale],rules:[{required:e.locale===T,message:t("required")}],hidden:e.locale!==T,children:(0,_.jsx)(g.A,{rows:4})},e.locale+a)))}),(0,_.jsx)(r.A,{span:12,children:(0,_.jsx)(i.A.Item,{label:t("keywords"),name:"keywords",rules:[{required:!0,message:t("required")}],children:(0,_.jsx)(o.A,{mode:"tags",style:{width:"100%"}})})}),(0,_.jsx)(r.A,{span:12,children:(0,_.jsx)(i.A.Item,{label:t("parent.category"),name:"parent_id",rules:[{required:!1,message:t("required")}],children:(0,_.jsx)(w.v,{fetchOptions:async function(){const{id:e}=z.getFieldValue();return x.A.getAll({perPage:100,type:"main"}).then((a=>a.data.filter((a=>a.id!==e)).map((e=>{var a,t;return{label:null===(a=e.translation)||void 0===a?void 0:a.title,value:e.id,key:e.id,type:"main",children:null===(t=e.children)||void 0===t?void 0:t.map((e=>{var a,t;return{label:null===(a=e.translation)||void 0===a?void 0:a.title,value:e.id,key:e.id,type:"sub_main",children:null===(t=e.children)||void 0===t?void 0:t.map((e=>{var a;return{label:null===(a=e.translation)||void 0===a?void 0:a.title,value:e.id,key:e.id,disabled:!0,type:"child"}}))}}))}}))))},onSelect:(e,a,t)=>{const{type:l}=a||{};K("main"===l?"sub_main":"sub_main"===l?"child":"main")},allowClear:!0})})}),(0,_.jsx)(r.A,{span:4,children:(0,_.jsx)(i.A.Item,{label:t("image"),children:(0,_.jsx)(f.A,{type:"categories",imageList:L,setImageList:V,form:z,multiple:!1})})})]}),(0,_.jsx)(c.A,{type:"primary",htmlType:"submit",loading:M,children:t("submit")})]})})}}}]);