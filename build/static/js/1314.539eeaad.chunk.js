(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[1314],{85023:(e,t,l)=>{"use strict";l.d(t,{D:()=>o});var s=l(9950),n=l(99674),a=l(90650),i=l(44414);const o=e=>{let{fetchOptions:t,refetch:l=!1,value:o,...d}=e;const[r,c]=(0,s.useState)(!1),[u,v]=(0,s.useState)([]);"object"===typeof(null===o||void 0===o?void 0:o.label)&&null!==(null===o||void 0===o?void 0:o.label)&&(o.label=o.label.value);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n.A,{labelInValue:!0,filterOption:!1,notFoundContent:r?(0,i.jsx)(a.A,{size:"small"}):"no results",value:o,...d,options:r?[]:u,onFocus:()=>{u.length&&!l||(c(!0),t().then((e=>{v(e),c(!1)})))},getPopupContainer:e=>e.parentNode})})}},28257:(e,t,l)=>{"use strict";l.d(t,{A:()=>m});l(9950);var s=l(84619),n=l(96011),a=l.n(n),i=l(63620);var o=l(91854),d=l(99674),r=l(59233),c=l(74635),u=l(44414);const v=i.bo?{componentRestrictions:{country:i.bo}}:{},m=e=>{let{value:t,setValue:l,setLocation:n,withLanguages:m=!0}=e;const{placePredictions:p,getPlacePredictions:h,isPlacePredictionsLoading:x}=(0,s.A)({apiKey:i.CJ,libraries:["places","geocode"],options:v}),{defaultLang:j,languages:A}=(0,o.d4)((e=>e.formLang),o.bN),g=()=>(0,u.jsx)(d.A,{allowClear:!0,searchValue:t,showSearch:!0,autoClearSearchValue:!0,loading:x,options:null===p||void 0===p?void 0:p.map((e=>({label:e.description,value:e.description}))),onSearch:e=>{l(e),e.length>0&&h({input:e})},onSelect:async e=>{const t=await async function(e){let t={address:e,key:arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.CJ};return a().get("https://maps.googleapis.com/maps/api/geocode/json",{params:t}).then((e=>{let{data:t}=e;return t.results[0]})).catch((e=>"not found"))}(e);n({lat:null===t||void 0===t?void 0:t.geometry.location.lat,lng:null===t||void 0===t?void 0:t.geometry.location.lng})},getPopupContainer:e=>e.parentNode});return m?(0,u.jsx)(u.Fragment,{children:A.map(((e,t)=>(0,u.jsx)(r.A.Item,{label:(0,c.t)("address"),name:"address[".concat(e.locale,"]"),rules:[{required:e.locale===j,message:(0,c.t)("required")}],hidden:e.locale!==j,children:g()},"address"+t)))}):(0,u.jsx)(r.A.Item,{label:(0,c.t)("address"),name:"address",rules:[{required:!0,message:(0,c.t)("required")}],children:g()})}},78498:(e,t,l)=>{"use strict";l.d(t,{A:()=>x});var s=l(9950),n=l(97239);const a=l.p+"static/media/pin.0e41858db80c699cd8a2.png";var i=l(96011),o=l.n(i),d=l(63620);async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.CJ,l={latlng:"".concat(null===e||void 0===e?void 0:e.lat,",").concat(null===e||void 0===e?void 0:e.lng),key:t};return o().get("https://maps.googleapis.com/maps/api/geocode/json",{params:l}).then((e=>{var t;let{data:l}=e;return null===(t=l.results[0])||void 0===t?void 0:t.formatted_address})).catch((e=>"not found"))}var c=l(39174),u=l(85923),v=l(70030),m=l(6566),p=l(44414);const h=(0,m.A)();const x=(0,n.GoogleApiWrapper)({apiKey:h,libraries:["places","geometry"]})((function(e){var t,l;const[i,o]=(0,s.useState)(),{t:d}=(0,v.B)(),m=async()=>{await navigator.geolocation.getCurrentPosition((function(e){const t={lat:e.coords.latitude,lng:e.coords.longitude};o(t)}),(function(e){u.oR.warning(d("turn.on.gps"))}))};(0,s.useEffect)((()=>{m()}),[]);const x=[{lat:Number(null===e||void 0===e||null===(t=e.location)||void 0===t?void 0:t.lat)||0,lng:Number(null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.lng)||0}];for(var j=new e.google.maps.LatLngBounds,A=0;A<x.length;A++)j.extend(x[A]);return(0,p.jsxs)("div",{className:"map-container",style:{height:400,width:"100%"},children:[(0,p.jsx)("button",{className:"map-button",type:"button",onClick:()=>{m(),i&&(async t=>{const l={lat:null===t||void 0===t?void 0:t.lat,lng:null===t||void 0===t?void 0:t.lng};e.setLocation(l);const s=await r(l,h);e.setAddress(s)})(i)},children:(0,p.jsx)(c.uFi,{})}),(0,p.jsx)(n.Map,{cursor:"pointer",onClick:async(t,l,s)=>{const{latLng:n}=s,a={lat:n.lat(),lng:n.lng()};e.setLocation(a);const i=await r(a,h);e.setAddress(i)},google:e.google,defaultZoom:12,zoom:10,className:"clickable",initialCenter:e.location,center:e.location,children:(0,p.jsx)(n.Marker,{position:e.location,icon:{url:a,scaledSize:new e.google.maps.Size(32,32)},className:"marker"})})]})}))},8297:(e,t,l)=>{"use strict";l.d(t,{A:()=>d});var s=l(9950),n=l(55902),a=l(41397),i=l(60767),o=l(44414);function d(e){let{handleChange:t,defaultValue:l,resetSearch:d,...r}=e;const[c,u]=(0,s.useState)(l),v=(0,s.useMemo)((()=>(0,a.debounce)((e=>{t(e)}),800)),[]);return(0,s.useEffect)((()=>{u(l)}),[d]),(0,o.jsx)(n.A,{value:c,onChange:e=>{u(e.target.value),v(e.target.value)},prefix:(0,o.jsx)(i.A,{}),...r})}},47992:(e,t,l)=>{"use strict";l.d(t,{G:()=>r});var s=l(9950),n=l(95491),a=l.n(n),i=l(99674),o=l(90650),d=l(44414);const r=e=>{let{fetchOptions:t,debounceTimeout:l=400,onClear:n,refetchOptions:r=!1,...c}=e;const[u,v]=(0,s.useState)(!1),[m,p]=(0,s.useState)([]),h=(0,s.useMemo)((()=>a()((e=>{p([]),v(!0),t(e).then((e=>{p(e),v(!1)}))}),l)),[t,l]);return(0,d.jsx)(i.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),n&&n()},notFoundContent:u?(0,d.jsx)(o.A,{size:"small"}):"no results",...c,options:m,onFocus:()=>{m.length&&!r||h("")}})}},80415:(e,t,l)=>{"use strict";l.d(t,{G:()=>i,HV:()=>n,LH:()=>s,PR:()=>a,wO:()=>d,xt:()=>o});const s={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5],cooking:[1,2,3,4,5]},n=(new Date,new Date,["new","accepted","ready","on_a_way","pause","delivered","canceled"]),a=30,i="HH:mm",o="hh:mm a",d=!0},51066:(e,t,l)=>{"use strict";l.d(t,{Q:()=>a});var s=l(17706),n=l(80415);const a=()=>{var e,t,l,a;return null!==(e=null===(t=s.M.getState())||void 0===t||null===(l=t.globalSettings)||void 0===l||null===(a=l.settings)||void 0===a?void 0:a.hour_format)&&void 0!==e?e:n.G}},6566:(e,t,l)=>{"use strict";l.d(t,{A:()=>n});var s=l(17706);const n=()=>{var e,t;const l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IS_DEMO:"false"}.MAP_API_KEY,{google_map_key:n}=null===(e=s.M.getState())||void 0===e||null===(t=e.globalSettings)||void 0===t?void 0:t.settings;return n||l}},8808:(e,t,l)=>{"use strict";l.d(t,{O:()=>a});var s=l(59051),n=l.n(s);const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const l=t/3600;let s,a;l>=168?(s="weeks",a=l/168):l>=24?(s="days",a=l/24):l>=1?(s="hours",a=l):(s="minutes",a=t);return n()(e).add(a,s).toDate()}},31281:(e,t,l)=>{"use strict";function s(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const s=e.map((e=>({[e.locale]:""===t["".concat(l,"[").concat(e.locale,"]")]?void 0:t["".concat(l,"[").concat(e.locale,"]")]})));return Object.assign({},...s)}l.d(t,{A:()=>s})},53774:(e,t,l)=>{"use strict";function s(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const l=Number(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===t?"".concat(l," ").concat(e):"".concat(e," ").concat(l)}l.r(t),l.d(t,{default:()=>s})},66136:(e,t,l)=>{"use strict";l.d(t,{A:()=>n});var s=l(82371);const n={getAll:e=>s.A.get("rest/form-options",{params:e}),getById:e=>s.A.get("rest/form-options/".concat(e))}},74142:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});var s=l(82371);const n="rest/services",a={getAll:e=>s.A.get(n,{params:e}),getById:(e,t)=>s.A.get("".concat(n,"/").concat(e),{params:t}),create:e=>s.A.post(n,e,{}),update:(e,t)=>s.A.put("".concat(n,"/").concat(e),t,{}),delete:e=>s.A.delete("".concat(n,"/delete"),{params:e}),statusChange:(e,t)=>s.A.put("".concat(n,"/").concat(e),t)}},85217:(e,t,l)=>{"use strict";l.d(t,{It:()=>p,Ox:()=>v,_u:()=>m,dM:()=>u,hU:()=>c});l(13567),l(34996);var s=l(50686),n=l(74142),a=l(55660),i=l(53271),o=l(43957),d=l(39362),r=l.n(d);async function c(e){const t={search:e,perPage:10};return i.A.search(t).then((e=>{let{data:t}=e;return t.map((e=>({label:"".concat(null===e||void 0===e?void 0:e.firstname," ").concat(null===e||void 0===e?void 0:e.lastname),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))}async function u(e){let{service_id:t,shop_id:l,search:n}=e;const a={perPage:10,role:"master",search:null!==n&&void 0!==n&&n.length?n:void 0,service_id:t,shop_id:l};return s.A.getAll(a).then((e=>{let{data:t}=e;return t.map((e=>({label:"".concat(null===e||void 0===e?void 0:e.firstname," ").concat(null===e||void 0===e?void 0:e.lastname),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))}const v=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return await n.A.getAll(e).then((e=>{let{data:l}=e;return null===l||void 0===l?void 0:l.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:"".concat(null===e||void 0===e?void 0:e.id," ").concat(e.type),disabled:!(null===t||void 0===t||!t.length)&&!(null===t||void 0===t||!t.find((t=>{var l,s;return(null===t||void 0===t||null===(l=t.service_master)||void 0===l||null===(s=l.service)||void 0===s?void 0:s.id)===(null===e||void 0===e?void 0:e.id)})))}}))}))};async function m(e){const t={search:e,status:"approved"};return a.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id}}))}))}async function p(e){return o.A.downloadInvoice(e).then((t=>r()(t,"booking-invoice-".concat(e,".pdf"),"application/pdf")))}},90403:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>mt});var s=l(9950),n=l(81419),a=l(9083),i=l(82706),o=l(48538),d=l(74635),r=l(59051),c=l.n(r),u=l(95550),v=l(51066),m=l(44414);const p=()=>{var e;const t=(0,v.Q)(),{selectedSlots:l,isModalOpen:r,setIsModalOpen:p,setViewContent:h}=(0,s.useContext)(u.BookingContext),x=e=>{h(e),p(!1)};return(0,m.jsxs)(i.A,{title:"".concat(null===(e=c()(null===l||void 0===l?void 0:l.start))||void 0===e?void 0:e.format(t)),visible:r,onOk:()=>{p(!1)},onCancel:()=>{p(!1)},width:280,footer:null,className:"calendar-modal",children:[(0,m.jsx)(o.A,{type:"text",className:"w-100",icon:(0,m.jsx)(n.A,{}),onClick:()=>x("addService"),style:{borderRadius:0,textAlign:"left",fontSize:16},children:(0,d.t)("add.booking")}),(0,m.jsx)(o.A,{type:"text",className:"w-100",icon:(0,m.jsx)(a.A,{}),onClick:()=>x("blockTime"),style:{borderRadius:0,textAlign:"left",fontSize:16},children:(0,d.t)("add.blocked.time")})]})};l(66379);var h=l(91854),x=l(1753),j=l(23263),A=l(90650),g=l(44071),f=l(43957),y=l(28429),_=l(48676);const b=()=>{const e=(0,y.Zp)(),t=(0,h.wA)(),l=(0,g.ye)(c()),n=(0,v.Q)(),{bookingList:a,loading:i}=(0,h.d4)((e=>e.booking)),{disabledTimes:o}=(0,h.d4)((e=>e.disabledTimes)),{infoForm:d,setIsLoading:r,setViewContent:p,setIsModalOpen:x,setSelectedSlots:b,setCalculatedData:w,setServiceData:C}=(0,s.useContext)(u.BookingContext),k=(0,s.useCallback)((t=>{if(t.disabled)return p("updateBlockTime"),void e("?disabled_slot_id=".concat(t.id));p("updateForm"),r(!0),e("?service_id=".concat(t.id)),f.A.getBookingById(t.parent_id).then((e=>{var l,s,n,a,i,o,u,v,m,p,h,x,j,A,g,y,_,k,S,D,N,I,F,O,M,B,T,q,Y;let{data:V}=e;C(V),b({start:V[(null===V||void 0===V?void 0:V.length)-1].start_date,end:V[(null===V||void 0===V?void 0:V.length)-1].end_date}),((e,t)=>{f.A.calculate({user_id:e.user_id,payment_id:e.payment_id,data:t.map((e=>({data:e.data,note:e.note,service_master_id:e.service_master.id,start_date:c().utc(null===e||void 0===e?void 0:e.start_date).format("YYYY-MM-DD HH:mm")}))),ids:e.ids}).then((e=>{let{data:l}=e;const s=l.items.map(((e,l)=>({...e,...t[l],booking_id:t[l].id,status:t[l].status,type:t[l].type,notes:t[l].notes})));w({...l,items:s})})).catch((e=>{console.error(e)})).finally((()=>r(!1)))})({user_id:null===(l=V[0])||void 0===l?void 0:l.user_id,start:null===(s=V[0])||void 0===s?void 0:s.start_date,payment_id:null===(n=V[0])||void 0===n||null===(a=n.transaction)||void 0===a||null===(i=a.payment_system)||void 0===i?void 0:i.id,ids:V.map((e=>e.id))},V),d.setFieldsValue({id:t.parent_id,shop:{label:null===(o=V[0])||void 0===o||null===(u=o.shop)||void 0===u||null===(v=u.translation)||void 0===v?void 0:v.title,value:null===(m=V[0])||void 0===m||null===(p=m.shop)||void 0===p?void 0:p.id,key:null===(h=V[0])||void 0===h||null===(x=h.shop)||void 0===x?void 0:x.id},client:{label:"".concat(null===(j=V[0])||void 0===j||null===(A=j.user)||void 0===A?void 0:A.firstname," ").concat(null===(g=V[0])||void 0===g||null===(y=g.user)||void 0===y?void 0:y.lastname),value:null===(_=V[0])||void 0===_||null===(k=_.user)||void 0===k?void 0:k.id,key:null===(S=V[0])||void 0===S||null===(D=S.user)||void 0===D?void 0:D.id},payment_id:{label:(null===(N=V[0])||void 0===N||null===(I=N.transaction)||void 0===I||null===(F=I.payment_system)||void 0===F?void 0:F.tag)||"cash",value:null===(O=V[0])||void 0===O||null===(M=O.transaction)||void 0===M||null===(B=M.payment_system)||void 0===B?void 0:B.id,key:null===(T=V[0])||void 0===T||null===(q=T.transaction)||void 0===q||null===(Y=q.payment_system)||void 0===Y?void 0:Y.id}})})).catch((e=>{console.log(e)}))}),[]),{defaultDate:S,scrollToTime:D}=(0,s.useMemo)((()=>({defaultDate:new Date,scrollToTime:new Date})),[]);return(0,s.useEffect)((()=>{t((0,_.k1)({perPage:100}))}),[t]),(0,m.jsx)(j.A,{className:"h-100",children:(0,m.jsx)(A.A,{spinning:i,children:(0,m.jsx)(g.Vv,{localizer:l,startAccessor:"start",endAccessor:"end",defaultDate:S,events:[...a,...o],onSelectEvent:k,onSelectSlot:e=>{let{start:t,end:l}=e;x(!0),b({start:t,end:l})},selectable:!0,scrollToTime:D,timeslots:3,step:30,defaultView:"day",eventPropGetter:(e,t,l,s)=>e.disabled?{className:"disabled-slot"}:"",formats:{timeGutterFormat:n,eventTimeRangeFormat:e=>{let{start:t,end:l}=e;return"".concat(c()(t).format(n)," - ").concat(c()(l).format(n))}}})})})};var w=l(52695);const C=e=>{let{children:t,open:l,setOpen:n,footer:a}=e;const i=(0,y.Zp)(),{setCalculatedData:o}=(0,s.useContext)(u.BookingContext);return(0,m.jsx)(w.A,{onClose:()=>{n(""),i("/calendar"),o({})},visible:l,className:"drawer-view",width:600,headerStyle:{display:"none"},footer:a,destroyOnClose:!0,children:t})};var k=l(59233),S=l(55902),D=l(47992),N=l(8750),I=l(66362),F=l(87094),O=l(41988),M=l(99674),B=l(85217),T=l(40895),q=l(53774),Y=l(24513),V=l(54764);const L=e=>{var t,l,n,a,i,r,v,p,x,A,g,y,_,b,w,C,k,S,D,N;let{item:I}=e;const{setViewContent:F,serviceForm:O,service_id:M,setUpdateStatus:B,setSelectedMaster:L,setSelectedService:H}=(0,s.useContext)(u.BookingContext),{defaultCurrency:P}=(0,h.d4)((e=>e.currency),h.bN),E=e=>{M&&(F("updateService"),L(I),f.A.getById(e).then((t=>{var l,s,n,a,i,o,r,u,v,m,p,h,x,j,A,g,f,y,_;let{data:b}=t;var w,C;null!==b&&void 0!==b&&null!==(l=b.service_master)&&void 0!==l&&null!==(s=l.service)&&void 0!==s&&s.id&&(e=>{V.A.getById(e).then((e=>{H(e.data)})).catch((e=>{console.log(e)}))})(null===b||void 0===b||null===(w=b.service_master)||void 0===w||null===(C=w.service)||void 0===C?void 0:C.id);O.setFieldsValue({id:e,shop:{key:null===b||void 0===b||null===(n=b.shop)||void 0===n?void 0:n.id,value:null===b||void 0===b||null===(a=b.shop)||void 0===a?void 0:a.id,label:null===b||void 0===b||null===(i=b.shop)||void 0===i||null===(o=i.translation)||void 0===o?void 0:o.title},service:{key:null===b||void 0===b||null===(r=b.service_master)||void 0===r||null===(u=r.service)||void 0===u?void 0:u.id,value:null===b||void 0===b||null===(v=b.service_master)||void 0===v||null===(m=v.service)||void 0===m?void 0:m.id,label:null===b||void 0===b||null===(p=b.service_master)||void 0===p||null===(h=p.service)||void 0===h||null===(x=h.translation)||void 0===x?void 0:x.title},extras:null!==b&&void 0!==b&&null!==(j=b.extras)&&void 0!==j&&j.length?null===b||void 0===b||null===(A=b.extras)||void 0===A?void 0:A.map((e=>{var t;return{key:null===e||void 0===e?void 0:e.service_extra_id,value:null===e||void 0===e?void 0:e.service_extra_id,label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A")}})):[],master:{key:null===b||void 0===b||null===(g=b.master)||void 0===g?void 0:g.id,value:null===b||void 0===b||null===(f=b.master)||void 0===f?void 0:f.id,label:"".concat(null===b||void 0===b||null===(y=b.master)||void 0===y?void 0:y.firstname," ").concat(null===b||void 0===b||null===(_=b.master)||void 0===_?void 0:_.lastname)},end_date:c()(null===b||void 0===b?void 0:b.end_date).utc(),start_date:c()(null===b||void 0===b?void 0:b.start_date).utc(),note:null===b||void 0===b?void 0:b.note})})).catch((e=>{console.log(e)})))};return(0,m.jsx)(j.A,{className:"service-card ".concat(Boolean((null===(t=I.errors)||void 0===t?void 0:t.length)>0)&&!M&&"error"),children:(0,m.jsxs)("ul",{className:"mb-0",children:[(0,m.jsxs)("li",{className:"mb-3 flex justify-content-between gap-2",children:[(0,m.jsx)("strong",{className:"font-size-5",children:null===(l=I.service_master)||void 0===l||null===(n=l.service)||void 0===n||null===(a=n.translation)||void 0===a?void 0:a.title}),(0,m.jsx)(o.A,{icon:(0,m.jsx)(Y.A,{}),onClick:()=>E(I.booking_id),children:(0,d.t)("edit")})]}),(0,m.jsx)("li",{children:"".concat(c().parseZone(null===I||void 0===I?void 0:I.start_date).format("LT")," - ").concat(c().parseZone(I.end_date).format("LT")," (").concat(null===I||void 0===I||null===(i=I.service_master)||void 0===i?void 0:i.interval,"min + ").concat(null===I||void 0===I||null===(r=I.service_master)||void 0===r?void 0:r.pause,"min processing time)")}),(null===I||void 0===I?void 0:I.status)&&(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("status"),":"]}),(0,d.t)(null===I||void 0===I?void 0:I.status)," ",(0,m.jsx)(Y.A,{onClick:e=>(e=>{e.stopPropagation(),B({status:I.status,booking_id:I.booking_id})})(e),className:"edit-icon"})]}),(null===I||void 0===I?void 0:I.type)&&(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("type"),":"]}),(0,d.t)(null===I||void 0===I?void 0:I.type)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("shop"),":"]}),(0,d.t)(null===I||void 0===I||null===(v=I.shop)||void 0===v||null===(p=v.translation)||void 0===p?void 0:p.title)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("master.fullname"),":"]}),(0,d.t)(null===I||void 0===I||null===(x=I.master)||void 0===x?void 0:x.full_name)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("service.name"),":"]}),(0,d.t)(null===I||void 0===I||null===(A=I.service_master)||void 0===A||null===(g=A.service)||void 0===g||null===(y=g.translation)||void 0===y?void 0:y.title)]}),!(null===I||void 0===I||null===(_=I.extras)||void 0===_||!_.length)&&(null===I||void 0===I||null===(b=I.extras)||void 0===b?void 0:b.map((e=>{var t;return(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("extra"),":"]}),(0,d.t)(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)," -"," ",(0,q.default)(null===e||void 0===e?void 0:e.price,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]})}))),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("client"),":"]}),(0,d.t)(null===I||void 0===I||null===(w=I.user)||void 0===w?void 0:w.full_name)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("payment.type"),":"]}),(0,d.t)((null===I||void 0===I||null===(C=I.transaction)||void 0===C||null===(k=C.payment_system)||void 0===k?void 0:k.tag)||"cash")]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("transaction.status"),":"]}),(0,d.t)((null===I||void 0===I||null===(S=I.transaction)||void 0===S?void 0:S.status)||"progress")]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("commission.fee"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.commission_fee,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("discount"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.discount,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("gift.cart.price"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.gift_cart_price,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("service.fee"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.service_fee,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("service.master.price"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.service_master.price,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("span",{children:[(0,d.t)("extras.price"),":"]}),(0,q.default)(null!==(D=null===I||void 0===I?void 0:I.extra_price)&&void 0!==D?D:0,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]}),(0,m.jsx)(T.A,{}),(0,m.jsxs)("li",{className:"mt-2 d-flex gap-2",children:[(0,m.jsxs)("strong",{children:[(0,d.t)("total.price"),":"]}),(0,q.default)(null===I||void 0===I?void 0:I.total_price,null===P||void 0===P?void 0:P.symbol,null===P||void 0===P?void 0:P.position)]}),!M&&(0,m.jsx)("div",{className:"error-list",children:null===(N=I.errors)||void 0===N?void 0:N.map(((e,t)=>(0,m.jsx)("li",{children:e},t)))})]})})};var H=l(40577),P=l(70030),E=l(53271),R=l(85923);const U=e=>{var t,l;let{isOpen:n,handleCancel:a}=e;const{t:d}=(0,P.B)(),[r]=k.A.useForm(),{infoForm:c}=(0,s.useContext)(u.BookingContext),[v,p]=(0,s.useState)(null),[h,x]=(0,s.useState)(!1),j=()=>{r.resetFields(),p(null),a()};return(0,m.jsx)(i.A,{title:d("create.user"),visible:n,onCancel:j,footer:[(0,m.jsx)(o.A,{type:"primary",loading:h,onClick:()=>r.submit(),children:d("save")},"ok-button"),(0,m.jsx)(o.A,{onClick:j,children:d("cancel")},"cancel-button")],children:(0,m.jsx)(k.A,{layout:"vertical",name:"create-user-form",form:r,onFinish:e=>{x(!0);const t={...e,role:"user"};E.A.create(t).then((e=>{let{data:t}=e;const l={label:"".concat((null===t||void 0===t?void 0:t.firstname)||""," ").concat((null===t||void 0===t?void 0:t.lastname)||""),value:null===t||void 0===t?void 0:t.id,key:null===t||void 0===t?void 0:t.id,disabled:void 0};c.setFieldsValue({client:l}),R.oR.success(d("successfully.added")),j()})).catch((e=>p(e.response.data.params))).finally((()=>x(!1)))},children:(0,m.jsxs)(F.A,{gutter:12,children:[(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("firstname"),name:"firstname",help:null!==v&&void 0!==v&&v.firstname?null===(t=v.firstname)||void 0===t?void 0:t[0]:null,validateStatus:null!==v&&void 0!==v&&v.firstname?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,m.jsx)(S.A,{})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("lastname"),name:"lastname",help:null!==v&&void 0!==v&&v.lastname?null===v||void 0===v||null===(l=v.lastname)||void 0===l?void 0:l[0]:null,validateStatus:null!==v&&void 0!==v&&v.lastname?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,m.jsx)(S.A,{})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("phone"),name:"phone",help:null!==v&&void 0!==v&&v.phone?v.phone[0]:null,validateStatus:null!==v&&void 0!==v&&v.phone?"error":"success",rules:[{required:!0,message:d("required")}],children:(0,m.jsx)(H.A,{min:0,className:"w-100"})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:d("email"),name:"email",help:null!==v&&void 0!==v&&v.email?v.email[0]:null,validateStatus:null!==v&&void 0!==v&&v.email?"error":"success",rules:[{required:!0,message:d("required")},{type:"email",message:d("invalid.email")}],children:(0,m.jsx)(S.A,{type:"email"})})})]})})})},{Title:z}=I.A,G=e=>{var t;let{isDisabled:l,title:n="new.booking",isAdd:a=!1}=e;const{t:i}=(0,P.B)(),{calculatedData:d,setViewContent:r,setInfoData:c,infoForm:v,service_id:p}=(0,s.useContext)(u.BookingContext),[h,x]=(0,s.useState)(!1),[j,A]=(0,s.useState)(!1);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(F.A,{gutter:12,children:[(0,m.jsxs)(O.A,{span:24,className:"mb-4 d-flex justify-content-between align-items-center",children:[(0,m.jsx)(z,{level:2,children:i(n)}),!!p&&(0,m.jsx)(o.A,{htmlType:"button",onClick:async()=>{A(!0),await(0,B.It)(p).finally((()=>{A(!1)}))},loading:j,children:i("download.invoice")})]}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"shop",label:i("select.shop"),placeholder:i("select.shop"),rules:[{required:!0,message:i("required")}],children:(0,m.jsx)(D.G,{disabled:!a,className:"w-100",fetchOptions:B._u})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"client",label:i("select.client"),placeholder:i("select.client"),rules:[{required:!0,message:i("required")}],children:(0,m.jsx)(D.G,{fetchOptions:B.hU,style:{width:"100%"},refetchOptions:!0,disabled:!a})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"payment_id",rules:[{required:!0,message:i("required")}],label:i("payment"),children:(0,m.jsx)(M.A,{disabled:!a,placeholder:i("select.payment.type"),children:(0,m.jsx)(M.A.Option,{value:1,children:i("cash")})})})}),null===d||void 0===d||null===(t=d.items)||void 0===t?void 0:t.map((e=>(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(L,{item:e})},e.id))),a&&(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(o.A,{block:!0,type:"dashed",icon:(0,m.jsx)(N.A,{}),disabled:l,onClick:()=>{c(null===v||void 0===v?void 0:v.getFieldsValue()),r("serviceForm")},children:i("add.service")})})]}),(0,m.jsx)(U,{isOpen:h,handleCancel:()=>x(!1)})]})},W=()=>{const{infoForm:e,setCalculatedData:t,setIsUpdate:l,setOpenService:n,isLoalding:a,calculatedData:i}=(0,s.useContext)(u.BookingContext),o=k.A.useWatch("client",e),d=k.A.useWatch("payment_id",e);return(0,m.jsx)(A.A,{spinning:a,children:(0,m.jsxs)(k.A,{form:e,layout:"vertical",onFinish:s=>{const n={user_id:s.client.value,payment_id:s.payment_id.value,data:null===i||void 0===i?void 0:i.items.map((e=>{var t;return{note:e.note,data:e.data,service_master_id:null===(t=e.service_master)||void 0===t?void 0:t.id}})),start_date:null===i||void 0===i?void 0:i.start_date};f.A.update(s.id,n).then((()=>{l(!1),e.resetFields(),t({})})).catch((e=>{console.error(e)}))},children:[(0,m.jsx)(k.A.Item,{name:"id",className:"d-none",children:(0,m.jsx)(S.A,{})}),(0,m.jsx)(G,{title:"update.booking",setOpenService:n,isDisabled:!(o&&d)})]})})};var K=l(12916),Z=l(86971),Q=l(85023),J=l(35821),$=l(80415);const{Title:X}=I.A,ee=e=>{var t,l;let{shop:s,setViewContent:n,getServiceByID:a,getMasterByID:i,selectedService:o,form:r}=e;return(0,m.jsxs)(F.A,{gutter:12,children:[(0,m.jsxs)(O.A,{span:24,children:[(0,m.jsx)(K.A,{icon:(0,m.jsx)(J.A,{}),onClick:()=>{r.resetFields(),n("updateForm")}}),(0,m.jsx)(X,{className:"my-4",level:2,children:(0,d.t)("edit.service")})]}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"shop",label:(0,d.t)("select.shop"),placeholder:(0,d.t)("select.shop"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Q.D,{disabled:!0,className:"w-100",fetchOptions:B._u})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"service",label:(0,d.t)("select.service"),placeholder:(0,d.t)("select.service"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Q.D,{refetch:!0,disabled:!s,className:"w-100",onChange:e=>{a(e),r.setFieldsValue({extras:[]})},fetchOptions:()=>(0,B.Ox)({shop_id:s.value})})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"extras",label:(0,d.t)("select.service.extras"),children:(0,m.jsx)(M.A,{disabled:!(null!==o&&void 0!==o&&null!==(t=o.service_extras)&&void 0!==t&&t.length),options:null===o||void 0===o||null===(l=o.service_extras)||void 0===l?void 0:l.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A"),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}})),labelInValue:!0,placeholder:(0,d.t)("select.extra"),mode:"multiple"})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"master",label:(0,d.t)("select.master"),placeholder:(0,d.t)("select.master"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Q.D,{refetch:!0,className:"w-100",disabled:!o,onChange:e=>i(e),fetchOptions:()=>(0,B.dM)({shop_id:null===s||void 0===s?void 0:s.value,service_id:null===o||void 0===o?void 0:o.id})})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:(0,d.t)("start.date"),name:"start_date",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.A,{format:"YYYY-MM-DD ".concat($.xt),use12Hours:$.wO,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:(0,d.t)("end.date"),name:"end_date",rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.A,{format:"YYYY-MM-DD ".concat($.xt),use12Hours:$.wO,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"note",label:(0,d.t)("note"),rules:[{required:!1,message:(0,d.t)("required")}],children:(0,m.jsx)(S.A.TextArea,{})})})]})};var te=l(50686);const le=()=>{const e=(0,h.wA)(),{serviceForm:t,setCalculatedData:l,setViewContent:n,isLoalding:a,selectedService:i,setSelectedService:o,selectedMaster:d,setSelectedMaster:r}=(0,s.useContext)(u.BookingContext),v=k.A.useWatch("shop",t);return(0,m.jsx)(A.A,{spinning:a,children:(0,m.jsxs)(k.A,{form:t,layout:"vertical",onFinish:s=>{var a,i,o;const r={note:null===s||void 0===s?void 0:s.note,service_master_id:null===d||void 0===d||null===(a=d.service_master)||void 0===a?void 0:a.id,end_date:c()(s.end_date).format("YYYY-MM-DD HH:mm"),start_date:c()(s.start_date).format("YYYY-MM-DD HH:mm"),service_extras:null!==s&&void 0!==s&&null!==(i=s.extras)&&void 0!==i&&i.length?null===s||void 0===s||null===(o=s.extras)||void 0===o?void 0:o.map((e=>e.value)):void 0};f.A.update(s.id,r).then((()=>{n(""),t.resetFields(),l({}),e((0,x.ww)({}))})).catch((e=>{console.error(e)}))},children:[(0,m.jsx)(k.A.Item,{name:"id",className:"d-none",children:(0,m.jsx)(S.A,{})}),(0,m.jsx)(ee,{form:t,shop:v,setViewContent:n,getMasterByID:e=>{te.A.getById(e.value).then((e=>{let{data:t}=e;const l=null===t||void 0===t?void 0:t.service_masters.find((e=>e.service_id===i.id));r({...t,service_master:l})})).catch((e=>{console.log(e)}))},getServiceByID:e=>{V.A.getById(e.value).then((e=>{o(e.data)})).catch((e=>{console.log(e)}))},selectedService:i})]})})};var se=l(44070),ne=l(92759),ae=l(78003);const{useContext:ie,useState:oe}=l(9950),{BookingContext:de}=l(95550),{default:re}=l(53774),ce=()=>{const e=(0,h.wA)(),[t,l]=oe(),{calculatedData:s,sumInterval:n,service_id:a,setViewContent:i}=ie(de);return(0,m.jsxs)("div",{className:"w-100 d-flex between my-2",children:[(0,m.jsx)(ae.A,{title:(0,d.t)("delete.the.booking"),onConfirm:()=>{l(!0),f.A.delete({"ids[0]":a}).then((()=>{i(""),e((0,x.ww)()),ne.Ay.success((0,d.t)("booking.successfully.delete"))})).catch((e=>{console.log(e)})).finally((()=>l(!1)))},okText:(0,d.t)("yes"),cancelText:(0,d.t)("no"),children:(0,m.jsx)(o.A,{loading:t,type:"danger",icon:(0,m.jsx)(se.A,{})})}),(0,m.jsxs)("div",{className:"d-flex gap-2 my-2",children:[(0,m.jsxs)("strong",{className:"font-size-5",children:[(0,d.t)("total"),":"]}),(0,m.jsx)("strong",{className:"font-size-5 text-nowrap",children:"".concat(re(null===s||void 0===s?void 0:s.total_price)," (").concat(n,"min)")})]})]})},ue=()=>{const{infoForm:e,setCalculatedData:t,selectedSlots:l,calculatedData:n,setViewContent:a}=(0,s.useContext)(u.BookingContext),i=(0,h.wA)(),o=k.A.useWatch("client",e),d=k.A.useWatch("payment_id",e);return(0,m.jsx)(k.A,{form:e,layout:"vertical",onFinish:l=>{f.A.create({user_id:l.client.value,payment_id:l.payment_id.value,data:null===n||void 0===n?void 0:n.items.map((e=>{var t,l,s,n;return{note:null!==e&&void 0!==e&&null!==(t=e.note)&&void 0!==t&&t.length?null===e||void 0===e?void 0:e.note:void 0,data:e.data,service_master_id:null===e||void 0===e||null===(l=e.service_master)||void 0===l?void 0:l.id,service_extras:null!==e&&void 0!==e&&null!==(s=e.extras)&&void 0!==s&&s.length?null===e||void 0===e||null===(n=e.extras)||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.id)):void 0,start_date:e.start_date}}))}).then((()=>{a(""),t({}),e.resetFields(),i((0,x.ww)())})).catch((e=>{console.error(e)}))},children:(0,m.jsx)(G,{isAdd:!0,isDisabled:!(o&&d)})})},ve=()=>{const{calculatedData:e,infoForm:t,setCalculatedData:l,sumInterval:n,setViewContent:a}=(0,s.useContext)(u.BookingContext);return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"w-100 d-flex between my-2",children:[(0,m.jsx)("strong",{className:"font-size-5",children:"Total"}),(0,m.jsx)("strong",{className:"font-size-5",children:"".concat((0,q.default)(null===e||void 0===e?void 0:e.total_price)," (").concat(n||0,"min)")})]}),(0,m.jsxs)("div",{className:"w-100 d-flex gap-2",children:[(0,m.jsx)(o.A,{type:"primary",className:"w-100",onClick:t.submit,disabled:!(null!==e&&void 0!==e&&e.status),children:(0,d.t)("checkout")}),(0,m.jsx)(o.A,{type:"danger",className:"w-100",onClick:()=>{a(""),t.resetFields(),l({})},children:(0,d.t)("cancel")})]})]})};var me=l(63620),pe=l(8808),he=l(78498),xe=l(28257);const{Title:je}=I.A,Ae=e=>{var t,l,n;let{shop:a,setOpen:i,getServiceByID:r,getMasterByID:p,selectedService:h,form:x,location:j,setLocation:A,value:g,setValue:f,defaultLang:y,masterTimes:_}=e;const{calculatedData:b}=(0,s.useContext)(u.BookingContext),w=(0,v.Q)(),C=k.A.useWatch("start_date_date",x),D=k.A.useWatch("master",x),N=c()(new Date);return(0,m.jsxs)(F.A,{gutter:10,children:[(0,m.jsxs)(O.A,{span:24,children:[(0,m.jsx)(K.A,{icon:(0,m.jsx)(J.A,{}),onClick:()=>{i("addService"),x.resetFields()}}),(0,m.jsx)(je,{className:"my-4",level:2,children:(0,d.t)("select.service")})]}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"service",label:(0,d.t)("select.service"),placeholder:(0,d.t)("select.service"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Q.D,{refetch:!0,disabled:!a,className:"w-100",onChange:e=>{r(e),x.setFieldsValue({extras:[]})},fetchOptions:()=>(0,B.Ox)({shop_id:a.value},null===b||void 0===b?void 0:b.items)})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"extras",label:(0,d.t)("select.service.extras"),children:(0,m.jsx)(M.A,{disabled:!(null!==h&&void 0!==h&&null!==(t=h.service_extras)&&void 0!==t&&t.length),options:null===h||void 0===h||null===(l=h.service_extras)||void 0===l?void 0:l.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||(0,d.t)("N/A"),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}})),labelInValue:!0,placeholder:(0,d.t)("select.extra"),mode:"multiple"})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"master",label:(0,d.t)("select.master"),placeholder:(0,d.t)("select.master"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Q.D,{refetch:!0,className:"w-100",disabled:!h,onChange:e=>{p(e),x.setFieldsValue({start_date_date:void 0,start_date_time:void 0})},fetchOptions:()=>(0,B.dM)({shop_id:null===a||void 0===a?void 0:a.value,service_id:null===h||void 0===h?void 0:h.id})})})}),(0,m.jsx)(O.A,{span:16,children:(0,m.jsx)(k.A.Item,{name:"start_date_date",label:(0,d.t)("start.date"),placeholder:(0,d.t)("select.start.date"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(Z.A,{disabled:!_||!D,disabledDate:e=>new Date(e)<=c()().subtract(1,"days"),onChange:()=>{x.setFieldsValue({start_date_time:void 0})},className:"w-100"})})}),(0,m.jsx)(O.A,{span:8,children:(0,m.jsx)(k.A.Item,{name:"start_date_time",label:(0,d.t)("start.time"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsx)(M.A,{placeholder:(0,d.t)("select.start.time"),disabled:!C,options:null===(n=(()=>{const e=_[null===C||void 0===C?void 0:C.format("YYYY-MM-DD")]||[];return N.format("YYYY-MM-DD")===(null===C||void 0===C?void 0:C.format("YYYY-MM-DD"))?e.filter((e=>c()(e,"HH:mm").isAfter(c()(new Date)))):e})())||void 0===n?void 0:n.map((e=>({label:c()(e,"HH:mm").format(w),value:e})))})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"note",label:(0,d.t)("note"),rules:[{required:!1,message:(0,d.t)("required")}],children:(0,m.jsx)(S.A.TextArea,{})})}),Boolean("offline_out"===(null===h||void 0===h?void 0:h.type))&&(0,m.jsxs)(O.A,{span:24,children:[(0,m.jsx)(xe.A,{value:g,setValue:f,setLocation:A}),(0,m.jsx)(he.A,{location:j,setLocation:A,setAddress:e=>{x.setFieldsValue({["address[".concat(y,"]")]:e})}})]}),(0,m.jsx)(O.A,{span:24,className:"mt-4",children:(0,m.jsx)(o.A,{type:"primary",htmlType:"submit",className:"w-100",children:(0,d.t)("submit")})})]})},ge=()=>{const e=(0,h.wA)(),[t]=k.A.useForm(),{infoData:l,selectedSlots:n,setViewContent:a,calculatedData:i,setCalculatedData:o}=(0,s.useContext)(u.BookingContext),{defaultLang:d}=(0,h.d4)((e=>e.formLang)),{bookingList:r}=(0,h.d4)((e=>e.booking)),[v,p]=(0,s.useState)(null),[j,A]=(0,s.useState)(null),[g,y]=(0,s.useState)(me.Jb),[_,b]=(0,s.useState)([]),[w,C]=(0,s.useState)(""),S=null===l||void 0===l?void 0:l.shop;return(0,m.jsx)(k.A,{layout:"vertical",form:t,onFinish:s=>{var c,u,m;let p=[];null!==i&&void 0!==i&&i.items&&(p=null===i||void 0===i||null===(c=i.items)||void 0===c?void 0:c.map((e=>{var t,l;return{...e,service_extras:null!==e&&void 0!==e&&null!==(t=e.extras)&&void 0!==t&&t.length?null===e||void 0===e||null===(l=e.extras)||void 0===l?void 0:l.map((e=>null===e||void 0===e?void 0:e.id)):void 0}})));const h={note:s.note,data:{address:s["address[".concat(d,"]")],...g},service_master:null===j||void 0===j?void 0:j.service_master,service_extras:null!==s&&void 0!==s&&null!==(u=s.extras)&&void 0!==u&&u.length?null===s||void 0===s||null===(m=s.extras)||void 0===m?void 0:m.map((e=>null===e||void 0===e?void 0:e.value)):void 0,start_date:"".concat(s.start_date_date.format("YYYY-MM-DD")," ").concat(s.start_date_time)};var A;(A=[...p,h],f.A.calculate({user_id:l.client.value,payment_id:l.payment_id.value,data:A.map((e=>{var t;return{note:e.note,data:e.data,service_master_id:null===(t=e.service_master)||void 0===t?void 0:t.id,service_extras:null===e||void 0===e?void 0:e.service_extras,start_date:e.start_date}}))})).then((l=>{let{data:s}=l;t.resetFields(),(()=>{let t=(0,pe.O)(n.start,null===v||void 0===v?void 0:v.interval);var l,s;r.length>0?(t=(0,pe.O)(null===r||void 0===r||null===(l=r[r.length-1])||void 0===l?void 0:l.end,null===r||void 0===r||null===(s=r[r.length-1])||void 0===s?void 0:s.pause),e((0,x.lZ)({id:v.id,pause:v.pause,title:v.translation.title,start:t,end:(0,pe.O)(t,null===v||void 0===v?void 0:v.interval)}))):e((0,x.lZ)({id:v.id,pause:v.pause,title:v.translation.title,start:new Date(n.start),end:t}))})(),o(s),a("addService")})).catch((e=>{console.log(e)}))},children:(0,m.jsx)(Ae,{shop:S,form:t,setOpen:a,location:g,setLocation:y,getMasterByID:e=>{te.A.getById(e.value).then((e=>{let{data:t}=e;const l=null===t||void 0===t?void 0:t.service_masters.find((e=>e.service_id===v.id));A({...t,service_master:l}),te.A.getTimes({service_master_ids:[null===l||void 0===l?void 0:l.id],start_date:c()(null===n||void 0===n?void 0:n.start).format("YYYY-MM-DD HH:mm")}).then((e=>{var t;let{data:l}=e;b(Object.fromEntries(null===l||void 0===l||null===(t=l[0])||void 0===t?void 0:t.times.map((e=>[e.date,e.times]))))}))})).catch((e=>{console.log(e)}))},getServiceByID:e=>{V.A.getById(e.value).then((e=>{p(e.data)})).catch((e=>{console.log(e)}))},selectedService:v,value:w,setValue:C,defaultLang:d,masterTimes:_})})},{useContext:fe}=l(9950),{BookingContext:ye}=l(95550),{Button:_e}=l(30628),be=()=>{const{serviceForm:e}=fe(ye);return(0,m.jsx)("div",{className:"d-flex gap-2",children:(0,m.jsx)(_e,{type:"primary",className:"w-100",onClick:e.submit,children:(0,d.t)("apply")})})};var we=l(99985);const{Title:Ce}=I.A,ke=()=>{var e,t;const[l]=k.A.useForm(),[n,a]=(0,s.useState)(!1),{service_id:i,calculatedData:r,setCalculatedData:c}=(0,s.useContext)(u.BookingContext),v=null===r||void 0===r||null===(e=r.items)||void 0===e?void 0:e.find((e=>e.booking_id===Number(i)));return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(Ce,{level:2,children:(0,d.t)("notes")}),null===v||void 0===v||null===(t=v.notes)||void 0===t?void 0:t.map((e=>(0,m.jsx)(we.A,{message:e,className:"mb-2"}))),(0,m.jsxs)(k.A,{form:l,onFinish:e=>{a(!0),f.A.updateNote(i,e).then((e=>{let{data:t}=e;l.resetFields(),c((e=>{var l;return{...e,items:null===r||void 0===r||null===(l=r.items)||void 0===l?void 0:l.map((e=>e.booking_id===Number(i)?{...e,notes:t.notes}:e))}}))})).catch((e=>{console.log(e)})).finally((()=>a(!1)))},layout:"vertical",className:"mt-5",children:[(0,m.jsx)(k.A.Item,{name:"note",rules:[{required:!0}],label:"add.note",children:(0,m.jsx)(S.A.TextArea,{})}),(0,m.jsx)(o.A,{htmlType:"submit",type:"primary",loading:n,children:(0,d.t)("submit")})]})]})};var Se=l(95749),De=l(47738),Ne=l(19826),Ie=l(12534),Fe=l(69216);function Oe(e,t,l,s){return{key:t,icon:l,children:s,label:e}}const Me=()=>{const{setViewContent:e,service_id:t}=(0,s.useContext)(u.BookingContext),l=[Oe("Info",t?"updateForm":"addService",(0,m.jsx)(Se.A,{})),Oe("Forms","forms",(0,m.jsx)(De.A,{})),Oe("Activity","activity",(0,m.jsx)(Ne.A,{})),Oe("Notes","notes",(0,m.jsx)(Ie.A,{}))];return(0,m.jsx)("div",{className:"content-menu",children:(0,m.jsx)(Fe.A,{mode:"inline",items:l,defaultSelectedKeys:["info"],onClick:t=>(t=>{e(t.key)})(t)})})};var Be=l(90247);const{Title:Te,Text:qe}=I.A,Ye=()=>{var e,t;const{setIsAddForm:l,calculatedData:n,setFormDetailId:a}=(0,s.useContext)(u.BookingContext),i=null===n||void 0===n||null===(e=n.items)||void 0===e?void 0:e.flatMap((e=>e.data.form||[]));return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"d-flex between",children:[(0,m.jsx)(Te,{children:(0,d.t)("forms")}),(0,m.jsx)(o.A,{type:"text",size:"large",onClick:()=>l(!0),children:(0,d.t)("add.form")})]}),0===(null===i||void 0===i?void 0:i.length)&&(0,m.jsx)(j.A,{children:(0,m.jsx)(Be.A,{image:Be.A.PRESENTED_IMAGE_SIMPLE,description:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("strong",{children:"No client forms added yet."})," ",(0,m.jsx)("br",{})," Forms will appear here if required by any services in the appointment or if added manually."]})})}),null===n||void 0===n||null===(t=n.items)||void 0===t?void 0:t.map((e=>{var t;return e.data.form&&(0,m.jsx)("div",{children:null===(t=e.data.form)||void 0===t?void 0:t.map((e=>{var t;return(0,m.jsxs)(j.A,{children:[(0,m.jsx)(qe,{type:"secondary",children:c()().format("ddd Do MMM, h:mm a")}),(0,m.jsxs)(qe,{type:"success",className:"ml-2",children:["\u2022 ",(0,d.t)("complated")]}),(0,m.jsx)(Te,{level:4,className:"mt-2",children:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title}),(0,m.jsx)(o.A,{onClick:()=>a(e.id),children:(0,d.t)("view.form")})]},null===e||void 0===e?void 0:e.id)}))},e.id)}))]})};var Ve=l(98252);const{Title:Le}=I.A,He=()=>{var e,t;const{serviceData:l,service_id:n}=(0,s.useContext)(u.BookingContext),a=null===l||void 0===l?void 0:l.find((e=>e.id==n)),i=Boolean(!(null!==a&&void 0!==a&&null!==(e=a.activities)&&void 0!==e&&e.length));return(0,m.jsxs)("div",{className:"h-100",children:[(0,m.jsx)(Le,{children:(0,d.t)("activities")}),null===a||void 0===a||null===(t=a.activities)||void 0===t?void 0:t.map((e=>{var t;return(0,m.jsxs)(j.A,{className:"mb-2",children:[(0,m.jsx)(j.A.Meta,{avatar:(0,m.jsx)(Ve.A,{src:null===(t=e.user)||void 0===t?void 0:t.img,size:"large"}),title:e.user.firstname,description:c()(e.created_at).format("MMMM Do YYYY, h:mm a")}),(0,m.jsx)(j.A.Meta,{description:e.note,className:"mt-3"})]},e.id)})),i&&(0,m.jsx)(Be.A,{description:(0,d.t)("activities.not.found")})]})};var Pe=l(57796),Ee=l(52765);const Re=[{label:"M",value:"monday"},{label:"T",value:"tuesday"},{label:"W",value:"wednesday"},{label:"T",value:"thursday"},{label:"F",value:"friday"},{label:"S",value:"saturday"},{label:"S",value:"sunday"}],Ue=e=>{let{end:t}=e;return"date"===t?(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"end_value_date",children:(0,m.jsx)(Z.A,{className:"w-100"})})}):"after"===t?(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:(0,d.t)("occurrences"),name:"end_value",children:(0,m.jsx)(H.A,{className:"w-100"})})}):""},ze=e=>{let{type:t,form:l}=e;const s=k.A.useWatch("end_type",l),n=k.A.useWatch("every",l);return"dont_repeat"===t?"":"custom"===t?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"every",label:"every",children:(0,m.jsxs)(S.A.Group,{compact:!0,children:[(0,m.jsx)(k.A.Item,{name:["every","number"],noStyle:!0,children:(0,m.jsx)(H.A,{})}),(0,m.jsx)(k.A.Item,{name:["every","type"],noStyle:!0,children:(0,m.jsxs)(M.A,{children:[(0,m.jsx)(M.A.Option,{value:"day",children:(0,d.t)("day")}),(0,m.jsx)(M.A.Option,{value:"week",children:(0,d.t)("week")}),(0,m.jsx)(M.A.Option,{value:"month",children:(0,d.t)("month")})]})})]})})}),"week"===(null===n||void 0===n?void 0:n.type)&&(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"on_days",label:(0,d.t)("on.days"),children:(0,m.jsx)(Ee.A.Group,{options:Re})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"end_type",label:(0,d.t)("end"),placeholder:(0,d.t)("select.end"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsxs)(M.A,{style:{width:"100%"},children:[(0,m.jsx)(M.A.Option,{value:"never",children:(0,d.t)("never")}),(0,m.jsx)(M.A.Option,{value:"date",children:(0,d.t)("date")}),(0,m.jsx)(M.A.Option,{value:"after",children:(0,d.t)("after")})]})})}),(0,m.jsx)(Ue,{end:s})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"end_type",label:(0,d.t)("end"),placeholder:(0,d.t)("select.end"),rules:[{required:!0,message:(0,d.t)("required")}],children:(0,m.jsxs)(M.A,{style:{width:"100%"},children:[(0,m.jsx)(M.A.Option,{value:"never",children:(0,d.t)("never")}),(0,m.jsx)(M.A.Option,{value:"date",children:(0,d.t)("date")}),(0,m.jsx)(M.A.Option,{value:"after",children:(0,d.t)("after")})]})})}),(0,m.jsx)(Ue,{end:s})]})},{Title:Ge}=I.A,We=e=>{let{form:t}=e;const{t:l}=(0,P.B)(),s=k.A.useWatch("repeats",t),{languages:n,defaultLang:a}=(0,h.d4)((e=>e.formLang),h.bN),i=(0,h.d4)((e=>{var t,l;return null===(t=e.globalSettings)||void 0===t||null===(l=t.settings)||void 0===l?void 0:l.using_12_hour_format}),h.bN),o=(0,v.Q)();return(0,m.jsxs)(F.A,{gutter:[12,12],children:[(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(Ge,{className:"my-4",level:2,children:l("add.blocked.time")})}),(0,m.jsx)(O.A,{span:24,children:n.map((e=>(0,m.jsx)(k.A.Item,{label:l("title"),name:"title[".concat(e.locale,"]"),hidden:e.locale!==a,rules:[{required:e.locale===a,message:l("required")}],children:(0,m.jsx)(S.A,{})},"title"+e.locale)))}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{name:"master_id",label:l("select.master"),placeholder:l("select.master"),rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(D.G,{fetchOptions:e=>(0,B.dM)({search:e}),style:{width:"100%"}})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:l("date"),name:"date",rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(Z.A,{className:"w-100"})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:l("from"),name:"from",rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(Pe.A,{format:o,use12Hour:"1"===i,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:12,children:(0,m.jsx)(k.A.Item,{label:l("to"),name:"to",rules:[{required:!0,message:l("required")}],children:(0,m.jsx)(Pe.A,{format:o,use12Hour:"1"===i,className:"w-100",showTime:!0})})}),(0,m.jsx)(O.A,{span:24,children:(0,m.jsx)(k.A.Item,{name:"repeats",label:l("repeats"),placeholder:l("select.repeat"),rules:[{required:!0,message:l("required")}],children:(0,m.jsxs)(M.A,{style:{width:"100%"},children:[(0,m.jsx)(M.A.Option,{value:"dont_repeat",children:l("dont_repeat")}),(0,m.jsx)(M.A.Option,{value:"day",children:l("day")}),(0,m.jsx)(M.A.Option,{value:"week",children:l("week")}),(0,m.jsx)(M.A.Option,{value:"month",children:l("month")}),(0,m.jsx)(M.A.Option,{value:"custom",children:l("custom")})]})})}),(0,m.jsx)(ze,{type:s,form:t}),(0,m.jsx)(O.A,{span:24,style:{flexGrow:1},children:n.map((e=>(0,m.jsx)(k.A.Item,{label:l("description"),name:"description[".concat(e.locale,"]"),hidden:e.locale!==a,rules:[{required:e.locale===a,message:l("required")}],children:(0,m.jsx)(S.A.TextArea,{})},"description"+e.locale)))})]})};var Ke=l(9456);const Ze=()=>{const e=(0,h.wA)(),{defaultLang:t}=(0,h.d4)((e=>e.formLang)),{selectedSlots:l,setViewContent:n,blocktimeForm:a}=(0,s.useContext)(u.BookingContext);return(0,m.jsx)(k.A,{form:a,layout:"vertical",onFinish:l=>{var s,a,i,o;Ke.b.create({repeats:l.repeats,end_type:l.end_type,master_id:null===(s=l.master_id)||void 0===s?void 0:s.value,to:c()(l.to).format("HH:mm"),custom_repeat_type:null===(a=l.every)||void 0===a?void 0:a.type,from:c()(l.from).format("HH:mm"),date:c()(l.date).format("YYYY-MM-DD"),end_value:l.end_value||l.end_value_date,["title[".concat(t,"]")]:l["title[".concat(t,"]")],custom_repeat_value:l.on_days&&(null===(i=l.every)||void 0===i?void 0:i.number)&&[null===(o=l.every)||void 0===o?void 0:o.number,...l.on_days],["description[".concat(t,"]")]:l["description[".concat(t,"]")]}).then((()=>{n(""),e((0,_.k1)({perPage:100}))})).catch((e=>{console.log(e)}))},initialValues:{date:c()(),end_type:"never",repeats:"dont_repeat",from:c()(null===l||void 0===l?void 0:l.start,"HH:mm:ss"),to:c()(null===l||void 0===l?void 0:l.end,"HH:mm:ss"),every:{type:"day",number:1}},children:(0,m.jsx)(We,{form:a})})},Qe=()=>{const e=(0,h.wA)(),{blocktimeForm:t,disabled_slot_id:l,setViewContent:n}=(0,s.useContext)(u.BookingContext);return(0,m.jsxs)(F.A,{gutter:6,children:[Boolean(l)&&(0,m.jsx)(O.A,{span:2,children:(0,m.jsx)(ae.A,{title:"Delete the task",description:"Are you sure to delete this task?",onConfirm:()=>{Ke.b.delete({"ids[0]":l}).then((()=>{n(""),e((0,_.k1)({perPage:100}))})).catch((e=>{console.log(e)}))},okText:"Yes",cancelText:"No",children:(0,m.jsx)(o.A,{type:"danger",icon:(0,m.jsx)(se.A,{})})})}),(0,m.jsx)(O.A,{span:Boolean(l)?22:24,children:(0,m.jsx)(o.A,{type:"primary",className:"w-100",onClick:()=>t.submit(),children:(0,d.t)("submit")})})]})};var Je=l(84970),$e=l(31281);const Xe=()=>{const e=(0,h.wA)(),{languages:t}=(0,h.d4)((e=>e.formLang)),{setViewContent:l,disabled_slot_id:n,blocktimeForm:a}=(0,s.useContext)(u.BookingContext),[i,o]=(0,s.useState)(!1);function d(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,s=t.map((e=>{var t,s;return{["title[".concat(e.locale,"]")]:null===(t=l.find((t=>t.locale===e.locale)))||void 0===t?void 0:t.title,["description[".concat(e.locale,"]")]:null===(s=l.find((t=>t.locale===e.locale)))||void 0===s?void 0:s.description}}));return Object.assign({},...s)}return(0,s.useEffect)((()=>{n&&(o(!0),Je.A.getById(n).then((e=>{var t,l,s,n,i,o;let{data:r}=e;const u={master_id:{label:"".concat((null===r||void 0===r||null===(t=r.master)||void 0===t?void 0:t.firstname)||""," ").concat((null===r||void 0===r||null===(l=r.master)||void 0===l?void 0:l.lastname)||""),value:null===r||void 0===r||null===(s=r.master)||void 0===s?void 0:s.id,key:null===r||void 0===r||null===(n=r.master)||void 0===n?void 0:n.id},every:{type:r.custom_repeat_type,number:null===(i=r.custom_repeat_value)||void 0===i?void 0:i[0]},on_days:null===(o=r.custom_repeat_value)||void 0===o?void 0:o.filter(((e,t)=>0!==t)),repeats:r.repeats,end_type:r.end_type,end_value:r.end_value,date:c()(r.date,"YYYY-MM-DD"),end_value_date:"date"===r.end_type?c()(r.end_value.replace(/\"/g,""),"YYYY-MM-DD"):"",from:c()(null===r||void 0===r?void 0:r.from,"HH:mm:ss"),to:c()(null===r||void 0===r?void 0:r.to,"HH:mm:ss"),...d(r)};a.setFieldsValue(u)})).catch((e=>{console.log(e)})).finally((()=>o(!1))))}),[n]),(0,m.jsx)(A.A,{spinning:i,children:(0,m.jsx)(k.A,{form:a,layout:"vertical",onFinish:s=>{var a,i,o,d,r;Ke.b.update(n,{repeats:s.repeats,end_type:s.end_type,master_id:null===(a=s.master_id)||void 0===a?void 0:a.value,to:c()(s.to).format("HH:mm"),custom_repeat_type:null===(i=s.every)||void 0===i?void 0:i.type,from:c()(s.from).format("HH:mm"),date:c()(s.date).format("YYYY-MM-DD"),end_value:(null===(o=s.end_value)||void 0===o?void 0:o.toString())||s.end_value_date,title:(0,$e.A)(t,s),description:(0,$e.A)(t,s,"description"),custom_repeat_value:s.on_days&&(null===(d=s.every)||void 0===d?void 0:d.number)&&[null===(r=s.every)||void 0===r?void 0:r.number,...s.on_days]}).then((()=>{l(""),e((0,_.k1)({perPage:100}))})).catch((e=>{console.log(e)}))},children:(0,m.jsx)(We,{form:a})})})},et=()=>{const{viewContent:e,setViewContent:t}=(0,s.useContext)(u.BookingContext);return(0,m.jsx)(C,{open:e,setOpen:t,footer:(()=>{switch(e){case"addService":return(0,m.jsx)(ve,{});case"updateForm":return(0,m.jsx)(ce,{});case"updateService":return(0,m.jsx)(be,{});case"blockTime":case"updateBlockTime":return(0,m.jsx)(Qe,{});default:return""}})(),children:(0,m.jsxs)(m.Fragment,{children:["addService"!==e&&"serviceForm"!==e&&"blockTime"!==e&&"updateBlockTime"!==e&&(0,m.jsx)(Me,{}),(()=>{switch(e){case"addService":return(0,m.jsx)(ue,{});case"serviceForm":return(0,m.jsx)(ge,{});case"updateForm":default:return(0,m.jsx)(W,{});case"updateService":return(0,m.jsx)(le,{});case"notes":return(0,m.jsx)(ke,{});case"forms":return(0,m.jsx)(Ye,{});case"activity":return(0,m.jsx)(He,{});case"blockTime":return(0,m.jsx)(Ze,{});case"updateBlockTime":return(0,m.jsx)(Xe,{})}})()]})})};var tt=l(66136),lt=l(24893),st=l(25933);const{Title:nt}=I.A,at=e=>{var t,l,n;let{item:a}=e;const[i]=k.A.useForm(),{service_id:r,setIsAddForm:c,calculatedData:v,setCalculatedData:p}=(0,s.useContext)(u.BookingContext),h=e=>{var t,l,s;switch(e.answer_type){case"single_answer":return(0,m.jsx)(lt.Ay.Group,{children:null===(t=e.answer)||void 0===t?void 0:t.map((e=>(0,m.jsx)(lt.Ay,{value:e,children:e})))});case"short_answer":return(0,m.jsx)(S.A,{});case"long_answer":return(0,m.jsx)(S.A.TextArea,{});case"multiple_choice":return(0,m.jsx)(Ee.A.Group,{children:null===(l=e.answer)||void 0===l?void 0:l.map((e=>(0,m.jsx)(Ee.A,{value:e,children:e})))});case"drop_down":return(0,m.jsx)(M.A,{children:null===(s=e.answer)||void 0===s?void 0:s.map((e=>(0,m.jsx)(M.A.Option,{value:e,children:e})))});case"yes_or_no":return(0,m.jsx)(st.A,{});default:return""}},x=null===v||void 0===v||null===(t=v.items)||void 0===t?void 0:t.flatMap((e=>e.data.form||[]));return(0,m.jsxs)(j.A,{className:"w-100",children:[(0,m.jsx)(nt,{children:null===a||void 0===a||null===(l=a.translation)||void 0===l?void 0:l.title}),(0,m.jsxs)(k.A,{layout:"vertical",form:i,onFinish:e=>{var t,l;f.A.update(r,{data:{...null===v||void 0===v||null===(t=v.items[0])||void 0===t?void 0:t.data,form:[...x,{...a,data:null===(l=a.data)||void 0===l?void 0:l.map((t=>{const l=e[t.answer_type];return{...t,user_answer:l?"object"===typeof l?l:[l]:void 0}}))}]}}).then((e=>{i.resetFields(),c(!1),p((t=>({...t,items:t.items.map((t=>({...t,data:e.data.data})))})))})).catch((e=>{console.log(e)}))},children:[null===(n=a.data)||void 0===n?void 0:n.map((e=>(0,m.jsx)(m.Fragment,{children:"description_text"===e.answer_type?(0,m.jsx)(we.A,{message:e.question,type:"info"}):(0,m.jsx)(k.A.Item,{label:e.question,name:e.answer_type,rules:[{required:Boolean(e.required)}],children:h(e)})}))),(0,m.jsx)(o.A,{className:"mt-4",type:"primary",htmlType:"submit",children:(0,d.t)("complate")})]})]})},it=()=>{const{isAddForm:e,setIsAddForm:t}=(0,s.useContext)(u.BookingContext),[l,n]=(0,s.useState)([]),[a,o]=(0,s.useState)(null),r=l.map((e=>({key:e.id,label:e.translation.title}))),c=(0,s.useMemo)((()=>l.find((e=>e.id===a))),[a,l]);return(0,s.useEffect)((()=>{tt.A.getAll().then((e=>{let{data:t}=e;n(t),o(t[0].id)})).catch((e=>{console.log(e)}))}),[]),(0,m.jsx)(i.A,{centered:!0,width:912,footer:null,visible:e,onCancel:()=>{t(!1)},title:(0,d.t)("select.a.form"),children:(0,m.jsxs)("div",{className:"d-flex gap-2",children:[(0,m.jsx)(Fe.A,{style:{width:256},mode:"vertical",items:r,onClick:e=>{let{key:t}=e;return o(Number(t))}}),(0,m.jsx)(at,{item:c,formList:l})]})})};var ot=l(8297),dt=l(58547);const rt=()=>{const{t:e}=(0,P.B)(),t=(0,h.wA)(),[l,n]=(0,s.useState)({}),a=e=>{const t={search:null!==e&&void 0!==e&&e.length?e:void 0,page:1,perPage:20,role:"master",shop_id:(null===l||void 0===l?void 0:l.shop_id)||void 0};return te.A.getAll(t).then((e=>{let{data:t}=e;return null===t||void 0===t?void 0:t.map((e=>({label:"".concat(null===e||void 0===e?void 0:e.firstname," ").concat(null===e||void 0===e?void 0:e.lastname),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))},i=e=>{n((t=>({...t,...e})))};return(0,s.useEffect)((()=>{t((0,x.ww)(l)),t((0,_.k1)({perPage:100,...l}))}),[l]),(0,s.useEffect)((()=>{a()}),[]),(0,m.jsx)(j.A,{children:(0,m.jsxs)(F.A,{gutter:24,children:[(0,m.jsx)(O.A,{span:5,children:(0,m.jsx)(ot.A,{defaultValue:l.search,placeholder:e("search"),handleChange:e=>i({search:e})})}),(0,m.jsx)(O.A,{span:5,children:(0,m.jsx)(D.G,{className:"w-100",fetchOptions:a,placeholder:e("select.master"),refetchOptions:!0,onClear:()=>i({master_id:null}),onSelect:e=>i({master_id:null===e||void 0===e?void 0:e.value})})}),(0,m.jsx)(O.A,{span:5,children:(0,m.jsx)(D.G,{placeholder:e("select.shop"),fetchOptions:async function(e){const t={search:e,status:"approved"};return dt.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},style:{width:"100%"},onSelect:e=>i({shop_id:null===e||void 0===e?void 0:e.value}),onDeselect:()=>i({shop_id:null}),onClear:()=>i({shop_id:null}),allowClear:!0,value:null===l||void 0===l?void 0:l.shop_id})})]})})};var ct=l(91524);const ut=()=>{var e,t,l;const{formDetailId:n,setFormDetailId:a,calculatedData:o}=(0,s.useContext)(u.BookingContext),r=null===o||void 0===o||null===(e=o.items)||void 0===e?void 0:e.flatMap((e=>e.data.form||[])).find((e=>e.id===n));return(0,m.jsx)(i.A,{footer:null,visible:n,onCancel:()=>{a(null)},title:(0,d.t)("form.detail"),children:(0,m.jsx)(ct.A,{title:null===r||void 0===r||null===(t=r.translation)||void 0===t?void 0:t.title,layout:"vertical",children:null===r||void 0===r||null===(l=r.data)||void 0===l?void 0:l.map(((e,t)=>{var l,s;return"yes_or_no"===e.answer_type?(0,m.jsx)(ct.A.Item,{label:e.question,span:12,children:null===e||void 0===e||null===(l=e.user_answer)||void 0===l?void 0:l.map((e=>e?(0,d.t)("yes"):(0,d.t)("no")))},t):(0,m.jsx)(ct.A.Item,{label:e.question,span:12,children:null===e||void 0===e||null===(s=e.user_answer)||void 0===s?void 0:s.map((e=>(e.answer_type,(0,m.jsx)("div",{className:"ml-1",children:e}))))},t)}))})})},vt=()=>{const[e]=k.A.useForm(),{updateStatus:t,setUpdateStatus:l,setCalculatedData:n}=(0,s.useContext)(u.BookingContext),a=()=>{l(null),e.resetFields()};return(0,m.jsx)(i.A,{title:(0,d.t)("update.status"),visible:t,onCancel:a,width:280,footer:null,children:(0,m.jsxs)(k.A,{form:e,onFinish:e=>{f.A.changeStatus(t.booking_id,e).then((e=>{let{data:l}=e;a(),n((e=>({...e,items:e.items.map((e=>({...e,status:e.booking_id===t.booking_id?l.status:e.status})))})))})).catch((e=>{console.log(e)}))},layout:"vertical",initialValues:{status:null===t||void 0===t?void 0:t.status},children:[(0,m.jsx)(k.A.Item,{name:"status",rules:[{required:!0}],label:"status",children:(0,m.jsxs)(M.A,{children:[(0,m.jsx)(M.A.Option,{value:"new",children:(0,d.t)("new")}),(0,m.jsx)(M.A.Option,{value:"canceled",children:(0,d.t)("canceled")}),(0,m.jsx)(M.A.Option,{value:"booked",children:(0,d.t)("booked")}),(0,m.jsx)(M.A.Option,{value:"progress",children:(0,d.t)("progress")}),(0,m.jsx)(M.A.Option,{value:"ended",children:(0,d.t)("ended")})]})}),(0,m.jsx)(o.A,{htmlType:"submit",type:"primary",children:(0,d.t)("submit")})]})})},mt=()=>{const e=(0,h.wA)();return(0,s.useEffect)((()=>{e((0,x.ww)())}),[e]),(0,m.jsxs)(u.default,{children:[(0,m.jsx)(rt,{}),(0,m.jsx)(b,{}),(0,m.jsx)(p,{}),(0,m.jsx)(et,{}),(0,m.jsx)(it,{}),(0,m.jsx)(ut,{}),(0,m.jsx)(vt,{})]})}},95550:(e,t,l)=>{"use strict";l.r(t),l.d(t,{BookingContext:()=>o,default:()=>d});var s=l(59233),n=l(9950),a=l(42074),i=l(44414);const o=(0,n.createContext)(null),d=e=>{var t;let{children:l}=e,[d]=(0,a.ok)();const r=d.get("service_id"),c=d.get("disabled_slot_id"),[u]=s.A.useForm(),[v]=s.A.useForm(),[m]=s.A.useForm(),[p,h]=(0,n.useState)([]),[x,j]=(0,n.useState)({}),[A,g]=(0,n.useState)({}),[f,y]=(0,n.useState)(!1),[_,b]=(0,n.useState)(null),[w,C]=(0,n.useState)(!1),[k,S]=(0,n.useState)(""),[D,N]=(0,n.useState)(!1),[I,F]=(0,n.useState)(null),[O,M]=(0,n.useState)(null),[B,T]=(0,n.useState)(null),[q,Y]=(0,n.useState)(null),V=null===x||void 0===x||null===(t=x.items)||void 0===t?void 0:t.reduce(((e,t)=>{var l;return e+(null===t||void 0===t||null===(l=t.service_master)||void 0===l?void 0:l.interval)}),0);return(0,i.jsx)(o.Provider,{value:{infoForm:v,serviceForm:u,serviceData:p,setServiceData:h,calculatedData:x,setCalculatedData:j,selectedSlots:_,setSelectedSlots:b,isModalOpen:f,setIsModalOpen:y,isLoalding:w,setIsLoading:C,viewContent:k,setViewContent:S,sumInterval:V,infoData:A,setInfoData:g,service_id:r,isAddForm:D,setIsAddForm:N,disabled_slot_id:c,blocktimeForm:m,formDetailId:I,setFormDetailId:F,updateStatus:O,setUpdateStatus:M,selectedService:B,setSelectedService:T,selectedMaster:q,setSelectedMaster:Y},children:l})}},39362:function(e,t){var l,s,n;s=[],void 0===(n="function"===typeof(l=function(){return function e(t,l,s){var n,a,i=window,o="application/octet-stream",d=s||o,r=t,c=!l&&!s&&r,u=document.createElement("a"),v=function(e){return String(e)},m=i.Blob||i.MozBlob||i.WebKitBlob||v,p=l||"download";if(m=m.call?m.bind(i):Blob,"true"===String(this)&&(d=(r=[r,d])[0],r=r[1]),c&&c.length<2048&&(p=c.split("/").pop().split("?")[0],u.href=c,-1!==u.href.indexOf(c))){var h=new XMLHttpRequest;return h.open("GET",c,!0),h.responseType="blob",h.onload=function(t){e(t.target.response,p,o)},setTimeout((function(){h.send()}),0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(r)){if(!(r.length>2096103.424&&m!==v))return navigator.msSaveBlob?navigator.msSaveBlob(g(r),p):f(r);d=(r=g(r)).type||o}else if(/([\x80-\xff])/.test(r)){for(var x=0,j=new Uint8Array(r.length),A=j.length;x<A;++x)j[x]=r.charCodeAt(x);r=new m([j],{type:d})}function g(e){for(var t=e.split(/[:;,]/),l=t[1],s=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),n=s.length,a=0,i=new Uint8Array(n);a<n;++a)i[a]=s.charCodeAt(a);return new m([i],{type:l})}function f(e,t){if("download"in u)return u.href=e,u.setAttribute("download",p),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",document.body.appendChild(u),setTimeout((function(){u.click(),document.body.removeChild(u),!0===t&&setTimeout((function(){i.URL.revokeObjectURL(u.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,o)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var l=document.createElement("iframe");document.body.appendChild(l),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,o)),l.src=e,setTimeout((function(){document.body.removeChild(l)}),333)}if(n=r instanceof m?r:new m([r],{type:d}),navigator.msSaveBlob)return navigator.msSaveBlob(n,p);if(i.URL)f(i.URL.createObjectURL(n),!0);else{if("string"===typeof n||n.constructor===v)try{return f("data:"+d+";base64,"+i.btoa(n))}catch(y){return f("data:"+d+","+encodeURIComponent(n))}(a=new FileReader).onload=function(e){f(this.result)},a.readAsDataURL(n)}return!0}})?l.apply(t,s):l)||(e.exports=n)}}]);