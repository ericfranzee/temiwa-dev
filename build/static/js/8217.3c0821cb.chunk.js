"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[8217],{48217:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var l=n(54909),s=n(12916),i=n(80737),a=n(48538),o=n(23263),d=n(52913),r=n(70030),c=n(24513),u=n(12678),v=n(9950),h=n(91854),x=n(88986),p=n(49743),y=n(74623),m=n(59233),A=n(82706),j=n(87094),g=n(41988),k=n(99674),f=n(44414);const b=["new","progress","booked","ended","canceled"],w=e=>{let{data:t,handleSubmit:n,handleClose:l}=e;const{t:s}=(0,r.B)(),[o]=m.A.useForm(),[d,c]=(0,v.useState)(!1);return(0,f.jsx)(A.A,{visible:!!t,footer:(0,f.jsxs)(i.A,{children:[(0,f.jsx)(a.A,{onClick:l,children:s("cancel")}),(0,f.jsx)(a.A,{type:"primary",onClick:()=>o.submit(),loading:d,children:s("save")})]}),onCancel:l,children:(0,f.jsx)(m.A,{form:o,initialValues:{status:null===t||void 0===t?void 0:t.status},layout:"vertical",onFinish:e=>{c(!0);const s={status:null===e||void 0===e?void 0:e.status};n(null===t||void 0===t?void 0:t.id,s).then((()=>l())).finally((()=>c(!1)))},children:(0,f.jsx)(j.A,{gutter:12,children:(0,f.jsx)(g.A,{span:24,children:(0,f.jsx)(m.A.Item,{name:"status",label:s("status"),children:(0,f.jsx)(k.A,{children:b.map((e=>(0,f.jsx)(k.A.Option,{value:e,children:s(e)})))})})})})})})};var _=n(48139),C=n(8297),I=n(35116),S=n(76083),z=n(85923),B=n(55386),M=n(53774),Y=n(59051),F=n.n(Y),P=n(65820),D=n(22763);const E=()=>{var e;const{t:t}=(0,r.B)(),n=(0,P.s)(),l=null===(e=n.values)||void 0===e?void 0:e.bookingId,[s,i]=(0,v.useState)(null),[d,c]=(0,v.useState)(!1);if((0,v.useEffect)((()=>{if(l){(()=>{c(!0),_.A.getById(l).then((e=>i(null===e||void 0===e?void 0:e.data))).catch((e=>{console.error(e)})).finally((()=>c(!1)))})()}}),[l]),!l)return null;const u=()=>{n.clear(),i(null)};return(0,f.jsx)(A.A,{visible:!!l,onCancel:u,title:"".concat(t("booking.details")," #").concat(l),footer:(0,f.jsx)(a.A,{onClick:u,children:t("close")}),width:1e3,children:(0,f.jsx)(o.A,{loading:d,children:(0,f.jsx)(D.A,{data:s})})})};var N=n(51066);const{TabPane:O}=l.A,T=["all","offline_in","offline_out","online"];function V(){const{t:e}=(0,r.B)(),t=(0,h.wA)(),n=(0,P.s)(),{activeMenu:m}=(0,h.d4)((e=>e.menu),h.bN),{bookings:A,params:j,loading:g,meta:k}=(0,h.d4)((e=>e.bookings.seller),h.bN),{setIsModalVisible:b}=(0,v.useContext)(B.o),[Y,D]=(0,v.useState)(null),[V,Q]=(0,v.useState)(!1),[R,q]=(0,v.useState)({...j}),[G,H]=(0,v.useState)(null),J=(0,N.Q)(),K=[{title:e("id"),dataIndex:"id",key:"id",is_show:!0},{title:e("name.client"),dataIndex:"user",key:"name.client",is_show:!0,render:e=>"".concat((null===e||void 0===e?void 0:e.firstname)||""," ").concat((null===e||void 0===e?void 0:e.lastname)||"")},{title:e("contact"),dataIndex:"master",key:"contact",is_show:!0,render:t=>t.phone?(0,f.jsxs)("a",{href:"tel:+".concat(null===t||void 0===t?void 0:t.phone),children:[" +",null===t||void 0===t?void 0:t.phone]}):e("unknown")},{title:e("service"),dataIndex:"service_master",key:"service",is_show:!0,render:e=>{var t,n;return null===e||void 0===e||null===(t=e.service)||void 0===t||null===(n=t.translation)||void 0===n?void 0:n.title}},{title:e("start.date"),dataIndex:"start_date",key:"start_date",is_show:!0,render:e=>F().utc(e).format("YYYY-MM-DD ".concat(J))},{title:e("payment.type"),dataIndex:"transaction",key:"payment.type",is_show:!0,render:t=>{var n;return(0,f.jsx)(s.A,{children:e(null===t||void 0===t||null===(n=t.payment_system)||void 0===n?void 0:n.tag)})}},{title:e("master"),dataIndex:"master",key:"master",is_show:!0,render:e=>"".concat((null===e||void 0===e?void 0:e.firstname)||""," ").concat((null===e||void 0===e?void 0:e.lastname)||"")},{title:e("type"),dataIndex:"type",key:"type",is_show:!1},{title:e("status"),dataIndex:"status",key:"status",is_show:!0,render:(t,n)=>{const l=(t,l)=>(0,f.jsxs)("div",{children:[(0,f.jsx)(s.A,{color:t,children:e(l)}),"ended"!==l&&"canceled"!==l&&(0,f.jsx)(c.A,{onClick:e=>{e.stopPropagation(),H({status:l,id:null===n||void 0===n?void 0:n.id})}})]});switch(t){case"new":return l("blue",t);case"canceled":return l("red",t);case"booked":return l("yellow",t);case"progress":return l("rgba(23,128,184,0.56)",t);default:return l("cyan",t)}}},{title:e("price"),dataIndex:"price",key:"price",is_show:!0,render:(e,t)=>{var n,l;return(0,M.default)(e,null===t||void 0===t||null===(n=t.currency)||void 0===n?void 0:n.symbol,null===t||void 0===t||null===(l=t.currency)||void 0===l?void 0:l.position)}},{title:e("options"),key:"options",is_show:!0,render:e=>(0,f.jsxs)(i.A,{children:[(0,f.jsx)(a.A,{icon:(0,f.jsx)(u.A,{}),onClick:()=>{n.set("bookingId",null===e||void 0===e?void 0:e.id)}}),(0,f.jsx)(I.A,{onClick:()=>{b(!0),D([null===e||void 0===e?void 0:e.id])}})]})}];(0,v.useEffect)((()=>{m.refetch&&(0,h.vA)((()=>{t((0,p.y6)(R)),t((0,y.km)(m))}))}),[m.refetch]),(0,x.A)((()=>{t((0,p.y6)(R))}),[R]);const L=(e,t)=>{q((n=>{if("all"===t){const t={...n};return delete t[e],{...t,page:1}}return{...n,[e]:t,page:1}}))};return(0,f.jsxs)(v.Fragment,{children:[(0,f.jsx)(o.A,{children:(0,f.jsx)(i.A,{children:(0,f.jsx)(C.A,{handleChange:e=>{setTimeout((()=>{L("search",e)}),500)},placeholder:e("search")})})}),(0,f.jsxs)(o.A,{children:[(0,f.jsx)(l.A,{type:"card",onChange:e=>L("type",e),children:T.map((t=>(0,f.jsx)(O,{tab:e(t)},t)))}),(0,f.jsx)(d.A,{columns:null===K||void 0===K?void 0:K.filter((e=>null===e||void 0===e?void 0:e.is_show)),dataSource:A,loading:g,scroll:{x:!0},pagination:{pageSize:null===k||void 0===k?void 0:k.per_page,current:null===k||void 0===k?void 0:k.current_page,total:null===k||void 0===k?void 0:k.total},onChange:e=>{const{pageSize:t,current:n}=e,l={...R,perPage:t,page:n};q((e=>({...e,...l})))}})]}),G&&(0,f.jsx)(w,{data:G,handleClose:()=>H(null),handleSubmit:(e,n)=>_.A.changeStatus(e,n).then((()=>(0,h.vA)((()=>{t((0,p.y6)(R)),t((0,y.km)(m))}))))}),(0,f.jsx)(S.A,{click:()=>{Q(!0);const t={...Object.assign({},...Y.map(((e,t)=>({["ids[".concat(t,"]")]:e}))))};_.A.delete(t).then((()=>{z.oR.success(e("successfully.deleted")),D(null),b(!1),q((e=>({...e,page:1})))})).finally((()=>Q(!1)))},text:e("are.you.sure"),loading:V}),(0,f.jsx)(E,{})]})}}}]);