"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[7548],{85023:(e,l,t)=>{t.d(l,{D:()=>o});var i=t(9950),n=t(99674),d=t(90650),s=t(44414);const o=e=>{let{fetchOptions:l,refetch:t=!1,value:o,...r}=e;const[a,c]=(0,i.useState)(!1),[u,v]=(0,i.useState)([]);"object"===typeof(null===o||void 0===o?void 0:o.label)&&null!==(null===o||void 0===o?void 0:o.label)&&(o.label=o.label.value);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.A,{labelInValue:!0,filterOption:!1,notFoundContent:a?(0,s.jsx)(d.A,{size:"small"}):"no results",value:o,...r,options:a?[]:u,onFocus:()=>{u.length&&!t||(c(!0),l().then((e=>{v(e),c(!1)})))},getPopupContainer:e=>e.parentNode})})}},1201:(e,l,t)=>{t.d(l,{A:()=>a});t(9950);var i=t(70030),n=t(88542);const d=t.p+"static/media/noproductsfound.1cec73868b5fd048b865.riv",s=t.p+"static/media/noresult.ac4af107751f94856a9c.riv",o=t.p+"static/media/nosell.32cb2c2cc548a15c820d.riv";var r=t(44414);const a=function(e){let{id:l="noresult",text:t=""}=e;const{t:a}=(0,i.B)(),c={src:{noproductsfound:d,noresult:s,nosell:o}[l],artboard:"New Artboard",autoplay:!0},{RiveComponent:u}=(0,n.useRive)(c);return(0,r.jsxs)("div",{className:"animation-canvas",children:[(0,r.jsx)("div",{style:{width:"100%",height:200},children:(0,r.jsx)(u,{})}),(0,r.jsx)("div",{className:"text",children:a(t)})]})}},8297:(e,l,t)=>{t.d(l,{A:()=>r});var i=t(9950),n=t(55902),d=t(41397),s=t(60767),o=t(44414);function r(e){let{handleChange:l,defaultValue:t,resetSearch:r,...a}=e;const[c,u]=(0,i.useState)(t),v=(0,i.useMemo)((()=>(0,d.debounce)((e=>{l(e)}),800)),[]);return(0,i.useEffect)((()=>{u(t)}),[r]),(0,o.jsx)(n.A,{value:c,onChange:e=>{u(e.target.value),v(e.target.value)},prefix:(0,o.jsx)(s.A,{}),...a})}},47992:(e,l,t)=>{t.d(l,{G:()=>a});var i=t(9950),n=t(95491),d=t.n(n),s=t(99674),o=t(90650),r=t(44414);const a=e=>{let{fetchOptions:l,debounceTimeout:t=400,onClear:n,refetchOptions:a=!1,...c}=e;const[u,v]=(0,i.useState)(!1),[x,p]=(0,i.useState)([]),h=(0,i.useMemo)((()=>d()((e=>{p([]),v(!0),l(e).then((e=>{p(e),v(!1)}))}),t)),[l,t]);return(0,r.jsx)(s.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),n&&n()},notFoundContent:u?(0,r.jsx)(o.A,{size:"small"}):"no results",...c,options:x,onFocus:()=>{x.length&&!a||h("")}})}},22576:(e,l,t)=>{function i(e){for(var l=[],t=[],i="",n=0;n<(null===(d=e.stocks)||void 0===d?void 0:d.length);n++){var d;i="",e.stocks[n].extras.sort(((e,l)=>e.extra_group_id-l.extra_group_id));for(var s=0;s<(null===(o=e.stocks[n].extras)||void 0===o?void 0:o.length);s++){var o,r=Object.assign({},e.stocks[n].extras[s]),a=l.findIndex((e=>e.extra_value_id==r.extra_value_id));-1==a?(r.level=s,r.up=[i],l.push(r),i+=r.extra_value_id.toString()):(l[a].up.push(i),i+=r.extra_value_id.toString())}var c={id:e.stocks[n].id,extras:i,price:e.stocks[n].price,quantity:e.stocks[n].quantity,countable_id:e.stocks[n].countable_id,discount:e.stocks[n].discount,tax:e.stocks[n].tax,total_price:e.stocks[n].total_price,bonus:e.stocks[n].bonus};t.push(c)}return{stock:t,extras:l}}function n(e,l,t){for(var i=""==e?[]:e.split(","),n=[],d=[],s=0;s<=i.length;s++){s-1>=0&&(d[d.length]=i[s-1].toString());var o=l.filter((e=>{if(new Set(e.up).has(d.join("")))return e}));o.length>0&&n.push(o)}s=0;if(d.length<n.length)for(;s<l.length;){d[d.length]=n[n.length-1][0].extra_value_id.toString();let e=l.filter((e=>!!new Set(e.up).has(d.join(""))));if(0==e.length)break;n.push(e),s++}var r=t.findIndex((e=>e.extras==d.join("")));return{stock:t[r],extras:n}}t.d(l,{A:()=>n,w:()=>i})},49602:(e,l,t)=>{function i(e){var l;const t=null===e||void 0===e||null===(l=e.extras)||void 0===l?void 0:l.find((e=>"image"===e.group.type));return t?t.value:""}t.d(l,{A:()=>i})},53774:(e,l,t)=>{function i(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const t=Number(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===l?"".concat(t," ").concat(e):"".concat(e," ").concat(t)}t.r(l),t.d(l,{default:()=>i})},28249:(e,l,t)=>{function i(){var e;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;const i=(null===t||void 0===t||null===(e=t.translation)||void 0===e?void 0:e.title)||"pcs";if(!l)return 0;switch(null===t||void 0===t?void 0:t.position){case"after":default:return"".concat(l," ").concat(i);case"before":return"".concat(i," ").concat(l)}}t.d(l,{A:()=>i})},74827:(e,l,t)=>{t.d(l,{A:()=>n});var i=t(82371);const n={getAll:e=>i.A.get("rest/brands/paginate",{params:e}),getById:(e,l)=>i.A.get("rest/brands/".concat(e),{params:l})}},78457:(e,l,t)=>{t.d(l,{A:()=>n});var i=t(82371);const n={getAll:e=>i.A.get("dashboard/seller/categories/paginate",{params:e}),getById:(e,l)=>i.A.get("dashboard/seller/categories/".concat(e),{params:l}),search:e=>i.A.get("dashboard/seller/categories/search",{params:e}),paginateSelect:e=>i.A.get("dashboard/seller/categories/select-paginate",{params:e})}},53992:(e,l,t)=>{t.d(l,{A:()=>n});var i=t(82371);const n={checkCoupon:e=>i.A.post("rest/coupons/check",e),checkCashback:e=>i.A.post("rest/cashback/check",e)}},73107:(e,l,t)=>{t.r(l),t.d(l,{default:()=>ue});var i=t(9950),n=t(59233),d=t(48056),s=t(48538),o=t(87094),r=t(41988),a=t(90650),c=t(23263),u=t(99674),v=t(55902),x=t(41397),p=t(53271),h=t(47992),m=t(91854),j=t(51242),y=t(70030),f=t(53387),A=t(74623),g=t(28429),b=t(85023),_=t(34996),k=t(44414);const N=e=>{let{form:l}=e;const{t:t}=(0,y.B)(),d=(0,m.wA)(),a=(0,g.Zp)(),{currencies:N}=(0,m.d4)((e=>e.currency),m.bN),[w,C]=(0,i.useState)([]);return(0,k.jsx)(c.A,{title:t("customer.details"),children:(0,k.jsxs)(o.A,{gutter:12,children:[(0,k.jsx)(r.A,{span:16,children:(0,k.jsx)(n.A.Item,{label:t("client"),name:"user",rules:[{required:!0,message:""}],children:(0,k.jsx)(h.G,{placeholder:t("select.client"),fetchOptions:async function(e){const l={search:e,perPage:10,my_clients:1};return p.A.search(l).then((e=>{let{data:l}=e;return C(l),function(e){if(!e)return;return(0,x.isArray)(e)?e.map((e=>({label:"".concat(e.firstname," ").concat(e.lastname||""),value:e.id}))):{label:"".concat(e.firstname," ").concat(e.lastname||""),value:e.id}}(l)}))},onSelect:function(e){const t=w.find((l=>l.id===e.value));d((0,j.B_)({user:e,userUuid:t.uuid})),l.setFieldsValue({address:null})}})})}),(0,k.jsx)(r.A,{span:8,children:(0,k.jsx)(n.A.Item,{label:"add",className:"label-hidden",children:(0,k.jsx)(s.A,{icon:(0,k.jsx)(f.A,{}),onClick:()=>{d((0,A.X4)({url:"user/add",id:"user_add",name:"User add"})),a("/user/add")},children:t("add")})})}),(0,k.jsx)(r.A,{span:12,children:(0,k.jsx)(n.A.Item,{label:t("currency"),name:"currency_id",rules:[{required:!0,message:"missing_currency"}],children:(0,k.jsx)(u.A,{placeholder:t("select.currency"),onSelect:function(e){const l=N.find((l=>l.id===e));d((0,j._9)(l))},children:N.map(((e,l)=>(0,k.jsxs)(u.A.Option,{value:e.id,children:[e.title," (",null===e||void 0===e?void 0:e.symbol,")"]},l)))})})}),(0,k.jsx)(r.A,{span:12,children:(0,k.jsx)(n.A.Item,{label:t("payment.type"),name:"payment_type",rules:[{required:!0,message:t("missing.payment.type")}],children:(0,k.jsx)(b.D,{fetchOptions:async function(){return _.A.getAll({perPage:100}).then((e=>{let{data:l}=e;return l.filter((e=>"cash"===e.tag||"wallet"===e.tag)).map((e=>({label:e.tag||"no name",value:e.id})))}))},className:"w-100",placeholder:t("select.payment.type")})})}),(0,k.jsx)(r.A,{span:24,children:(0,k.jsx)(n.A.Item,{label:t("note"),name:"note",children:(0,k.jsx)(v.A,{})})})]})})};var w=t(80737),C=t(74827),S=t(78457),q=t(31526),I=t(69554),F=t(8750),M=t(94118),O=t(24513),B=t(91348),E=t(13239),Y=t(57056),D=t(82706),P=t(72243),V=t(91524),z=t(53774),G=t(85923),R=t(49602),T=t(22576),U=t(28249);function Z(e){var l,t,d,a,c;let{extrasModal:u,setExtrasModal:v}=e;const[x,p]=(0,i.useState)(u.stock),[h,y]=(0,i.useState)(u.quantity||u.min_qty),[f,A]=(0,i.useState)([]),[g,b]=(0,i.useState)([]),[_,N]=(0,i.useState)(null),[C,S]=(0,i.useState)([]),{currency:q}=(0,m.d4)((e=>e.order.data),m.bN),[M]=n.A.useForm(),O=(0,m.wA)();(0,i.useEffect)((()=>{null!==_&&void 0!==_&&_.stock&&p({..._.stock,extras:C})}),[_]),(0,i.useEffect)((()=>{var e;const l=(0,T.w)(u);A(l.extras),b(l.stock),N((0,T.A)("",l.extras,l.stock)),null===(e=(0,T.A)("",l.extras,l.stock).extras)||void 0===e||e.forEach((e=>{S((l=>[...l,e[0]]))}))}),[u]);const E=e=>{var l;const t=C.findIndex((l=>l.extra_group_id===e.extra_group_id));let i=C;t>-1&&(i=i.slice(0,t)),i.push(e);const n=i.map((e=>e.id)).join(",");var d=(0,T.A)(n,f,g);N(d),null===(l=d.extras)||void 0===l||l.forEach((l=>{const t=C.findIndex((t=>l[0].extra_group_id!=e.extra_group_id?t.extra_group_id===l[0].extra_group_id:t.extra_group_id===e.extra_group_id));if(l[0].level>=e.level){var n=l[0].extra_group_id!=e.extra_group_id?l[0]:e;-1==t?i.push(n):i[t]=n}})),S(i)},Y=()=>{v(!1)};return(0,k.jsx)(D.A,{visible:!!u,title:null===(l=u.translation)||void 0===l?void 0:l.title,onCancel:Y,footer:[(0,k.jsx)(s.A,{type:"primary",onClick:()=>M.submit(),children:"Add"}),(0,k.jsx)(s.A,{type:"default",onClick:Y,children:"Cancel"})],children:(0,k.jsxs)(n.A,{form:M,layout:"vertical",onFinish:e=>{const l={...u,stock:x,quantity:h,id:x.id,img:(0,R.A)(x)||u.img};l.quantity>x.quantity?G.oR.warning("You cannot order more than ".concat(x.quantity)):(O((0,j.re)(l)),v(null))},initialValues:{stock:null===(t=u.stock)||void 0===t?void 0:t.id},children:[(0,k.jsxs)(o.A,{gutter:24,children:[(0,k.jsx)(r.A,{span:8,children:(0,k.jsx)(P.A,{src:(0,I.A)((0,R.A)(x)||u.img),alt:null===(d=u.translation)||void 0===d?void 0:d.title,height:200,style:{objectFit:"contain"}})}),(0,k.jsx)(r.A,{span:16,children:(0,k.jsxs)(V.A,{title:null===(a=u.translation)||void 0===a?void 0:a.title,children:[(0,k.jsxs)(V.A.Item,{label:"Price",span:3,children:[(0,k.jsx)("div",{className:null!==x&&void 0!==x&&x.discount?"strike":"",children:(0,z.default)(null===x||void 0===x?void 0:x.price,q.symbol)}),null!==x&&void 0!==x&&x.discount?(0,k.jsx)("div",{className:"ml-2 font-weight-bold",children:(0,z.default)(null===x||void 0===x?void 0:x.total_price,q.symbol)}):""]}),(0,k.jsx)(V.A.Item,{label:"In stock",span:3,children:(0,U.A)(null===x||void 0===x?void 0:x.quantity,u.unit)}),(0,k.jsx)(V.A.Item,{label:"Tax",span:3,children:(0,z.default)(null===x||void 0===x?void 0:x.tax,q.symbol)})]})})]}),null===_||void 0===_||null===(c=_.extras)||void 0===c?void 0:c.map(((e,l)=>(0,k.jsx)("div",{className:"extra-group",children:(0,k.jsx)(w.A,{className:"extras-select",children:e.map((e=>"color"===e.group.type?(0,k.jsx)("span",{className:"extras-color-wrapper ".concat(C.find((l=>l.id===e.id))?"selected":""),onClick:()=>E(e),children:(0,k.jsx)("i",{className:"extras-color",style:{backgroundColor:e.value}})}):"text"===e.group.type?(0,k.jsx)("span",{className:"extras-text rounded ".concat(C.find((l=>l.id===e.id))?"selected":""),onClick:()=>E(e),children:e.value}):(0,k.jsx)("span",{className:"extras-image rounded ".concat(C.find((l=>l.id===e.id))?"selected":""),onClick:()=>E(e),children:(0,k.jsx)("img",{src:(0,I.A)(e.value),alt:"extra"})})))},"extra-group"+l)}))),(0,k.jsx)(o.A,{gutter:12,className:"mt-3",children:(0,k.jsx)(r.A,{span:24,children:(0,k.jsxs)(w.A,{children:[(0,k.jsx)(s.A,{type:"primary",icon:(0,k.jsx)(B.A,{}),onClick:function(){1!==h&&(h<=u.min_qty||y((e=>e-1)))}}),h,(0,k.jsx)(s.A,{type:"primary",icon:(0,k.jsx)(F.A,{}),onClick:function(){h!==(null===x||void 0===x?void 0:x.quantity)&&h!==u.max_qty&&y((e=>e+1))}})]})})})]})})}var W=t(88986),X=t(92979),H=t(53992),$=t(50384),K=t(21215),Q=t.n(K);function J(){var e,l,t,n,d,u,x,p,h,f,b,_,N,C;const{t:S}=(0,y.B)(),D=(0,m.wA)(),P=(0,g.Zp)(),{orderItems:V,data:G,total:R,coupon:T}=(0,m.d4)((e=>e.order),m.bN),[U,K]=(0,i.useState)(!1),[J,L]=(0,i.useState)(null),[ee,le]=(0,i.useState)(!1),[te,ie]=(0,i.useState)(""),{activeMenu:ne}=(0,m.d4)((e=>e.menu),m.bN);(0,W.A)((()=>{D((0,X.EN)({perPage:12,currency_id:G.currency.id,status:"published"}))}),[G.currency]),(0,W.A)((()=>{V.length?function(){const e=function(e){const l=e.map(((e,l)=>{var t;return{["products[".concat(l,"][stock_id]")]:(null===e||void 0===e||null===(t=e.stock)||void 0===t?void 0:t.id)||e.id,["products[".concat(l,"][quantity]")]:e.quantity}}));return Object.assign({},...l)}(V),l=Q().stringify({currency_id:G.currency.id,...e},{addQueryPrefix:!0});K(!0),Y.A.calculate(l).then((e=>{let{data:l}=e;const t={product_total:null===l||void 0===l?void 0:l.price,order_tax:null===l||void 0===l?void 0:l.total_tax,order_total:null===l||void 0===l?void 0:l.total_price,service_fee:null===l||void 0===l?void 0:l.service_fee,coupon_price:null===l||void 0===l?void 0:l.coupon_price,total_discount:null===l||void 0===l?void 0:l.total_discount};D((0,j.bX)(t))})).finally((()=>K(!1)))}():D((0,j.Ot)())}),[V,G.currency]);const de=e=>{D((0,A.X4)({id:"product-".concat(e.uuid),url:"seller/product/".concat(e.uuid),name:"Product edit"})),P("/seller/product/".concat(e.uuid))};const se=(e,l)=>{D((0,j.g7)({quantity:e,id:l}))};return(0,k.jsxs)("div",{className:"order-items",children:[U&&(0,k.jsx)("div",{className:"loader",children:(0,k.jsx)(a.A,{})}),(0,k.jsx)(o.A,{gutter:24,className:"mt-4",children:(0,k.jsx)(r.A,{span:24,children:(0,k.jsxs)(c.A,{className:"shop-card",children:[null===V||void 0===V?void 0:V.map(((e,l)=>{var t,i,n,d,o,r,a,u,v,x,p,h,m,y,f,A,g,b;return void 0===(null===e||void 0===e?void 0:e.bonus)||!1===(null===e||void 0===e?void 0:e.bonus)?(0,k.jsx)("div",{children:(0,k.jsxs)(c.A,{className:"position-relative",children:[(0,k.jsx)(M.A,{className:"close-order",onClick:()=>D((0,j.BZ)(e))}),(0,k.jsxs)(w.A,{className:"mr-3",children:[(0,k.jsx)("div",{className:"order-item-img",style:{marginRight:"20px"},children:(0,k.jsx)("img",{src:(0,I.A)((null===e||void 0===e||null===(t=e.stock)||void 0===t||null===(i=t.product)||void 0===i?void 0:i.img)||(null===e||void 0===e?void 0:e.img)),alt:null===e||void 0===e||null===(n=e.stock)||void 0===n||null===(d=n.product)||void 0===d||null===(o=d.translation)||void 0===o?void 0:o.title})}),(0,k.jsx)(q.A,{title:(0,k.jsxs)("div",{children:[(0,k.jsxs)(w.A,{children:[(0,k.jsx)("div",{className:"cursor-pointer white-space-wrap",onClick:()=>de(e),children:(null===e||void 0===e||null===(r=e.stock)||void 0===r||null===(a=r.product)||void 0===a||null===(u=a.translation)||void 0===u?void 0:u.title)||(null===e||void 0===e||null===(v=e.translation)||void 0===v?void 0:v.title)}),(0,k.jsx)(s.A,{icon:(0,k.jsx)(O.A,{}),type:"text",size:"small",onClick:()=>L(e)})]}),(0,k.jsx)("div",{className:"product-price",children:(0,z.default)((null===e||void 0===e?void 0:e.price)*(null===e||void 0===e?void 0:e.quantity),null===G||void 0===G||null===(x=G.currency)||void 0===x?void 0:x.symbol)})]}),description:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(w.A,{children:[(0,k.jsx)(s.A,{disabled:(null===e||void 0===e?void 0:e.quantity)<(null===e||void 0===e||null===(p=e.stock)||void 0===p||null===(h=p.product)||void 0===h?void 0:h.min_qty)+1||1===(null===e||void 0===e?void 0:e.quantity),onClick:()=>se(e.quantity-1,e.id),type:"primary",icon:(0,k.jsx)(B.A,{})})," ",(0,k.jsxs)("span",{children:[(null===e||void 0===e?void 0:e.quantity)*((null===e||void 0===e?void 0:e.interval)||1),null===e||void 0===e||null===(m=e.unit)||void 0===m||null===(y=m.translation)||void 0===y?void 0:y.title]}),(0,k.jsx)(s.A,{onClick:()=>se(e.quantity+1,e.id),type:"primary",disabled:(null===e||void 0===e?void 0:e.quantity)===(null===e||void 0===e?void 0:e.max_qty),icon:(0,k.jsx)(F.A,{})})]}),(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsx)(w.A,{wrap:!0,children:null===e||void 0===e||null===(f=e.addons)||void 0===f?void 0:f.map((e=>{var l,t,i,n;return(0,k.jsxs)("span",{className:"extras-text rounded",children:[(null===e||void 0===e||null===(l=e.stock)||void 0===l||null===(t=l.product)||void 0===t||null===(i=t.translation)||void 0===i?void 0:i.title)||(null===e||void 0===e||null===(n=e.product.translation)||void 0===n?void 0:n.title)," ","x ",null===e||void 0===e?void 0:e.quantity]},e.id)}))})})]})})]})]})}):(0,k.jsx)("div",{children:(0,k.jsx)("div",{children:(0,k.jsx)(c.A,{className:"position-relative",children:(0,k.jsxs)(w.A,{className:"mr-3 w-100 justify-content-between align-items-start",children:[(0,k.jsxs)(w.A,{children:[(0,k.jsx)("div",{className:"order-item-img",children:(0,k.jsx)("img",{src:(0,I.A)(null===e||void 0===e?void 0:e.img),alt:null===(A=e.translation)||void 0===A?void 0:A.title})}),(0,k.jsx)(q.A,{title:(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"cursor-pointer white-space-wrap",onClick:()=>de(e),children:null===(g=e.translation)||void 0===g?void 0:g.title}),(0,k.jsx)("div",{className:"product-price",children:(0,z.default)(e.price,null===(b=G.currency)||void 0===b?void 0:b.symbol)})]})})]}),(0,k.jsxs)("div",{className:"bonus",children:[(0,k.jsx)($.ob7,{})," Bonus"]})]})})})},l)})),(0,k.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,k.jsxs)(w.A,{children:[(0,k.jsx)("img",{src:(0,I.A)(null===(e=ne.data)||void 0===e||null===(l=e.shop)||void 0===l?void 0:l.logo_img),alt:"logo",width:40,height:40,className:"rounded-circle"}),(0,k.jsx)("div",{children:null===(t=ne.data)||void 0===t||null===(n=t.shop)||void 0===n||null===(d=n.translation)||void 0===d?void 0:d.title})]}),(0,k.jsxs)(w.A,{children:[(0,k.jsx)(v.A,{placeholder:S("coupon"),addonAfter:T.verified?(0,k.jsx)(E.A,{style:{color:"#18a695"}}):null,defaultValue:T.coupon,onBlur:e=>{var l,t;return D((0,j._v)({coupon:e.target.value,user_id:null===(l=G.user)||void 0===l?void 0:l.value,shop_id:null===(t=G.shop)||void 0===t?void 0:t.value,verified:!1}))},onChange:e=>ie(e.target.value)}),(0,k.jsx)(s.A,{onClick:()=>{te&&(le(!0),H.A.checkCoupon({coupon:te}).then((e=>{const l=e.data;(0,m.vA)((()=>{D((0,j.B_)({coupon:l})),D((0,j._T)({price:e.data.price,verified:!0}))}))})).catch((()=>D((0,j._T)({price:0,verified:!1})))).finally((()=>le(!1))))},loading:ee,disabled:!te.length,children:S("check.coupon")})]}),(0,k.jsxs)("div",{className:"mt-2 text-right shop-total",children:[(0,k.jsxs)(w.A,{children:[(0,k.jsxs)("p",{className:"font-weight-bold",children:[S("products"),":"]}),(0,k.jsx)("p",{children:(0,z.default)(R.product_total,null===(u=G.currency)||void 0===u?void 0:u.symbol)})]}),(0,k.jsx)("div",{}),(0,k.jsxs)(w.A,{children:[(0,k.jsxs)("p",{className:"font-weight-bold",children:[S("shop.tax"),":"]}),(0,k.jsx)("p",{children:(0,z.default)(R.shop_tax,null===(x=G.currency)||void 0===x?void 0:x.symbol)})]}),(0,k.jsx)("div",{}),(0,k.jsxs)(w.A,{children:[(0,k.jsxs)("p",{className:"font-weight-bold",children:[S("delivery.fee"),":"]}),(0,k.jsx)("p",{children:(0,z.default)(null===(p=R.delivery_fee)||void 0===p?void 0:p.reduce(((e,l)=>e+l),0),null===(h=G.currency)||void 0===h?void 0:h.symbol)})]}),(0,k.jsx)("div",{}),(0,k.jsxs)(w.A,{children:[(0,k.jsxs)("p",{className:"font-weight-bold",children:[S("discount"),":"]}),(0,k.jsxs)("p",{children:["-",(0,z.default)(R.discount,null===(f=G.currency)||void 0===f?void 0:f.symbol)]})]}),(0,k.jsx)("div",{}),(0,k.jsxs)(w.A,{children:[(0,k.jsxs)("p",{className:"font-weight-bold",children:[S("coupon"),":"]}),(0,k.jsxs)("p",{children:["-",(0,z.default)(null===(b=R.coupon)||void 0===b?void 0:b.reduce(((e,l)=>e+l),0),null===(_=G.currency)||void 0===_?void 0:_.symbol)]})]}),(0,k.jsx)("div",{}),(0,k.jsxs)(w.A,{children:[(0,k.jsxs)("p",{className:"font-weight-bold",children:[S("service.fee"),":"]}),(0,k.jsx)("p",{children:(0,z.default)(null===R||void 0===R?void 0:R.service_fee,null===(N=G.currency)||void 0===N?void 0:N.symbol)})]}),(0,k.jsx)("div",{}),(0,k.jsxs)(w.A,{children:[(0,k.jsxs)("p",{className:"font-weight-bold",children:[S("total"),":"]}),(0,k.jsx)("p",{children:(0,z.default)(R.order_total,null===(C=G.currency)||void 0===C?void 0:C.symbol)})]})]})]})]})})}),J&&(0,k.jsx)(Z,{extrasModal:J,setExtrasModal:L})]})}var L=t(8297),ee=t(1201);const le=e=>{let{form:l}=e;const[t,n]=(0,i.useState)(null),[d,s]=(0,i.useState)(null),[u,v]=(0,i.useState)(null),[x,p]=(0,i.useState)(null),j=(0,m.wA)(),{data:y}=(0,m.d4)((e=>e.order),m.bN),{products:f,loading:A}=(0,m.d4)((e=>e.product),m.bN);(0,W.A)((()=>{const e={perPage:10,page:1,brand_id:null===t||void 0===t?void 0:t.value,category_id:null===d||void 0===d?void 0:d.value,search:u};j((0,X.EN)(e))}),[t,d,u]);return(0,k.jsxs)(c.A,{title:"Order details",extra:(0,k.jsxs)(w.A,{children:[(0,k.jsx)(h.G,{placeholder:"Select category",fetchOptions:async function(e){const l={search:e};return S.A.search(l).then((e=>{let{data:l}=e;return l.map((e=>{var l;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id}}))}))},style:{minWidth:150},onChange:e=>s(e),value:d}),(0,k.jsx)(h.G,{placeholder:"Select brand",fetchOptions:async function(e){return C.A.search(e).then((e=>{let{data:l}=e;return l.map((e=>({label:null===e||void 0===e?void 0:e.title,value:null===e||void 0===e?void 0:e.id})))}))},style:{minWidth:150},onChange:e=>n(e),value:t})]}),children:[(0,k.jsx)("div",{className:"d-flex justify-content-end mb-4",children:(0,k.jsx)(L.A,{placeholder:"Search...",handleChange:v})}),(0,k.jsxs)("div",{className:"products-row order-items",children:[f.length?f.map((e=>{var l,t,i;return(0,k.jsxs)(c.A,{className:"products-col",cover:(0,k.jsx)("img",{alt:null===(l=e.translation)||void 0===l?void 0:l.title,src:(0,I.A)(e.img)}),onClick:()=>(e=>{y.currency?p(e):G.oR.warning("Please, select currency")})(e),children:[(0,k.jsx)(q.A,{title:null===(t=e.translation)||void 0===t?void 0:t.title,description:null===(i=e.stock)||void 0===i?void 0:i.price}),(0,k.jsx)("div",{className:"preview",children:(0,k.jsx)(F.A,{})})]},e.id)})):(0,k.jsx)(o.A,{children:(0,k.jsx)(r.A,{span:24,children:(0,k.jsx)(ee.A,{id:"nosell"})})}),A&&(0,k.jsx)("div",{className:"loader",children:(0,k.jsx)(a.A,{})})]}),x&&(0,k.jsx)(Z,{extrasModal:x,setExtrasModal:p}),(0,k.jsx)(J,{form:l})]})};var te=t(52913),ie=t(86245),ne=t(37279),de=t(59051),se=t.n(de);const oe=e=>{var l,t,n,d,o,r,u,v,x,p,h,m,j,f,A,g;let{orderId:b,handleClose:_}=e;const{t:N}=(0,y.B)(),[w,C]=(0,i.useState)(!1),[S,q]=(0,i.useState)(null),[I,F]=(0,i.useState)([]);return(0,i.useEffect)((()=>{b&&(C(!0),Y.A.getById(b).then((e=>{q(e.data),console.log("res.data",e);const l=e.data.details;F(l)})).finally((()=>C(!1))))}),[b]),(0,k.jsx)(D.A,{visible:!!b,title:"Order created successfully",onOk:_,onCancel:_,footer:[(0,k.jsx)(s.A,{onClick:_,children:N("back")}),(0,k.jsxs)(s.A,{type:"primary",onClick:()=>window.print(),children:[(0,k.jsx)(ne.A,{type:"printer"}),(0,k.jsx)("span",{className:"ml-1",children:N("print")})]})],style:{minWidth:"80vw"},children:(0,k.jsx)("div",{className:"py-4",children:w?(0,k.jsx)("div",{className:"w-100 text-center",children:(0,k.jsx)(a.A,{})}):(0,k.jsxs)(c.A,{children:[(0,k.jsxs)("div",{className:"d-flex justify-content-between mt-3",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h2",{className:"mb-1 font-weight-semibold",children:[N("invoice")," #",null===S||void 0===S?void 0:S.id]}),(0,k.jsx)("p",{children:se()(null===S||void 0===S?void 0:S.created_at).format("DD/M/YYYY")}),(0,k.jsx)("address",{children:(0,k.jsxs)("p",{children:[(0,k.jsxs)("span",{children:[N("delivery.type"),":"," ",null===S||void 0===S||null===(l=S.details[0])||void 0===l||null===(t=l.delivery_type)||void 0===t||null===(n=t.translation)||void 0===n?void 0:n.title]}),(0,k.jsx)("br",{}),(0,k.jsxs)("span",{children:[N("delivery.address"),":"," ",null===S||void 0===S||null===(d=S.details[0])||void 0===d||null===(o=d.delivery_address)||void 0===o?void 0:o.address]}),(0,k.jsx)("br",{}),(0,k.jsxs)("span",{children:[N("delivery.date"),": ",null===S||void 0===S||null===(r=S.details[0])||void 0===r?void 0:r.delivery_date," ",null===S||void 0===S||null===(u=S.details[0])||void 0===u?void 0:u.delivery_time]}),(0,k.jsx)("br",{}),(0,k.jsxs)("span",{children:[N("note"),": ",null===S||void 0===S?void 0:S.note]})]})})]}),(0,k.jsx)("address",{children:(0,k.jsxs)("p",{children:[(0,k.jsxs)("span",{className:"font-weight-semibold text-dark font-size-md",children:[null===S||void 0===S||null===(v=S.user)||void 0===v?void 0:v.firstname," ",null===S||void 0===S||null===(x=S.user)||void 0===x?void 0:x.lastname]}),(0,k.jsx)("br",{}),(0,k.jsxs)("span",{children:[N("phone"),": ",null===S||void 0===S||null===(p=S.user)||void 0===p?void 0:p.phone]}),(0,k.jsx)("br",{}),(0,k.jsxs)("span",{children:[N("email"),": ",null===S||void 0===S||null===(h=S.user)||void 0===h?void 0:h.email]})]})})]}),(0,k.jsxs)("div",{className:"mt-4",children:[(0,k.jsxs)(te.A,{scroll:{x:!0},dataSource:I,pagination:!1,className:"mb-5",children:[(0,k.jsx)(ie.A,{title:"No.",dataIndex:"id"},"id"),(0,k.jsx)(ie.A,{title:"Product",dataIndex:"product",render:(e,l)=>{var t,i,n;return null===l||void 0===l||null===(t=l.stock)||void 0===t||null===(i=t.product)||void 0===i||null===(n=i.translation)||void 0===n?void 0:n.title}},"product"),(0,k.jsx)(ie.A,{title:N("quantity"),dataIndex:"quantity",render:(e,l)=>{var t,i,n,d,s,o;return(0,k.jsxs)("span",{children:[l.quantity*((null===l||void 0===l||null===(t=l.stock)||void 0===t||null===(i=t.product)||void 0===i?void 0:i.interval)||1),null===l||void 0===l||null===(n=l.stock)||void 0===n||null===(d=n.product)||void 0===d||null===(s=d.unit)||void 0===s||null===(o=s.translation)||void 0===o?void 0:o.title]})}},"quantity"),(0,k.jsx)(ie.A,{title:N("discount"),dataIndex:"discount",render:e=>{var l;return(0,z.default)(e,null===S||void 0===S||null===(l=S.currency)||void 0===l?void 0:l.symbol)}},"discount"),(0,k.jsx)(ie.A,{title:N("price"),dataIndex:"total_price",render:e=>{var l;return(0,z.default)(e,null===S||void 0===S||null===(l=S.currency)||void 0===l?void 0:l.symbol)}},"total_price")]}),(0,k.jsx)("div",{className:"d-flex justify-content-end",children:(0,k.jsxs)("div",{className:"text-right ",children:[(0,k.jsxs)("div",{className:"border-bottom",children:[(0,k.jsxs)("p",{className:"mb-2",children:[(0,k.jsxs)("span",{children:[N("sub-total.amount"),": "]}),(0,z.default)(null===S||void 0===S?void 0:S.details.reduce(((e,l)=>e+l.total_price),0),null===S||void 0===S||null===(m=S.currency)||void 0===m?void 0:m.symbol)]}),(0,k.jsxs)("p",{children:[N("delivery.price"),":"," ",(0,z.default)(null===S||void 0===S?void 0:S.details.reduce(((e,l)=>e+l.delivery_fee),0),null===S||void 0===S||null===(j=S.currency)||void 0===j?void 0:j.symbol)]}),(0,k.jsxs)("p",{children:[N("tax"),":"," ",(0,z.default)(null===S||void 0===S?void 0:S.details.reduce(((e,l)=>e+l.tax),0),null===S||void 0===S||null===(f=S.currency)||void 0===f?void 0:f.symbol)]}),(0,k.jsxs)("p",{children:[N("coupon"),":"," ",(0,z.default)(null===S||void 0===S?void 0:S.details.reduce(((e,l)=>{var t;return e+(null===(t=l.coupon)||void 0===t?void 0:t.price)}),0),null===S||void 0===S||null===(A=S.currency)||void 0===A?void 0:A.symbol)]})]}),(0,k.jsxs)("h2",{className:"font-weight-semibold mt-3",children:[(0,k.jsxs)("span",{className:"mr-1",children:[N("grand.total"),": "]}),(0,z.default)(null===S||void 0===S?void 0:S.total_price,null===S||void 0===S||null===(g=S.currency)||void 0===g?void 0:g.symbol)]})]})})]})]})})})};var re=t(23758),ae=t(53177),ce=t(92270);function ue(){const{t:e}=(0,y.B)(),[l]=n.A.useForm(),t=(0,m.wA)(),{id:c}=(0,g.g)(),u=(0,g.Zp)(),[v,x]=(0,i.useState)(!1),[p,h]=(0,i.useState)(null),[f,b]=(0,i.useState)(!1),{orderItems:_,data:w,total:C,coupon:S}=(0,m.d4)((e=>e.order),m.bN),{currencies:q}=(0,m.d4)((e=>e.currency),m.bN),{activeMenu:I}=(0,m.d4)((e=>e.menu),m.bN);function F(e){return{label:"".concat((null===e||void 0===e?void 0:e.firstname)||""," ").concat(e.lastname||""),value:null===e||void 0===e?void 0:e.id}}function M(e){return e?{label:null===e||void 0===e?void 0:e.tag,value:e.id}:null}(0,i.useEffect)((()=>()=>{var e;const i=l.getFieldsValue(!0),n={...i,deliveries:null===i||void 0===i||null===(e=i.deliveries)||void 0===e?void 0:e.map((e=>({...e,delivery_date:null!==e&&void 0!==e&&e.delivery_date?se()(null===e||void 0===e?void 0:e.delivery_date).format("YYYY-MM-DD"):void 0})))};t((0,j.B_)(n))}),[]),(0,i.useEffect)((()=>{I.refetch&&(b(!0),re.A.getById(c).then((e=>{var i,n;const d=e.data;t((0,j._9)(d.currency));const s=null===(i=d.details)||void 0===i?void 0:i.map((e=>({...e.stock.product,...e.stock,quantity:e.quantity,stock:e.stock,img:(0,R.A)(e.stock)||e.stock.product.img,product:void 0})));var o;t((0,j.F1)(s)),l.setFieldsValue({user:F(d.user),currency_id:d.currency.id,address:(o=d.details[0].delivery_address,o?{label:null===o||void 0===o?void 0:o.address,value:null===o||void 0===o?void 0:o.id}:null),payment_type:M(null===d||void 0===d||null===(n=d.transaction)||void 0===n?void 0:n.payment_system),note:d.note})})).finally((()=>{b(!1),t((0,A.km)(I))})))}),[I.refetch]);const O=(e,l)=>{const i={payment_sys_id:l};x(!0),re.A.update(c,e).then((e=>function(e,l){ce.A.create(e,l).then((e=>{h(e.data.id),t((0,j.Uy)())})).finally((()=>x(!1)))}(e.data.id,i))).catch((()=>x(!1)))};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(d.A,{title:e("edit.order"),extra:(0,k.jsx)(s.A,{type:"primary",loading:v,onClick:()=>l.submit(),children:e("save")})}),(0,k.jsxs)(n.A,{name:"order-form",form:l,layout:"vertical",onFinish:e=>{var l,t,i;const n=function(e){const l=null===e||void 0===e?void 0:e.map((e=>{var l,t;return{quantity:e.quantity,stock_id:e.stockID?null===(l=e.stockID)||void 0===l?void 0:l.id:null===(t=e.stock)||void 0===t?void 0:t.id}})),t=null===e||void 0===e?void 0:e.flatMap((e=>{var l;return null===(l=e.addons)||void 0===l?void 0:l.map((l=>{var t,i;return{quantity:l.quantity,stock_id:l.stock_id,parent_id:e.stockID?null===(t=e.stockID)||void 0===t?void 0:t.id:null===(i=e.stock)||void 0===i?void 0:i.id}}))}));return l.concat(t)}(_),d={currency_id:e.currency_id,rate:null===(l=q.find((l=>l.id===e.currency_id)))||void 0===l?void 0:l.rate,delivery_fee:w.delivery_fee,coupon:S.coupon,tax:C.order_tax,payment_type:null===(t=e.payment_type)||void 0===t?void 0:t.label,note:e.note,delivery_date:se()(e.delivery_date).format("YYYY-MM-DD")+" "+se()(e.delivery_time).format("HH:mm"),user_id:e.user.value,products:null===n||void 0===n?void 0:n.filter((e=>!!e)),status:null===w||void 0===w?void 0:w.status};O(d,null===e||void 0===e||null===(i=e.payment_type)||void 0===i?void 0:i.value)},className:"order-add",initialValues:{user:w.user||null,address:w.address||null,currency_id:w.currency.id,payment_type:w.payment_type||null,note:w.note},children:[(0,k.jsxs)(o.A,{gutter:24,hidden:f,children:[(0,k.jsx)(r.A,{span:16,children:(0,k.jsx)(le,{form:l})}),(0,k.jsx)(r.A,{span:8,children:(0,k.jsx)(N,{form:l})})]}),f&&(0,k.jsx)("div",{className:"loader",children:(0,k.jsx)(a.A,{})})]}),p?(0,k.jsx)(oe,{orderId:p,handleClose:()=>{h(null);const e="orders";t((0,A.EK)({...I,nextUrl:e})),u("/".concat(e)),t((0,ae.Gb)())}}):""]})}}}]);