"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[2836],{47992:(e,t,s)=>{s.d(t,{G:()=>c});var r=s(9950),n=s(95491),i=s.n(n),a=s(99674),o=s(90650),l=s(44414);const c=e=>{let{fetchOptions:t,debounceTimeout:s=400,onClear:n,refetchOptions:c=!1,...d}=e;const[m,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)([]),v=(0,r.useMemo)((()=>i()((e=>{x([]),u(!0),t(e).then((e=>{x(e),u(!1)}))}),s)),[t,s]);return(0,l.jsx)(a.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:v,onClear:()=>{v(""),n&&n()},notFoundContent:m?(0,l.jsx)(o.A,{size:"small"}):"no results",...d,options:p,onFocus:()=>{p.length&&!c||v("")}})}},31281:(e,t,s)=>{function r(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const r=e.map((e=>({[e.locale]:""===t["".concat(s,"[").concat(e.locale,"]")]?void 0:t["".concat(s,"[").concat(e.locale,"]")]})));return Object.assign({},...r)}s.d(t,{A:()=>r})},66136:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(82371);const n={getAll:e=>r.A.get("rest/form-options",{params:e}),getById:e=>r.A.get("rest/form-options/".concat(e))}},63302:(e,t,s)=>{s.d(t,{A:()=>c,b:()=>a});var r=s(9950),n=s(83169),i=s(44414);const a=(0,r.createContext)({}),o={activeItemIndex:0,formItemsList:[{answer_type:"short_answer",question:"New question",required:!0}]},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.TH.addNewFormItem:return{activeItemIndex:e.formItemsList.length,formItemsList:[...e.formItemsList,t.payload]};case n.TH.updateFormItem:{const s=[...e.formItemsList];return s[e.activeItemIndex]=t.payload,{activeItemIndex:-1,formItemsList:s}}case n.TH.cancelFormItem:return{activeItemIndex:-1,formItemsList:e.formItemsList};case n.TH.startUpdatingFormItem:return{activeItemIndex:t.payload,formItemsList:e.formItemsList};case n.TH.deleteActiveFormItem:{const t=[...e.formItemsList];return t.splice(e.activeItemIndex,1),{activeItemIndex:-1,formItemsList:t}}case n.TH.setFormItemsState:return{activeItemIndex:-1,formItemsList:t.payload};case n.TH.moveUpQuestion:{const t=[...e.formItemsList],s=t[e.activeItemIndex];return t[e.activeItemIndex]=t[e.activeItemIndex-1],t[e.activeItemIndex-1]=s,{activeItemIndex:e.activeItemIndex-1,formItemsList:t}}case n.TH.moveDownQuestion:{const t=[...e.formItemsList],s=t[e.activeItemIndex];return t[e.activeItemIndex]=t[e.activeItemIndex+1],t[e.activeItemIndex+1]=s,{activeItemIndex:e.activeItemIndex+1,formItemsList:t}}case n.TH.copyFormItem:{const s=[...e.formItemsList];return s.splice(e.activeItemIndex+1,0,t.payload),{activeItemIndex:e.activeItemIndex+1,formItemsList:s}}default:return e}};const c=function(e){let{children:t}=e;const[s,n]=(0,r.useReducer)(l,o);return(0,i.jsx)(a.Provider,{value:{formOptionsState:s,formOptionsDispatch:n},children:t})}},42836:(e,t,s)=>{s.d(t,{A:()=>Z});var r=s(70030),n=s(91854),i=s(28429),a=s(9950),o=s(85923),l=s(74623),c=s(23263),d=s(59233),m=s(55902),u=s(87094),p=s(41988),x=s(25933),v=s(48538),h=s(80737),j=s(24893),I=s(90650),A=s(98591),f=s(53387),w=s(66136),y=s(47992),g=s(63302),b=s(83169),_=s(31281),N=s(47777),F=s(99674),q=s(40895),C=s(78840),k=s(94889),L=s(67376),T=s(44070),S=s(94118),O=s(13239),H=s(77484),U=s(8750),P=s(44414);function V(e){let{answer_type:t}=e;const{t:s}=(0,r.B)();return"single_answer"===t||"multiple_choice"===t||"drop_down"===t?(0,P.jsx)(d.A.List,{name:"answer",label:"Answers",rules:[{validator:async(e,t)=>{if(!t||t.length<2)return Promise.reject(new Error("add.at.least.2.option"))}}],children:(e,t,r)=>{let{add:n,remove:i}=t,{errors:a}=r;return(0,P.jsxs)(P.Fragment,{children:[e.map(((t,r)=>(0,P.jsx)(d.A.Item,{required:!1,className:"w-100",validateStatus:a.length&&"error",help:a[r],children:(0,P.jsxs)("div",{className:"d-flex",children:[(0,P.jsx)(d.A.Item,{label:"".concat(s("answer")," ").concat(r+1),...t,rules:[{required:!0,message:s("required")}],noStyle:!0,children:(0,P.jsx)(m.A,{className:"w-100"})}),(0,P.jsx)(v.A,{icon:(0,P.jsx)(H.A,{}),type:"danger",onClick:()=>i(t.name),className:"ml-2",disabled:e.length<=2})]})},t.key))),(0,P.jsx)(d.A.Item,{className:"w-100",children:(0,P.jsx)(v.A,{type:"link",onClick:()=>n(),icon:(0,P.jsx)(U.A,{}),children:s("add.field")})})]})}}):null}const B=function(e){let{data:t}=e;const{t:s}=(0,r.B)(),[n]=d.A.useForm(),{formOptionsState:i,formOptionsDispatch:o}=(0,a.useContext)(g.b),l={question:t.question,answer_type:t.answer_type,answer:t.answer,required:t.required};return(0,P.jsx)(c.A,{className:"border",style:{background:"rgba(0,0,0, 0.1)"},children:(0,P.jsx)(d.A,{form:n,initialValues:l,onFinish:e=>{o({type:b.TH.updateFormItem,payload:e})},layout:"vertical",children:(0,P.jsxs)(u.A,{gutter:10,children:[(0,P.jsx)(p.A,{span:10,children:(0,P.jsx)(d.A.Item,{name:"answer_type",label:"answer.type",rules:[{required:!0}],children:(0,P.jsx)(F.A,{onChange:e=>{"single_answer"!==e&&"multiple_choice"!==e&&"drop_down"!==e||n.getFieldValue("answer")||n.setFieldsValue({answer:["Answer 1","Answer 2"]})},children:b.pU.map((e=>(0,P.jsx)(F.A.Option,{value:e,children:s(e)},e)))})})}),(0,P.jsx)(p.A,{span:14,children:(0,P.jsx)(d.A.Item,{name:"question",label:"question",rules:[{required:!0}],children:(0,P.jsx)(m.A,{})})}),(0,P.jsx)(d.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.answer_type!==t.answer_type,children:e=>{let{getFieldValue:t}=e;return(0,P.jsx)(V,{answer_type:t("answer_type")})}}),(0,P.jsx)(q.A,{className:"mt-0"}),(0,P.jsxs)("div",{className:"flex justify-content-between items-center w-100",children:[(0,P.jsx)("div",{children:(0,P.jsx)(d.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.answer_type!==t.answer_type,children:e=>{let{getFieldValue:t}=e;return"description_text"!==t("answer_type")?(0,P.jsx)(d.A.Item,{name:"required",valuePropName:"required",label:s("required"),className:"mb-0",children:(0,P.jsx)(x.A,{defaultChecked:l.required})}):null}})}),(0,P.jsxs)(h.A,{children:[(0,P.jsx)(v.A,{onClick:()=>{o({type:b.TH.moveUpQuestion})},htmlType:"button",icon:(0,P.jsx)(C.A,{}),disabled:0===i.activeItemIndex}),(0,P.jsx)(v.A,{onClick:()=>{o({type:b.TH.moveDownQuestion})},htmlType:"button",icon:(0,P.jsx)(k.A,{}),disabled:i.activeItemIndex===i.formItemsList.length-1}),(0,P.jsx)("div",{role:"separator"}),(0,P.jsx)(v.A,{onClick:()=>{const e=Object.assign({},i.formItemsList[i.activeItemIndex]);e.question+=" copy",o({type:b.TH.copyFormItem,payload:e})},htmlType:"button",icon:(0,P.jsx)(L.A,{})}),(0,P.jsx)(v.A,{onClick:()=>{o({type:b.TH.deleteActiveFormItem})},htmlType:"button",icon:(0,P.jsx)(T.A,{}),type:"danger",disabled:1===i.formItemsList.length}),(0,P.jsx)("div",{role:"separator"}),(0,P.jsx)(v.A,{onClick:()=>{o({type:b.TH.cancelFormItem})},htmlType:"button",icon:(0,P.jsx)(S.A,{})}),(0,P.jsx)(v.A,{htmlType:"submit",icon:(0,P.jsx)(O.A,{}),type:"primary"})]})]})]})})})};var z=s(52765),D=s(99985);function E(e){let{data:t}=e;switch(t.answer_type){case"short_answer":return(0,P.jsx)(m.A,{});case"long_answer":return(0,P.jsx)(A.A,{rows:2});case"single_answer":return(0,P.jsx)(j.Ay.Group,{children:(0,P.jsx)(h.A,{direction:"vertical",children:t.answer.map((e=>(0,P.jsx)(j.Ay,{value:e,children:e})))})});case"multiple_choice":return(0,P.jsx)(h.A,{direction:"vertical",children:t.answer.map((e=>(0,P.jsx)(z.A,{children:e})))});case"drop_down":return(0,P.jsx)(F.A,{placeholder:"Please select",children:t.answer.map(((e,t)=>(0,P.jsx)(F.A.Option,{value:e+t,children:e})))});case"yes_or_no":return(0,P.jsxs)(j.Ay.Group,{children:[(0,P.jsx)(j.Ay.Button,{value:"yes",children:"Yes"}),(0,P.jsx)(j.Ay.Button,{value:"no",children:"No"})]});case"description_text":return(0,P.jsx)("div",{className:"mb-4",children:(0,P.jsx)(D.A,{message:t.question,type:"info",className:"mt-3"})});default:return(0,P.jsx)("p",{children:"Unknown type"})}}const Q=function(e){let{data:t,disabled:s,onClick:r}=e;return(0,P.jsx)(d.A,{layout:"vertical",onClick:r,children:"description_text"===t.answer_type?(0,P.jsx)(E,{data:t}):(0,P.jsx)(d.A.Item,{label:t.question,required:!(null===t||void 0===t||!t.required),style:{pointerEvents:s?"none":"auto"},children:(0,P.jsx)(E,{data:t})})})};const G=function(e){let{active:t,data:s,index:r}=e;const{formOptionsDispatch:n}=(0,a.useContext)(g.b);return t?(0,P.jsx)(B,{data:s}):(0,P.jsx)(Q,{data:s,disabled:!0,onClick:()=>{n({type:b.TH.startUpdatingFormItem,payload:r})}})};var R=s(82706);const X=function(e){let{visible:t,onCancel:s,onOk:n}=e;const{t:i}=(0,r.B)(),[o,l]=(0,a.useState)(b.pU[0]);return(0,P.jsx)(R.A,{title:i("select.answer.type"),visible:t,onCancel:s,onOk:()=>{s(),n(o)},children:(0,P.jsx)(u.A,{gutter:[16],children:b.pU.map((e=>(0,P.jsx)(p.A,{span:8,onClick:()=>l(e),children:(0,P.jsx)(c.A,{className:"border text-center bg-primary ".concat(o===e?"border-white":""),children:(0,P.jsxs)("div",{className:"flex flex-column cursor-pointer",children:[(0,b.wX)(e),(0,P.jsx)("span",{children:e})]})})},e)))})})};var M=s(47572);const Y=function(e){let{form:t}=e;const{defaultLang:s}=(0,n.d4)((e=>e.formLang),n.bN),{formOptionsState:r}=(0,a.useContext)(g.b),{current:i}=(0,a.useRef)(t.getFieldsValue()["title[".concat(s,"]")]),{current:o}=(0,a.useRef)(t.getFieldsValue()["description[".concat(s,"]")]);return(0,P.jsx)("div",{style:{maxWidth:600,margin:"0 auto"},children:(0,P.jsxs)("div",{className:"border rounded",children:[(0,P.jsxs)(c.A,{className:"mb-0",children:[(0,P.jsx)("h3",{children:i}),(0,P.jsx)("p",{children:o})]}),(0,P.jsx)("div",{className:"border-top",children:(0,P.jsx)(c.A,{className:"mb-0",children:r.formItemsList.map(((e,t)=>(0,P.jsx)(Q,{data:e,index:t},t)))})})]})})};var K=s(72124);function W(e){let{onSubmit:t,form:s,isCreating:h}=e;const{t:j}=(0,r.B)(),I=(0,n.wA)(),w=(0,i.Zp)(),{activeMenu:F}=(0,n.d4)((e=>e.menu),n.bN),{defaultLang:q,languages:C}=(0,n.d4)((e=>e.formLang),n.bN),{formOptionsState:k,formOptionsDispatch:L}=(0,a.useContext)(g.b),[T,S]=(0,a.useState)(!1),[O,H]=(0,a.useState)(!1);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{style:{maxWidth:600,margin:"0 auto"},children:[(0,P.jsxs)("div",{className:"border rounded",children:[(0,P.jsx)(c.A,{className:"mb-0",children:(0,P.jsxs)(d.A,{form:s,layout:"vertical",onFinish:e=>{var s;H(!0);const r={title:(0,_.A)(C,e,"title"),description:(0,_.A)(C,e,"description"),required:e.required?1:0,active:e.active?1:0,data:k.formItemsList.map((e=>({...e,required:e.required?1:0}))),service_master_id:null===(s=e.service)||void 0===s?void 0:s.value};t(r).then((()=>{const e="master/form-options";o.oR.success(j("successfully.added")),(0,n.vA)((()=>{I((0,l.EK)({...F,nextUrl:e})),I((0,N.Lm)({}))})),w("/".concat(e))})).finally((()=>H(!1)))},initialValues:{required:!0,active:!0},children:[C.map((e=>(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(d.A.Item,{label:j("title"),name:"title[".concat(e.locale,"]"),hidden:e.locale!==q,rules:[{validator:(t,s)=>s||(null===e||void 0===e?void 0:e.locale)!==q?s&&""===(null===s||void 0===s?void 0:s.trim())?Promise.reject(new Error(j("no.empty.space"))):s&&(null===s||void 0===s?void 0:s.trim().length)<5?Promise.reject(new Error(j("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(j("required")))}],children:(0,P.jsx)(m.A,{})},"title"+e.id),(0,P.jsx)(d.A.Item,{label:j("section.description"),name:"description[".concat(e.locale,"]"),rules:[{validator:(t,s)=>s||(null===e||void 0===e?void 0:e.locale)!==q?s&&""===(null===s||void 0===s?void 0:s.trim())?Promise.reject(new Error(j("no.empty.space"))):s&&(null===s||void 0===s?void 0:s.trim().length)<5?Promise.reject(new Error(j("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(j("required")))}],hidden:e.locale!==q,children:(0,P.jsx)(A.A,{})},"description"+e.locale)]}))),(0,P.jsxs)(u.A,{gutter:20,className:"mb-0",size:"middle",children:[(0,P.jsx)(p.A,{children:(0,P.jsx)(d.A.Item,{name:"service",label:j("service"),rules:[{required:!0,message:j("required")}],children:(0,P.jsx)(y.G,{allowClear:!0,fetchOptions:function(){const e={page:1,perPage:10,search:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim()};return K.A.get(e).then((e=>e.data.map((e=>{var t,s;return{label:null===e||void 0===e||null===(t=e.service)||void 0===t||null===(s=t.translation)||void 0===s?void 0:s.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))))},style:{width:"12rem"}})})}),(0,P.jsx)(p.A,{children:(0,P.jsx)(d.A.Item,{name:"required",label:j("required"),className:"mb-0",valuePropName:"checked",children:(0,P.jsx)(x.A,{defaultChecked:!!h||s.getFieldValue("required")})})}),(0,P.jsx)(p.A,{children:(0,P.jsx)(d.A.Item,{name:"active",label:j("active"),className:"mb-0",valuePropName:"checked",children:(0,P.jsx)(x.A,{defaultChecked:!!h||s.getFieldValue("active")})})})]})]})}),(0,P.jsx)("div",{className:"border-top",children:(0,P.jsx)(c.A,{className:"mb-0",children:k.formItemsList.map(((e,t)=>(0,P.jsx)(G,{active:t===k.activeItemIndex,data:e,index:t})))})}),(0,P.jsx)("div",{className:"border-top",children:(0,P.jsx)(c.A,{className:"mb-0",children:(0,P.jsx)(v.A,{icon:(0,P.jsx)(f.A,{}),type:"link",onClick:()=>S(!0),children:j("add.form.item")})})})]}),(0,P.jsx)(v.A,{loading:O,className:"mt-3 w-100",type:"primary",onClick:s.submit,children:j("submit")})]}),T&&(0,P.jsx)(X,{visible:T,onCancel:()=>S(!1),onOk:e=>{const t=(0,b.sD)(e);L({type:b.TH.addNewFormItem,payload:t})}})]})}const Z=function(e){const{t:t}=(0,r.B)(),[s,i]=(0,a.useState)("form"),[o,l]=(0,a.useState)(!1),{formOptionsDispatch:c}=(0,a.useContext)(g.b),{shop_id:d}=(0,n.d4)((e=>{var t,s;return null===(t=e.auth)||void 0===t||null===(s=t.user)||void 0===s?void 0:s.invite}),n.bN),{languages:m,defaultLang:u}=(0,n.d4)((e=>e.formLang),n.bN);function p(e){if(!e)return{};const{translations:t}=e,s=m.map((e=>{var s,r;return{["title[".concat(e.locale,"]")]:null===(s=t.find((t=>t.locale===e.locale)))||void 0===s?void 0:s.title,["description[".concat(e.locale,"]")]:null===(r=t.find((t=>t.locale===e.locale)))||void 0===r?void 0:r.description}}));return Object.assign({},...s)}return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:"flex justify-content-center mb-5",children:(0,P.jsxs)(h.A,{children:[(0,P.jsx)(y.G,{allowClear:!0,fetchOptions:function(){const e={page:1,perPage:10,master_form_options:1,search:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim(),shop_id:d};return M.A.getAll(e).then((e=>e.data.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))))},onSelect:t=>{return s=t.value,l(!0),void w.A.getById(s).then((t=>{var s,r;i("form"),e.form.setFieldsValue({...p(t.data),required:!(null===(s=t.data)||void 0===s||!s.required),active:!(null===(r=t.data)||void 0===r||!r.active)}),c({type:b.TH.setFormItemsState,payload:t.data.data})})).finally((()=>l(!1)));var s},placeholder:t("select.a.template"),style:{width:"12rem"}}),(0,P.jsxs)(j.Ay.Group,{value:s,onChange:e=>{i(e.target.value)},children:[(0,P.jsx)(j.Ay.Button,{value:"form",children:"Builder"}),(0,P.jsx)(j.Ay.Button,{value:"preview",children:"Preview"})]})]})}),o?(0,P.jsx)("div",{className:"flex justify-content-center",children:(0,P.jsx)(I.A,{})}):"form"===s?(0,P.jsx)(W,{...e}):(0,P.jsx)(Y,{form:e.form})]})}},83169:(e,t,s)=>{s.d(t,{TH:()=>d,pU:()=>c,sD:()=>m,wX:()=>u});var r=s(31222),n=s(8394),i=s(1199),a=s(50384),o=s(54826),l=s(44414);const c=["short_answer","long_answer","single_answer","multiple_choice","drop_down","yes_or_no","description_text"],d={addNewFormItem:"addNewFormItem",updateFormItem:"updateFormItem",cancelFormItem:"cancelFormItem",deleteActiveFormItem:"deleteActiveFormItem",startUpdatingFormItem:"startUpdatingFormItem",setFormItemsState:"setFormItemsState",moveUpQuestion:"moveUpQuestion",moveDownQuestion:"moveDownQuestion",copyFormItem:"copyFormItem"};function m(e){const t={answerType:e};switch(e){case"short_answer":case"long_answer":case"yes_or_no":return{answer_type:e,question:"New question",required:!0};case"single_answer":case"multiple_choice":case"drop_down":return{answer_type:e,question:"New question",answer:["New answer 1","New answer 2"],required:!0};case"description_text":return{answer_type:e,question:"New text description"}}return t}function u(e){switch(e){case"short_answer":return(0,l.jsx)(r.v2K,{size:24});case"long_answer":return(0,l.jsx)(n.xYT,{size:24});case"single_answer":return(0,l.jsx)(i.MYX,{size:24});case"multiple_choice":return(0,l.jsx)(a.CTR,{size:24});case"drop_down":return(0,l.jsx)(r.s4V,{size:24});case"yes_or_no":return(0,l.jsx)(a.TSp,{size:24});case"description_text":return(0,l.jsx)(o.gXU,{size:24});default:console.error("Unknown answerType")}}}}]);