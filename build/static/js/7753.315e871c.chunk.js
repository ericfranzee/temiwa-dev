"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[7753],{47992:(e,l,t)=>{t.d(l,{G:()=>o});var a=t(9950),n=t(95491),i=t.n(n),r=t(99674),s=t(90650),d=t(44414);const o=e=>{let{fetchOptions:l,debounceTimeout:t=400,onClear:n,refetchOptions:o=!1,...u}=e;const[c,m]=(0,a.useState)(!1),[p,h]=(0,a.useState)([]),v=(0,a.useMemo)((()=>i()((e=>{h([]),m(!0),l(e).then((e=>{h(e),m(!1)}))}),t)),[l,t]);return(0,d.jsx)(r.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:v,onClear:()=>{v(""),n&&n()},notFoundContent:c?(0,d.jsx)(s.A,{size:"small"}):"no results",...u,options:p,onFocus:()=>{p.length&&!o||v("")}})}},97753:(e,l,t)=>{t.r(l),t.d(l,{default:()=>f});var a=t(9950),n=t(59233),i=t(23263),r=t(71999),s=t(28429),d=t(36642),o=t(59051),u=t.n(o),c=t(91854),m=t(74623),p=t(70030),h=t(2894),v=t(74715),x=t(85923),A=t(44414);const f=()=>{const{t:e}=(0,p.B)(),[l]=n.A.useForm(),[t,o]=(0,a.useState)(!1),{languages:f}=(0,c.d4)((e=>e.formLang),c.bN),g=(0,c.wA)(),j=(0,s.Zp)(),{id:b}=(0,s.g)(),{activeMenu:y}=(0,c.d4)((e=>e.menu),c.bN);function q(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,t=f.map((e=>{var t;return{["title[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title}}));return Object.assign({},...t)}return(0,a.useEffect)((()=>{y.refetch&&function(e){o(!0),d.A.getById(e).then((e=>{var t,a,n,i;let{data:r}=e;const s={...r,shop_id:{label:null===r||void 0===r||null===(t=r.shop)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title,value:null===r||void 0===r||null===(n=r.shop)||void 0===n?void 0:n.id,key:null===r||void 0===r||null===(i=r.shop)||void 0===i?void 0:i.id},...q(r),expired_at:u()(r.expired_at,"YYYY-MM-DD")};l.setFieldsValue({...s}),g((0,m.Ok)({activeMenu:y,data:{...s,expired_at:JSON.stringify(null===s||void 0===s?void 0:s.expired_at)}}))})).finally((()=>{o(!1),g((0,m.km)(y))}))}(b)}),[y.refetch]),(0,A.jsx)(i.A,{title:e("edit.coupon"),extra:(0,A.jsx)(r.A,{}),loading:t,children:(0,A.jsx)(v.A,{form:l,handleSubmit:l=>{const t={...l,expired_at:u()(l.expired_at).format("YYYY-MM-DD"),qty:Number(l.qty),price:Number(l.price)},a="coupons";d.A.update(b,t).then((()=>{x.oR.success(e("toast.updated")),(0,c.vA)((()=>{g((0,m.EK)({...y,nextUrl:a})),g((0,h.F)({}))})),j("/".concat(a))}))}})})}},74715:(e,l,t)=>{t.d(l,{A:()=>g});var a=t(9950),n=t(59233),i=t(87094),r=t(41988),s=t(55902),d=t(99674),o=t(86971),u=t(40577),c=t(48538),m=t(59051),p=t.n(m),h=t(70030),v=t(91854),x=t(55660),A=t(47992),f=t(44414);function g(e){let{form:l,handleSubmit:t}=e;const{t:m}=(0,h.B)(),{defaultLang:g,languages:j}=(0,v.d4)((e=>e.formLang),v.bN),{activeMenu:b}=(0,v.d4)((e=>e.menu),v.bN),y=[{label:m("delivery.fee"),value:"delivery_fee",key:"delivery_fee"},{label:m("total.price"),value:"total_price",key:"total_price"},{label:m("bookin.total.price"),value:"booking_total_price",key:"booking_total_price"}],[q,_]=(0,a.useState)(!1);return(0,f.jsxs)(n.A,{form:l,name:"coupon-form",layout:"vertical",onFinish:e=>{var l;_(!0),t({...e,shop_id:null===e||void 0===e||null===(l=e.shop_id)||void 0===l?void 0:l.value}).finally((()=>_(!1)))},initialValues:{for:"delivery_fee",type:"fix",...null===b||void 0===b?void 0:b.data},children:[(0,f.jsxs)(i.A,{gutter:12,children:[(0,f.jsx)(r.A,{span:12,children:j.map((e=>(0,f.jsx)(n.A.Item,{label:m("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===g,message:m("required")}],hidden:e.locale!==g,children:(0,f.jsx)(s.A,{maxLength:20})},"title"+e.id)))}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:m("name"),name:"name",rules:[{required:!0,message:m("required")}],children:(0,f.jsx)(s.A,{maxLength:20})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:m("type"),name:"type",rules:[{required:!0,message:m("required")}],children:(0,f.jsxs)(d.A,{children:[(0,f.jsx)(d.A.Option,{value:"fix",children:m("fix")}),(0,f.jsx)(d.A.Option,{value:"percent",children:m("percent")})]})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{name:"expired_at",label:m("expired.at"),rules:[{required:!0,message:m("required")}],children:(0,f.jsx)(o.A,{className:"w-100",placeholder:"",disabledDate:e=>p()().add(-1,"days")>=e})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:m("quantity"),name:"qty",rules:[{required:!0,message:m("required")},{type:"number",max:9999999999,message:m("max.length.10")}],children:(0,f.jsx)(u.A,{min:0,className:"w-100"})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:m("price"),name:"price",rules:[{required:!0,message:m("required")},{type:"number",max:9999999999,message:m("max.length.10")}],children:(0,f.jsx)(u.A,{min:0,className:"w-100"})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:m("shop"),name:"shop_id",rules:[{required:!0,message:m("required")}],children:(0,f.jsx)(A.G,{fetchOptions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const l={search:e,perPage:10,page:1};return""===e.trim()&&delete l.search,x.A.getAll(l).then((e=>{var l;return null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))}})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{name:"for",label:"for",rules:[{required:!0,message:m("required")}],children:(0,f.jsx)(d.A,{options:y})})})]}),(0,f.jsx)(c.A,{type:"primary",htmlType:"submit",loading:q,children:m("submit")})]})}}}]);