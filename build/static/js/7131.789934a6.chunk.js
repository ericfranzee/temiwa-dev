"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[7131],{87131:(e,l,i)=>{i.r(l),i.d(l,{default:()=>_});var t=i(9950),n=i(87094),s=i(41988),r=i(23263),a=i(80737),d=i(12916),o=i(72243),c=i(82706),u=i(28429),v=i(91854),m=i(74623),h=i(12598),p=i(63620),j=i(70030),x=i(17213),g=i(59233),A=i(99674),y=i(55902),b=i(25933),f=i(48538),w=i(85923),k=i(98591),I=i(48970),P=i(44414);const E=e=>{var l,i;let{parent:r={},setId:a,setIsRefetch:d}=e;const{t:o}=(0,j.B)(),{activeMenu:c}=(0,v.d4)((e=>e.menu),v.bN),[u,m]=(0,t.useState)(null!==(l=c.data)&&void 0!==l&&l.image?[null===(i=c.data)||void 0===i?void 0:i.image]:[]),[p]=g.A.useForm(),[x,E]=(0,t.useState)(!1),[_,q]=(0,t.useState)(null),{defaultLang:S,languages:N}=(0,v.d4)((e=>e.formLang),v.bN);(0,t.useEffect)((()=>()=>{p.resetFields()}),[]);return null!==r&&void 0!==r&&r.id?(0,P.jsxs)(g.A,{name:"basic",layout:"vertical",onFinish:e=>{var l,i;E(!0);const t={...e,type:"main"===(null===r||void 0===r?void 0:r.type)?"sub_main":"child",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(l=e.parent_id)||void 0===l?void 0:l.value,"images[0]":null===(i=u[0])||void 0===i?void 0:i.name};h.A.create(t).then((()=>{w.oR.success(o("successfully.created")),a(null),p.resetFields(),d(!0)})).catch((e=>q(e.response.data.params))).finally((()=>E(!1)))},initialValues:{active:!0,...r},form:p,children:[(0,P.jsxs)(n.A,{gutter:24,children:[(0,P.jsx)(s.A,{span:24,children:(0,P.jsx)(g.A.Item,{label:o("parent.category"),name:"parent_id",rules:[{required:!1,message:o("required")}],children:(0,P.jsx)(A.A,{disabled:!0})})}),(0,P.jsx)(s.A,{span:24,children:N.map(((e,l)=>(0,P.jsx)(g.A.Item,{label:o("name"),name:"title[".concat(e.locale,"]"),help:_&&_["title.".concat(S)]?_["title.".concat(S)][0]:null,validateStatus:_?"error":"success",rules:[{required:!0,validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==S?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(o("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(o("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(o("required")))}],hidden:e.locale!==S,children:(0,P.jsx)(y.A,{placeholder:o("name")})},e.title+l)))}),(0,P.jsx)(s.A,{span:24,children:N.map(((e,l)=>(0,P.jsx)(g.A.Item,{label:o("description"),name:"description[".concat(e.locale,"]"),rules:[{required:!0,validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==S?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(o("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(o("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(o("required")))}],hidden:e.locale!==S,children:(0,P.jsx)(k.A,{rows:4})},e.locale+l)))}),(0,P.jsx)(s.A,{span:24,children:(0,P.jsx)(g.A.Item,{label:o("keywords"),name:"keywords",rules:[{required:!0,message:o("required")}],children:(0,P.jsx)(A.A,{mode:"tags",style:{width:"100%"}})})}),(0,P.jsx)(s.A,{span:12,children:(0,P.jsx)(g.A.Item,{label:o("image"),name:"images",rules:[{validator:()=>0===(null===u||void 0===u?void 0:u.length)?Promise.reject(new Error(o("required"))):Promise.resolve()}],children:(0,P.jsx)(I.A,{type:"categories",imageList:u,setImageList:m,form:p,multiple:!1})})}),(0,P.jsx)(s.A,{span:12,children:(0,P.jsx)(g.A.Item,{label:o("active"),name:"active",valuePropName:"checked",children:(0,P.jsx)(b.A,{})})})]}),(0,P.jsx)(f.A,{type:"primary",htmlType:"submit",loading:x,className:"w-100",children:o("submit")})]}):""},_=()=>{var e,l,i,g,A;const{t:y}=(0,j.B)(),{uuid:b}=(0,u.g)(),f=(0,v.wA)(),[w,k]=(0,t.useState)(null),[I,_]=(0,t.useState)({}),[q,S]=(0,t.useState)(null),[N,L]=(0,t.useState)(null),{activeMenu:F}=(0,v.d4)((e=>e.menu),v.bN),[C,R]=(0,t.useState)(!1),{languages:z,defaultLang:B}=(0,v.d4)((e=>e.formLang),v.bN);function M(e){if(!e)return{};const{translations:l}=e,i=z.map((e=>{var i,t;return{["title[".concat(e.locale,"]")]:null===(i=l.find((l=>l.locale===e.locale)))||void 0===i?void 0:i.title,["description[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.description}}));return Object.assign({},...i)}return(0,t.useEffect)((()=>{var e;b&&(e=b,R(!0),h.A.getById(e).then((e=>{var l,i,t;let n=e.data;const s={...n,...M(n),image:[(r=n.img,{name:r,url:p.sE+r})],keywords:null===n||void 0===n||null===(l=n.keywords)||void 0===l?void 0:l.split(","),parent_id:{label:null===(i=n.parent)||void 0===i||null===(t=i.translation)||void 0===t?void 0:t.title,value:n.parent_id,key:n.parent_id}};var r;_(s),k(n.id)})).finally((()=>{R(!1),f((0,m.km)(F))})))}),[F.refetch,b]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(n.A,{gutter:24,className:"mb-4",children:[(0,P.jsx)(s.A,{span:8,children:(0,P.jsx)(r.A,{title:y("basic.info"),style:{height:"100%"},loading:C,children:(0,P.jsxs)(n.A,{gutter:[24,24],children:[(0,P.jsx)(s.A,{span:24,children:(0,P.jsxs)(a.A,{children:[(0,P.jsxs)("strong",{children:[y("category.name"),":"]}),(0,P.jsx)("span",{children:null===I||void 0===I||null===(e=I.translation)||void 0===e?void 0:e.title})]})}),(0,P.jsx)(s.A,{span:24,children:(0,P.jsxs)(a.A,{children:[(0,P.jsxs)("strong",{children:[y("category.description"),":"]}),(0,P.jsx)("span",{children:I["description[".concat(B||"en","]")]})]})})]})})}),(0,P.jsx)(s.A,{span:8,children:(0,P.jsx)(r.A,{title:y("organization"),style:{height:"100%"},loading:C,children:(0,P.jsxs)(n.A,{gutter:[24,24],children:[(0,P.jsx)(s.A,{span:24,children:(0,P.jsxs)(a.A,{children:[(0,P.jsxs)("strong",{children:[y("keyword"),":"]}),null===I||void 0===I||null===(l=I.keywords)||void 0===l?void 0:l.map(((e,l)=>(0,P.jsx)(d.A,{children:e},l)))]})}),(0,P.jsx)(s.A,{span:24,children:(0,P.jsxs)(a.A,{children:[(0,P.jsxs)("strong",{children:[y("parent.category"),":"]}),(0,P.jsx)("span",{children:null===I||void 0===I||null===(i=I.parent)||void 0===i||null===(g=i.translation)||void 0===g?void 0:g.title})]})})]})})}),(0,P.jsx)(s.A,{span:8,children:(0,P.jsx)(r.A,{title:y("media"),style:{height:"100%"},loading:C,children:(0,P.jsx)(a.A,{wrap:!0,children:null===I||void 0===I||null===(A=I.image)||void 0===A?void 0:A.map((e=>(0,P.jsx)(o.A,{src:e.url,width:100,height:100})))})})})]}),!!w&&(0,P.jsx)(x.A,{type:"main"===(null===I||void 0===I?void 0:I.type)?"sub_main":"child",parent_type:null===I||void 0===I?void 0:I.type,parentId:w,handleAddAction:e=>{S(e)},isRefetch:N}),(0,P.jsx)(c.A,{title:y("add.subcategory"),visible:q,onCancel:()=>{S(null)},centered:!0,footer:null,destroyOnClose:!0,children:(0,P.jsx)(E,{setId:S,id:q,setIsRefetch:L,parent:{parent_id:{label:I["title[".concat(B,"]")],value:null===I||void 0===I?void 0:I.id},id:null===I||void 0===I?void 0:I.id,type:null===I||void 0===I?void 0:I.type}})})]})}}}]);