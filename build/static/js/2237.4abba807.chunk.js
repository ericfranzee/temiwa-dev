"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[2237],{47992:(e,t,s)=>{s.d(t,{G:()=>c});var n=s(9950),r=s(95491),a=s.n(r),i=s(99674),o=s(90650),l=s(44414);const c=e=>{let{fetchOptions:t,debounceTimeout:s=400,onClear:r,refetchOptions:c=!1,...d}=e;const[m,u]=(0,n.useState)(!1),[p,x]=(0,n.useState)([]),h=(0,n.useMemo)((()=>a()((e=>{x([]),u(!0),t(e).then((e=>{x(e),u(!1)}))}),s)),[t,s]);return(0,l.jsx)(i.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),r&&r()},notFoundContent:m?(0,l.jsx)(o.A,{size:"small"}):"no results",...d,options:p,onFocus:()=>{p.length&&!c||h("")}})}},31281:(e,t,s)=>{function n(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const n=e.map((e=>({[e.locale]:""===t["".concat(s,"[").concat(e.locale,"]")]?void 0:t["".concat(s,"[").concat(e.locale,"]")]})));return Object.assign({},...n)}s.d(t,{A:()=>n})},66136:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(82371);const r={getAll:e=>n.A.get("rest/form-options",{params:e}),getById:e=>n.A.get("rest/form-options/".concat(e))}},46645:(e,t,s)=>{s.d(t,{A:()=>c,b:()=>i});var n=s(9950),r=s(99210),a=s(44414);const i=(0,n.createContext)({}),o={activeItemIndex:0,formItemsList:[{answer_type:"short_answer",question:"New question",required:!0}]},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.TH.addNewFormItem:return{activeItemIndex:e.formItemsList.length,formItemsList:[...e.formItemsList,t.payload]};case r.TH.updateFormItem:{const s=[...e.formItemsList];return s[e.activeItemIndex]=t.payload,{activeItemIndex:-1,formItemsList:s}}case r.TH.cancelFormItem:return{activeItemIndex:-1,formItemsList:e.formItemsList};case r.TH.startUpdatingFormItem:return{activeItemIndex:t.payload,formItemsList:e.formItemsList};case r.TH.deleteActiveFormItem:{const t=[...e.formItemsList];return t.splice(e.activeItemIndex,1),{activeItemIndex:-1,formItemsList:t}}case r.TH.setFormItemsState:return{activeItemIndex:-1,formItemsList:t.payload};case r.TH.moveUpQuestion:{const t=[...e.formItemsList],s=t[e.activeItemIndex];return t[e.activeItemIndex]=t[e.activeItemIndex-1],t[e.activeItemIndex-1]=s,{activeItemIndex:e.activeItemIndex-1,formItemsList:t}}case r.TH.moveDownQuestion:{const t=[...e.formItemsList],s=t[e.activeItemIndex];return t[e.activeItemIndex]=t[e.activeItemIndex+1],t[e.activeItemIndex+1]=s,{activeItemIndex:e.activeItemIndex+1,formItemsList:t}}case r.TH.copyFormItem:{const s=[...e.formItemsList];return s.splice(e.activeItemIndex+1,0,t.payload),{activeItemIndex:e.activeItemIndex+1,formItemsList:s}}default:return e}};const c=function(e){let{children:t}=e;const[s,r]=(0,n.useReducer)(l,o);return(0,a.jsx)(i.Provider,{value:{formOptionsState:s,formOptionsDispatch:r},children:t})}},42237:(e,t,s)=>{s.d(t,{A:()=>W});var n=s(70030),r=s(91854),a=s(28429),i=s(9950),o=s(46645),l=s(99210),c=s(85923),d=s(23263),m=s(59233),u=s(55902),p=s(87094),x=s(41988),h=s(25933),v=s(48538),j=s(80737),I=s(24893),A=s(90650),f=s(98591),w=s(99674),y=s(40895),g=s(78840),b=s(94889),_=s(67376),F=s(44070),N=s(94118),q=s(13239),C=s(77484),L=s(8750),T=s(44414);function k(e){let{answer_type:t}=e;const{t:s}=(0,n.B)();return"single_answer"===t||"multiple_choice"===t||"drop_down"===t?(0,T.jsx)(m.A.List,{name:"answer",label:"Answers",rules:[{validator:async(e,t)=>{if(!t||t.length<2)return Promise.reject(new Error("add.at.least.2.option"))}}],children:(e,t,n)=>{let{add:r,remove:a}=t,{errors:i}=n;return(0,T.jsxs)(T.Fragment,{children:[e.map(((t,n)=>(0,T.jsx)(m.A.Item,{required:!1,className:"w-100",validateStatus:i.length&&"error",help:i[n],children:(0,T.jsxs)("div",{className:"d-flex",children:[(0,T.jsx)(m.A.Item,{label:"".concat(s("answer")," ").concat(n+1),...t,rules:[{required:!0,message:s("required")}],noStyle:!0,children:(0,T.jsx)(u.A,{className:"w-100"})}),(0,T.jsx)(v.A,{icon:(0,T.jsx)(C.A,{}),type:"danger",onClick:()=>a(t.name),className:"ml-2",disabled:e.length<=2})]})},t.key))),(0,T.jsx)(m.A.Item,{className:"w-100",children:(0,T.jsx)(v.A,{type:"link",onClick:()=>r(),icon:(0,T.jsx)(L.A,{}),children:s("add.field")})})]})}}):null}const S=function(e){let{data:t}=e;const{t:s}=(0,n.B)(),[r]=m.A.useForm(),{formOptionsState:a,formOptionsDispatch:c}=(0,i.useContext)(o.b),I={question:t.question,answer_type:t.answer_type,answer:t.answer,required:t.required};return(0,T.jsx)(d.A,{className:"border",style:{background:"rgba(0,0,0, 0.1)"},children:(0,T.jsx)(m.A,{form:r,initialValues:I,onFinish:e=>{c({type:l.TH.updateFormItem,payload:e})},layout:"vertical",children:(0,T.jsxs)(p.A,{gutter:10,children:[(0,T.jsx)(x.A,{span:10,children:(0,T.jsx)(m.A.Item,{name:"answer_type",label:"answer.type",rules:[{required:!0}],children:(0,T.jsx)(w.A,{onChange:e=>{"single_answer"!==e&&"multiple_choice"!==e&&"drop_down"!==e||r.getFieldValue("answer")||r.setFieldsValue({answer:["Answer 1","Answer 2"]})},children:l.pU.map((e=>(0,T.jsx)(w.A.Option,{value:e,children:s(e)},e)))})})}),(0,T.jsx)(x.A,{span:14,children:(0,T.jsx)(m.A.Item,{name:"question",label:"question",rules:[{required:!0}],children:(0,T.jsx)(u.A,{})})}),(0,T.jsx)(m.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.answer_type!==t.answer_type,children:e=>{let{getFieldValue:t}=e;return(0,T.jsx)(k,{answer_type:t("answer_type")})}}),(0,T.jsx)(y.A,{className:"mt-0"}),(0,T.jsxs)("div",{className:"flex justify-content-between items-center w-100",children:[(0,T.jsx)("div",{children:(0,T.jsx)(m.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.answer_type!==t.answer_type,children:e=>{let{getFieldValue:t}=e;return"description_text"!==t("answer_type")?(0,T.jsx)(m.A.Item,{name:"required",valuePropName:"required",label:s("required"),className:"mb-0",children:(0,T.jsx)(h.A,{defaultChecked:I.required})}):null}})}),(0,T.jsxs)(j.A,{children:[(0,T.jsx)(v.A,{onClick:()=>{c({type:l.TH.moveUpQuestion})},htmlType:"button",icon:(0,T.jsx)(g.A,{}),disabled:0===a.activeItemIndex}),(0,T.jsx)(v.A,{onClick:()=>{c({type:l.TH.moveDownQuestion})},htmlType:"button",icon:(0,T.jsx)(b.A,{}),disabled:a.activeItemIndex===a.formItemsList.length-1}),(0,T.jsx)("div",{role:"separator"}),(0,T.jsx)(v.A,{onClick:()=>{const e=Object.assign({},a.formItemsList[a.activeItemIndex]);e.question+=" copy",c({type:l.TH.copyFormItem,payload:e})},htmlType:"button",icon:(0,T.jsx)(_.A,{})}),(0,T.jsx)(v.A,{onClick:()=>{c({type:l.TH.deleteActiveFormItem})},htmlType:"button",icon:(0,T.jsx)(F.A,{}),type:"danger",disabled:1===a.formItemsList.length}),(0,T.jsx)("div",{role:"separator"}),(0,T.jsx)(v.A,{onClick:()=>{c({type:l.TH.cancelFormItem})},htmlType:"button",icon:(0,T.jsx)(N.A,{})}),(0,T.jsx)(v.A,{htmlType:"submit",icon:(0,T.jsx)(q.A,{}),type:"primary"})]})]})]})})})};var O=s(52765),H=s(99985);function U(e){let{data:t}=e;switch(t.answer_type){case"short_answer":return(0,T.jsx)(u.A,{});case"long_answer":return(0,T.jsx)(f.A,{rows:2});case"single_answer":return(0,T.jsx)(I.Ay.Group,{children:(0,T.jsx)(j.A,{direction:"vertical",children:t.answer.map((e=>(0,T.jsx)(I.Ay,{value:e,children:e})))})});case"multiple_choice":return(0,T.jsx)(j.A,{direction:"vertical",children:t.answer.map((e=>(0,T.jsx)(O.A,{children:e})))});case"drop_down":return(0,T.jsx)(w.A,{placeholder:"Please select",children:t.answer.map(((e,t)=>(0,T.jsx)(w.A.Option,{value:e+t,children:e})))});case"yes_or_no":return(0,T.jsxs)(I.Ay.Group,{children:[(0,T.jsx)(I.Ay.Button,{value:"yes",children:"Yes"}),(0,T.jsx)(I.Ay.Button,{value:"no",children:"No"})]});case"description_text":return(0,T.jsx)("div",{className:"mb-4",children:(0,T.jsx)(H.A,{message:t.question,type:"info",className:"mt-3"})});default:return(0,T.jsx)("p",{children:"Unknown type"})}}const P=function(e){let{data:t,disabled:s,onClick:n}=e;return(0,T.jsx)(m.A,{layout:"vertical",onClick:n,children:"description_text"===t.answer_type?(0,T.jsx)(U,{data:t}):(0,T.jsx)(m.A.Item,{label:t.question,required:!(null===t||void 0===t||!t.required),style:{pointerEvents:s?"none":"auto"},children:(0,T.jsx)(U,{data:t})})})};const B=function(e){let{active:t,data:s,index:n}=e;const{formOptionsDispatch:r}=(0,i.useContext)(o.b);return t?(0,T.jsx)(S,{data:s}):(0,T.jsx)(P,{data:s,disabled:!0,onClick:()=>{r({type:l.TH.startUpdatingFormItem,payload:n})}})};var V=s(53387),z=s(82706);const D=function(e){let{visible:t,onCancel:s,onOk:r}=e;const{t:a}=(0,n.B)(),[o,c]=(0,i.useState)(l.pU[0]);return(0,T.jsx)(z.A,{title:a("select.answer.type"),visible:t,onCancel:s,onOk:()=>{s(),r(o)},children:(0,T.jsx)(p.A,{gutter:[16],children:l.pU.map((e=>(0,T.jsx)(x.A,{span:8,onClick:()=>c(e),children:(0,T.jsx)(d.A,{className:"border text-center bg-primary ".concat(o===e?"border-white":""),children:(0,T.jsxs)("div",{className:"flex flex-column cursor-pointer",children:[(0,l.wX)(e),(0,T.jsx)("span",{children:e})]})})},e)))})})};const E=function(e){let{form:t}=e;const{defaultLang:s}=(0,r.d4)((e=>e.formLang),r.bN),{formOptionsState:n}=(0,i.useContext)(o.b),{current:a}=(0,i.useRef)(t.getFieldsValue()["title[".concat(s,"]")]),{current:l}=(0,i.useRef)(t.getFieldsValue()["description[".concat(s,"]")]);return(0,T.jsx)("div",{style:{maxWidth:600,margin:"0 auto"},children:(0,T.jsxs)("div",{className:"border rounded",children:[(0,T.jsxs)(d.A,{className:"mb-0",children:[(0,T.jsx)("h3",{children:a}),(0,T.jsx)("p",{children:l})]}),(0,T.jsx)("div",{className:"border-top",children:(0,T.jsx)(d.A,{className:"mb-0",children:n.formItemsList.map(((e,t)=>(0,T.jsx)(P,{data:e,index:t},t)))})})]})})};var Q=s(31281),G=s(74623),R=s(47777),X=s(47992),M=s(33252),Y=s(66136);function K(e){let{onSubmit:t,form:s,isCreating:j}=e;const{t:I}=(0,n.B)(),A=(0,r.wA)(),w=(0,a.Zp)(),{activeMenu:y}=(0,r.d4)((e=>e.menu),r.bN),{defaultLang:g,languages:b}=(0,r.d4)((e=>e.formLang),r.bN),{formOptionsState:_,formOptionsDispatch:F}=(0,i.useContext)(o.b),[N,q]=(0,i.useState)(!1),[C,L]=(0,i.useState)(!1);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{style:{maxWidth:600,margin:"0 auto"},children:[(0,T.jsxs)("div",{className:"border rounded",children:[(0,T.jsx)(d.A,{className:"mb-0",children:(0,T.jsxs)(m.A,{form:s,layout:"vertical",onFinish:e=>{L(!0);const s={title:(0,Q.A)(b,e,"title"),description:(0,Q.A)(b,e,"description"),required:e.required?1:0,active:e.active?1:0,data:_.formItemsList.map((e=>({...e,required:e.required?1:0})))};t(s).then((()=>{const e="seller/form-options";c.oR.success(I("successfully.added")),(0,r.vA)((()=>{A((0,G.EK)({...y,nextUrl:e})),A((0,R.C0)({}))})),w("/".concat(e))})).finally((()=>L(!1)))},children:[b.map((e=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(m.A.Item,{label:I("title"),name:"title[".concat(e.locale,"]"),hidden:e.locale!==g,rules:[{validator:(t,s)=>s||(null===e||void 0===e?void 0:e.locale)!==g?s&&""===(null===s||void 0===s?void 0:s.trim())?Promise.reject(new Error(I("no.empty.space"))):s&&(null===s||void 0===s?void 0:s.trim().length)<5?Promise.reject(new Error(I("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(I("required")))}],children:(0,T.jsx)(u.A,{})},"title"+e.id),(0,T.jsx)(m.A.Item,{label:I("section.description"),name:"description[".concat(e.locale,"]"),rules:[{validator:(t,s)=>s||(null===e||void 0===e?void 0:e.locale)!==g?s&&""===(null===s||void 0===s?void 0:s.trim())?Promise.reject(new Error(I("no.empty.space"))):s&&(null===s||void 0===s?void 0:s.trim().length)<5?Promise.reject(new Error(I("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(I("required")))}],hidden:e.locale!==g,children:(0,T.jsx)(f.A,{})},"description"+e.locale)]}))),(0,T.jsxs)(p.A,{gutter:20,className:"mb-0",size:"middle",children:[(0,T.jsx)(x.A,{children:(0,T.jsx)(m.A.Item,{name:"required",label:I("required"),className:"mb-0",valuePropName:"required",children:(0,T.jsx)(h.A,{defaultChecked:!!j||s.getFieldValue("required")})})}),(0,T.jsx)(x.A,{children:(0,T.jsx)(m.A.Item,{name:"active",label:I("active"),className:"mb-0",children:(0,T.jsx)(h.A,{defaultChecked:!!j||s.getFieldValue("active")})})})]})]})}),(0,T.jsx)("div",{className:"border-top",children:(0,T.jsx)(d.A,{className:"mb-0",children:_.formItemsList.map(((e,t)=>(0,T.jsx)(B,{active:t===_.activeItemIndex,data:e,index:t})))})}),(0,T.jsx)("div",{className:"border-top",children:(0,T.jsx)(d.A,{className:"mb-0",children:(0,T.jsx)(v.A,{icon:(0,T.jsx)(V.A,{}),type:"link",onClick:()=>q(!0),children:I("add.form.item")})})})]}),(0,T.jsx)(v.A,{loading:C,className:"mt-3 w-100",type:"primary",onClick:s.submit,children:I("submit")})]}),N&&(0,T.jsx)(D,{visible:N,onCancel:()=>q(!1),onOk:e=>{const t=(0,l.sD)(e);F({type:l.TH.addNewFormItem,payload:t})}})]})}const W=function(e){const{t:t}=(0,n.B)(),[s,a]=(0,i.useState)("form"),[c,d]=(0,i.useState)(!1),{formOptionsDispatch:m}=(0,i.useContext)(o.b),{languages:u,defaultLang:p}=(0,r.d4)((e=>e.formLang),r.bN);function x(e){if(!e)return{};const{translations:t}=e,s=u.map((e=>{var s,n;return{["title[".concat(e.locale,"]")]:null===(s=t.find((t=>t.locale===e.locale)))||void 0===s?void 0:s.title,["description[".concat(e.locale,"]")]:null===(n=t.find((t=>t.locale===e.locale)))||void 0===n?void 0:n.description}}));return Object.assign({},...s)}return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"flex justify-content-center mb-5",children:(0,T.jsxs)(j.A,{children:[(0,T.jsx)(X.G,{allowClear:!0,fetchOptions:function(){const e={page:1,perPage:10,shop_form_options:1,search:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim()};return M.A.getAll(e).then((e=>e.data.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))))},onSelect:t=>{return s=t.value,d(!0),void Y.A.getById(s).then((t=>{var s,n;a("form"),e.form.setFieldsValue({...x(t.data),required:!(null===(s=t.data)||void 0===s||!s.required),active:!(null===(n=t.data)||void 0===n||!n.active)}),m({type:l.TH.setFormItemsState,payload:t.data.data})})).finally((()=>d(!1)));var s},placeholder:t("select.a.template"),style:{width:"12rem"}}),(0,T.jsxs)(I.Ay.Group,{value:s,onChange:e=>{a(e.target.value)},children:[(0,T.jsx)(I.Ay.Button,{value:"form",children:"Builder"}),(0,T.jsx)(I.Ay.Button,{value:"preview",children:"Preview"})]})]})}),c?(0,T.jsx)("div",{className:"flex justify-content-center",children:(0,T.jsx)(A.A,{})}):"form"===s?(0,T.jsx)(K,{...e}):(0,T.jsx)(E,{form:e.form})]})}},99210:(e,t,s)=>{s.d(t,{TH:()=>d,pU:()=>c,sD:()=>m,wX:()=>u});var n=s(31222),r=s(8394),a=s(1199),i=s(50384),o=s(54826),l=s(44414);const c=["short_answer","long_answer","single_answer","multiple_choice","drop_down","yes_or_no","description_text"],d={addNewFormItem:"addNewFormItem",updateFormItem:"updateFormItem",cancelFormItem:"cancelFormItem",deleteActiveFormItem:"deleteActiveFormItem",startUpdatingFormItem:"startUpdatingFormItem",setFormItemsState:"setFormItemsState",moveUpQuestion:"moveUpQuestion",moveDownQuestion:"moveDownQuestion",copyFormItem:"copyFormItem"};function m(e){const t={answerType:e};switch(e){case"short_answer":case"long_answer":case"yes_or_no":return{answer_type:e,question:"New question",required:!0};case"single_answer":case"multiple_choice":case"drop_down":return{answer_type:e,question:"New question",answer:["New answer 1","New answer 2"],required:!0};case"description_text":return{answer_type:e,question:"New text description"}}return t}function u(e){switch(e){case"short_answer":return(0,l.jsx)(n.v2K,{size:24});case"long_answer":return(0,l.jsx)(r.xYT,{size:24});case"single_answer":return(0,l.jsx)(a.MYX,{size:24});case"multiple_choice":return(0,l.jsx)(i.CTR,{size:24});case"drop_down":return(0,l.jsx)(n.s4V,{size:24});case"yes_or_no":return(0,l.jsx)(i.TSp,{size:24});case"description_text":return(0,l.jsx)(o.gXU,{size:24});default:console.error("Unknown answerType")}}}}]);