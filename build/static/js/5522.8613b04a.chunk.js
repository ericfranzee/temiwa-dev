"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5522],{80415:(e,l,n)=>{n.d(l,{G:()=>a,HV:()=>d,LH:()=>i,PR:()=>t,wO:()=>o,xt:()=>s});const i={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5],cooking:[1,2,3,4,5]},d=(new Date,new Date,["new","accepted","ready","on_a_way","pause","delivered","canceled"]),t=30,a="HH:mm",s="hh:mm a",o=!0},29597:(e,l,n)=>{function i(e){var l;if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const n=null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.split(", ");return{lat:Number(null===n||void 0===n?void 0:n[0]),lng:Number(null===n||void 0===n?void 0:n[1])}}n.d(l,{A:()=>i})},51066:(e,l,n)=>{n.d(l,{Q:()=>t});var i=n(17706),d=n(80415);const t=()=>{var e,l,n,t;return null!==(e=null===(l=i.M.getState())||void 0===l||null===(n=l.globalSettings)||void 0===n||null===(t=n.settings)||void 0===t?void 0:t.hour_format)&&void 0!==e?e:d.G}},53774:(e,l,n)=>{function i(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const n=Number(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===l?"".concat(n," ").concat(e):"".concat(e," ").concat(n)}n.r(l),n.d(l,{default:()=>i})},5522:(e,l,n)=>{n.r(l),n.d(l,{default:()=>Y});var i=n(9950),d=n(80737),t=n(12916),a=n(72243),s=n(52913),o=n(23263),r=n(48538),c=n(90650),u=n(87094),v=n(41988),h=n(28429),x=n(82249),p=n(69554),m=n(91854),j=n(74623),y=n(59233),g=n(82706),A=n(99674),f=n(70030),b=n(44414);const k=["new","accepted","ready","on_a_way","delivered"];function _(e){let{orderDetails:l,handleCancel:n}=e;const{activeMenu:d}=(0,m.d4)((e=>e.menu),m.bN),[t]=y.A.useForm(),a=(0,m.wA)(),{t:s}=(0,f.B)(),[o,c]=(0,i.useState)(!1),[h,p]=(0,i.useState)(k);(0,i.useEffect)((()=>{const e=k.findIndex((e=>e===l.status));let n=[k[e],k[e+1],"canceled"];e<0&&(n=[k[e+1],"canceled"]),p(n)}),[l]);return(0,b.jsx)(g.A,{visible:!!l,title:l.title,onCancel:n,footer:[(0,b.jsx)(r.A,{type:"primary",onClick:()=>t.submit(),loading:o,children:s("save")}),(0,b.jsx)(r.A,{type:"default",onClick:n,children:s("cancel")})],children:(0,b.jsx)(y.A,{form:t,layout:"vertical",onFinish:e=>{c(!0);const i={...e};x.A.updateStatus(l.id,i).then((()=>{n(),a((0,j.Ms)(d))})).finally((()=>c(!1)))},initialValues:{status:l.status},children:(0,b.jsx)(u.A,{gutter:12,children:(0,b.jsx)(v.A,{span:24,children:(0,b.jsx)(y.A.Item,{label:s("status"),name:"status",rules:[{required:!0,message:s("required")}],children:(0,b.jsx)(A.A,{children:h.map(((e,l)=>(0,b.jsx)(A.A.Option,{value:e,children:s(e)},e+l)))})})})})})})}var w=n(58127),N=n(53774),S=n(83239),C=n(50384),I=n(74930),D=n(59051),M=n.n(D),B=n(51066);function Y(){var e,l,n,y,g;const{activeMenu:A}=(0,m.d4)((e=>e.menu),m.bN),{defaultCurrency:k}=(0,m.d4)((e=>e.currency),m.bN),{statusList:D}=(0,m.d4)((e=>e.orderStatus),m.bN),Y=null===A||void 0===A||null===(e=A.data)||void 0===e?void 0:e.data,{t:q}=(0,f.B)(),{id:F}=(0,h.g)(),H=(0,m.wA)(),L=(0,i.useRef)(),R=(0,i.useRef)(),[P,E]=(0,i.useState)(null),[O,z]=(0,i.useState)(!1),[G,K]=(0,i.useState)(null),[Q,V]=(0,i.useState)(null),[W,Z]=(0,i.useState)(null),$=(0,B.Q)(),J=[{title:q("id"),dataIndex:"id",key:"id",render:(e,l)=>{var n;return null===l||void 0===l||null===(n=l.shop)||void 0===n?void 0:n.id}},{title:q("shop.name"),dataIndex:"shop.name",key:"shop.name",render:(e,l)=>{var n;return(0,b.jsx)(d.A,{direction:"vertical",className:"relative",children:null===l||void 0===l||null===(n=l.shop.translation)||void 0===n?void 0:n.title})}},{title:q("image"),dataIndex:"shop.img",key:"shop.img",render:(e,l)=>{var n;return(0,b.jsx)(a.A,{src:(0,p.A)(null===l||void 0===l||null===(n=l.shop)||void 0===n?void 0:n.logo_img),alt:"product",width:100,height:"auto",className:"rounded",preview:!0,placeholder:!0})}},{title:q("Phone"),dataIndex:"origin_price",key:"shop.phone",render:(e,l)=>{var n,i;return(0,b.jsx)("a",{href:"tel:".concat(null===l||void 0===l||null===(n=l.shop)||void 0===n?void 0:n.phone),children:null===l||void 0===l||null===(i=l.shop)||void 0===i?void 0:i.phone})}},{title:q("tax"),dataIndex:"tax",key:"tax",render:(e,l)=>{var n;return null===l||void 0===l||null===(n=l.shop)||void 0===n?void 0:n.tax}},{title:q("total.price"),dataIndex:"total_price",key:"total_price",render:e=>(0,N.default)(e,null===k||void 0===k?void 0:k.symbol)}],U=()=>{K(null),V(null),Z(null)};return(0,i.useEffect)((()=>{A.refetch&&(z(!0),x.A.getById(F).then((e=>{let{data:l}=e;const n=l.currency,i=l.user,d=l.id,t=l.price,a=l.created_at,s=l.details.map((e=>{var l,n;return{...e,title:null===(l=e.shop)||void 0===l||null===(n=l.translation)||void 0===n?void 0:n.title}}));H((0,j.Ok)({activeMenu:A,data:{details:s,currency:n,user:i,id:d,createdAt:a,price:t,data:l}}))})).finally((()=>{z(!1),H((0,j.km)(A))})))}),[A.refetch]),(0,b.jsxs)("div",{className:"order_details",children:[(0,b.jsx)(o.A,{className:"order-details-info",title:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(I.iHs,{className:"mr-2 icon"}),"".concat(q("order")," ").concat(null!==Y&&void 0!==Y&&Y.id?"#".concat(null===Y||void 0===Y?void 0:Y.id," "):"")," ",q("from.order")," ",null===Y||void 0===Y||null===(l=Y.table)||void 0===l?void 0:l.name]}),extra:"delivered"!==(null===Y||void 0===Y?void 0:Y.status)&&"canceled"!==(null===Y||void 0===Y?void 0:Y.status)&&"accepted"!==(null===Y||void 0===Y?void 0:Y.status)&&"cooking"!==(null===Y||void 0===Y?void 0:Y.status)?(0,b.jsx)(r.A,{type:"primary",onClick:()=>K(Y),children:q("change.status")}):null}),(0,b.jsx)(c.A,{spinning:O,children:(0,b.jsx)(o.A,{style:{minHeight:"200px"},children:(0,b.jsxs)(u.A,{hidden:O,className:"mb-3 order_detail",children:[(0,b.jsx)(v.A,{span:12,children:(0,b.jsxs)("div",{children:[q("created.date.&.time"),":",(0,b.jsxs)("span",{className:"ml-2",children:[(0,b.jsx)(C.cCc,{className:"mr-1"})," ",M()(null===Y||void 0===Y?void 0:Y.created_at).format("YYYY-MM-DD ".concat($))," "]})]})}),(0,b.jsx)(v.A,{span:12,children:(0,b.jsxs)("div",{children:[q("status"),":",(0,b.jsx)("span",{className:"ml-2",children:"new"===(null===Y||void 0===Y?void 0:Y.status)?(0,b.jsx)(t.A,{color:"blue",children:q(null===Y||void 0===Y?void 0:Y.status)}):"canceled"===(null===Y||void 0===Y?void 0:Y.status)?(0,b.jsx)(t.A,{color:"error",children:q(null===Y||void 0===Y?void 0:Y.status)}):(0,b.jsx)(t.A,{color:"cyan",children:q(null===Y||void 0===Y?void 0:Y.status)})})]})})," ",(0,b.jsx)(v.A,{span:12,children:(0,b.jsxs)("div",{children:[q("table"),":",(0,b.jsx)("span",{className:"ml-2",children:(null===Y||void 0===Y||null===(n=Y.table)||void 0===n?void 0:n.name)||q("unspecified")})]})}),(0,b.jsx)(v.A,{span:12,children:(0,b.jsxs)("div",{children:[q("delivery_type"),":",(0,b.jsx)("span",{className:"ml-2",children:(null===Y||void 0===Y?void 0:Y.delivery_type)||q("unspecified")})]})})]})})}),(0,b.jsxs)(o.A,{className:"w-100 order-table",children:[(0,b.jsx)(s.A,{ref:R,scroll:{x:!0},columns:J,dataSource:(null===(y=A.data)||void 0===y?void 0:y.details)||[],loading:O,rowKey:e=>e.id,pagination:!1,expandable:{expandedRowRender:e=>{const l=[{title:q("id"),dataIndex:"id",key:"id",render:(e,l)=>{var n;return null===(n=l.stock)||void 0===n?void 0:n.id}},{title:q("product.name"),dataIndex:"product",key:"product",render:(e,l)=>{var n,i,a,s,o;return(0,b.jsxs)(d.A,{direction:"vertical",className:"relative",children:[null===(n=l.stock)||void 0===n||null===(i=n.product)||void 0===i||null===(a=i.translation)||void 0===a?void 0:a.title,null===(s=l.stock)||void 0===s||null===(o=s.extras)||void 0===o?void 0:o.map((e=>{var l,n,i;return(0,b.jsxs)(t.A,{children:[null===(l=e.group)||void 0===l||null===(n=l.translation)||void 0===n?void 0:n.title,": ",null===(i=e.value)||void 0===i?void 0:i.value]},null===e||void 0===e?void 0:e.id)}))]})}},{title:q("image"),dataIndex:"img",key:"img",render:(e,l)=>{var n,i;return(0,b.jsx)(a.A,{src:(0,p.A)(null===(n=l.stock)||void 0===n||null===(i=n.product)||void 0===i?void 0:i.img),alt:"product",width:100,height:"auto",className:"rounded",preview:!0,placeholder:!0})}},{title:q("price"),dataIndex:"origin_price",key:"origin_price",render:e=>(0,N.default)(e,null===k||void 0===k?void 0:k.symbol)},{title:q("quantity"),dataIndex:"quantity",key:"quantity",render:e=>(0,b.jsx)("span",{children:e})},{title:q("discount"),dataIndex:"discount",key:"discount",render:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,N.default)(e,null===k||void 0===k?void 0:k.symbol)}},{title:q("tax"),dataIndex:"tax",key:"tax",render:e=>(0,N.default)(e,null===k||void 0===k?void 0:k.symbol)},{title:q("total.price"),dataIndex:"total_price",key:"total_price",render:(e,l)=>(0,N.default)(e,null===k||void 0===k?void 0:k.symbol)}],n=(null===e||void 0===e?void 0:e.products)||[];return(0,b.jsx)(s.A,{columns:l,dataSource:n,pagination:!1})},defaultExpandedRowKeys:["0"]}}),(0,b.jsxs)(d.A,{size:100,className:"d-flex justify-content-end w-100 order-table__summary",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("span",{children:[q("delivery.fee"),":"]}),(0,b.jsx)("br",{}),(0,b.jsxs)("span",{children:[q("order.tax"),":"]}),(0,b.jsx)("br",{}),(0,b.jsxs)("span",{children:[q("product"),":"]}),(0,b.jsx)("br",{}),(0,b.jsxs)("span",{children:[q("discount"),":"]}),(0,b.jsx)("br",{}),(0,b.jsxs)("h3",{children:[q("total.price"),":"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{children:(0,N.default)(null!==(g=null===Y||void 0===Y?void 0:Y.delivery_price)&&void 0!==g?g:0,null===k||void 0===k?void 0:k.symbol)}),(0,b.jsx)("br",{}),(0,b.jsx)("span",{children:(0,N.default)(null===Y||void 0===Y?void 0:Y.total_tax,null===k||void 0===k?void 0:k.symbol)}),(0,b.jsx)("br",{}),(0,b.jsx)("span",{children:(0,N.default)(null===Y||void 0===Y?void 0:Y.origin_price,null===k||void 0===k?void 0:k.symbol)}),(0,b.jsx)("br",{}),(0,b.jsx)("span",{children:(0,N.default)(null===Y||void 0===Y?void 0:Y.total_discount,null===k||void 0===k?void 0:k.symbol)}),(0,b.jsx)("br",{}),(0,b.jsx)("h3",{ref:L,children:(0,N.default)(null===Y||void 0===Y?void 0:Y.total_price,null===k||void 0===k?void 0:k.symbol)})]})]})]}),G&&(0,b.jsx)(_,{orderDetails:G,handleCancel:U,status:D}),Q&&(0,b.jsx)(w.A,{orderDetails:Q,handleCancel:U}),W&&(0,b.jsx)(S.A,{id:W,handleCancel:U})]})}},58127:(e,l,n)=>{n.d(l,{A:()=>p});var i=n(9950),d=n(59233),t=n(82706),a=n(48538),s=n(87094),o=n(41988),r=n(99674),c=n(91854),u=n(82249),v=n(74623),h=n(70030),x=n(44414);function p(e){var l;let{orderDetails:n,handleCancel:p}=e;const{t:m}=(0,h.B)(),{activeMenu:j}=(0,c.d4)((e=>e.menu),c.bN),{deliverymans:y}=(0,c.d4)((e=>e.deliveryman),c.bN),[g]=d.A.useForm(),A=(0,c.wA)(),[f,b]=(0,i.useState)(!1);return(0,x.jsx)(t.A,{visible:!!n,title:n.title,onCancel:p,footer:[(0,x.jsx)(a.A,{type:"primary",onClick:()=>g.submit(),loading:f,children:m("save")}),(0,x.jsx)(a.A,{type:"default",onClick:p,children:m("cancel")})],children:(0,x.jsx)(d.A,{form:g,layout:"vertical",onFinish:e=>{const l={...e};b(!0),u.A.updateDelivery(n.id,l).then((()=>{p(),A((0,v.Ms)(j))})).finally((()=>b(!1)))},initialValues:{deliveryman:null===(l=n.deliveryman)||void 0===l?void 0:l.id},children:(0,x.jsx)(s.A,{gutter:12,children:(0,x.jsx)(o.A,{span:24,children:(0,x.jsx)(d.A.Item,{label:m("deliveryman"),name:"deliveryman",rules:[{required:!0,message:m("required")}],children:(0,x.jsx)(r.A,{children:y.map(((e,l)=>(0,x.jsxs)(r.A.Option,{value:e.id,className:"d-block",children:[e.firstname," ",e.lastname||""]},e.id)))})})})})})})}},83239:(e,l,n)=>{n.d(l,{A:()=>Y});var i=n(69286),d=n(86366),t=n(82706),a=n(48538),s=n(23263),o=n(87094),r=n(41988),c=n(12916),u=n(9950),v=n(70030),h=n(82249),x=n(81446),p=n(50384),m=n(91854),j=n(63620),y=n(41478),g=n(73631),A=n(29597),f=n(47965),b=n(31222),k=n(6604),_=n(68873),w=n(51066),N=n(59051),S=n.n(N),C=n(44414);const{Step:I}=d.A,D=()=>(0,C.jsx)("img",{src:y,width:"50",alt:"Pin"}),M=()=>(0,C.jsx)("img",{src:g,width:"50",alt:"Pin"}),B=["blue","red","gold","volcano","cyan","lime"],Y=e=>{var l,n,y,g,N,Y;let{id:q,handleCancel:F}=e;const{t:H}=(0,v.B)(),[L,R]=(0,u.useState)(null),[P,E]=(0,u.useState)(null),[O,z]=(0,u.useState)(null),{settings:G}=(0,m.d4)((e=>e.globalSettings),m.bN),K=(0,w.Q)(),Q=(0,A.A)(G),[V,W]=(0,u.useState)(0),[Z,$]=(0,u.useState)((0,A.A)(G)),[J,U]=(0,u.useState)((0,A.A)(G)),[X,T]=(0,u.useState)([{id:0,name:"new",icon:(0,C.jsx)(f.A,{})},{id:1,name:"accepted",icon:(0,C.jsx)(p.LW,{})},{id:2,name:"ready",icon:(0,C.jsx)(b.NtI,{})},{id:3,name:"on_a_way",icon:(0,C.jsx)(k.o2P,{})},{id:4,name:"delivered",icon:(0,C.jsx)(k.eDZ,{})}]);const{google_map_key:ee}=(0,m.d4)((e=>e.globalSettings.settings),m.bN);(0,u.useEffect)((()=>{R(!0),h.A.getById(q).then((e=>{var l;let{data:n}=e;T("canceled"===n.status?[{id:1,name:"new",icon:(0,C.jsx)(f.A,{})},{id:5,name:"canceled",icon:(0,C.jsx)(_.XfH,{})}]:X),W("canceled"===n.status?1:null===(l=X.find((e=>e.name===n.status)))||void 0===l?void 0:l.id),z("canceled"===n.status?"error":"success"),E(n),U({lat:n.location.latitude,lng:n.location.longitude}),$({lat:n.shop.location.latitude,lng:n.shop.location.longitude})})).finally((()=>{R(!1)}))}),[]);return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(t.A,{visible:!!q,title:H("show.locations"),closable:!0,onCancel:F,style:{minWidth:"80vw"},footer:[(0,C.jsx)(a.A,{type:"default",onClick:F,children:H("cancel")},"cancelBtn")],children:L?(0,C.jsx)(x.A,{}):(0,C.jsxs)(s.A,{children:[(0,C.jsx)(d.A,{current:V,status:O,className:"mb-5",children:null===X||void 0===X?void 0:X.map(((e,l)=>(0,C.jsx)(I,{title:H(e.name),icon:null===e||void 0===e?void 0:e.icon},e.id+l)))}),(0,C.jsxs)(o.A,{gutter:12,children:[(0,C.jsxs)(r.A,{span:12,children:[(0,C.jsxs)("h3",{children:[H("order.id")," #",null===P||void 0===P?void 0:P.id]}),(0,C.jsxs)("p",{children:[(0,C.jsx)(p.A5h,{})," ",S()(null===P||void 0===P?void 0:P.created_at).format("YYYY-MM-DD ".concat(K))]}),(0,C.jsxs)("p",{children:[H("schedulet.at")," ",null===P||void 0===P?void 0:P.delivery_date]}),(0,C.jsxs)("span",{children:[(0,C.jsx)("strong",{children:null===P||void 0===P||null===(l=P.shop)||void 0===l||null===(n=l.translation)||void 0===n?void 0:n.title})," ",null===P||void 0===P||null===(y=P.details)||void 0===y?void 0:y.map(((e,l)=>{var n;return(0,C.jsx)(c.A,{className:"mb-2",color:B[l],children:null===e||void 0===e||null===(n=e.stock)||void 0===n?void 0:n.product.translation.title})}))]})]}),(0,C.jsxs)(r.A,{span:12,children:[(0,C.jsxs)("p",{children:[H("status")," ","new"===(null===P||void 0===P?void 0:P.status)?(0,C.jsx)(c.A,{color:"blue",children:H(null===P||void 0===P?void 0:P.status)}):"canceled"===(null===P||void 0===P?void 0:P.status)?(0,C.jsx)(c.A,{color:"error",children:H(null===P||void 0===P?void 0:P.status)}):(0,C.jsx)(c.A,{color:"cyan",children:H(null===P||void 0===P?void 0:P.status)})]}),(0,C.jsxs)("p",{children:[H("payment.method")," ",(0,C.jsx)("strong",{children:null===P||void 0===P||null===(g=P.transaction)||void 0===g||null===(N=g.payment_system)||void 0===N?void 0:N.tag})]}),(0,C.jsxs)("p",{children:[H("order.type")," ",(0,C.jsx)("strong",{children:null===P||void 0===P?void 0:P.delivery_type})]}),(0,C.jsxs)("p",{children:[H("payment.type")," ",(0,C.jsx)("strong",{children:null===P||void 0===P||null===(Y=P.transaction)||void 0===Y?void 0:Y.status})]})]}),(0,C.jsxs)(r.A,{span:24,className:"mt-5",children:[(0,C.jsx)("h4",{children:H("map")}),(0,C.jsx)("div",{className:"map-container",style:{height:400,width:"100%"},children:(0,C.jsxs)(i.Ay,{bootstrapURLKeys:{key:ee||j.CJ},defaultZoom:14,center:Q,options:{fullscreenControl:!1},onGoogleApiLoaded:e=>{let{map:l,maps:n}=e;const i=[Z,J].map((e=>({lat:Number(e.lat||"0"),lng:Number(e.lng||"0")})));let d=new n.LatLngBounds;for(var t=0;t<i.length;t++)d.extend(i[t]);l.fitBounds(d)},children:[(0,C.jsx)(M,{lat:null===Z||void 0===Z?void 0:Z.lat,lng:null===Z||void 0===Z?void 0:Z.lng}),(0,C.jsx)(D,{lat:null===J||void 0===J?void 0:J.lat,lng:null===J||void 0===J?void 0:J.lng})]})})]})]})]})})})}},73631:(e,l,n)=>{e.exports=n.p+"static/media/shop.46d7a94ca800c711764a.png"},41478:(e,l,n)=>{e.exports=n.p+"static/media/user.fbe7078c52acde79652d.jpg"}}]);