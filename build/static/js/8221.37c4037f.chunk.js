"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[8221],{27276:(e,t,a)=>{a.d(t,{v:()=>d});var l=a(9950),i=a(90777),n=a(90650),s=a(44414);const d=e=>{let{fetchOptions:t,refetch:a=!1,...d}=e;const[r,u]=(0,l.useState)(!1),[o,c]=(0,l.useState)([]);return(0,s.jsx)(i.A,{treeLine:!0,treeData:r?[]:o,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{o.length&&!a||(u(!0),t().then((e=>{c(e),u(!1)})))},notFoundContent:r?(0,s.jsx)(n.A,{size:"small"}):"no results",...d})}},28221:(e,t,a)=>{a.r(t),a.d(t,{default:()=>q});var l=a(9950),i=a(59233),n=a(23263),s=a(87094),d=a(40577),r=a(41988),u=a(55902),o=a(99674),c=a(48538),m=a(90650),p=a(85923),v=a(28429),h=a(71999),g=a(98591),y=a(91854),x=a(74623),j=a(12598),A=a(63620),b=a(70030),f=a(48970),k=a(8228),_=a(28264),w=a(27276),I=a(44414);const q=()=>{var e,t;const{t:a}=(0,b.B)(),q=(0,v.Zp)(),S=(0,y.wA)(),[F,N]=(0,l.useState)(null),[z,C]=(0,l.useState)("main"),{activeMenu:E}=(0,y.d4)((e=>e.menu),y.bN),{params:L}=(0,y.d4)((e=>e.requestModels),y.bN),{user:O}=(0,y.d4)((e=>e.auth),y.bN),{state:V}=(0,v.zy)(),[M,B]=(0,l.useState)(!1),[D,P]=(0,l.useState)(null!==(e=E.data)&&void 0!==e&&e.image?[null===(t=E.data)||void 0===t?void 0:t.image]:[]),[K]=i.A.useForm(),[R,T]=(0,l.useState)(!1),[U,Z]=(0,l.useState)(null),{uuid:G}=(0,v.g)(),{defaultLang:H,languages:J}=(0,y.d4)((e=>e.formLang),y.bN);(0,l.useEffect)((()=>()=>{const e=K.getFieldsValue(!0);S((0,x.Ok)({activeMenu:E,data:e})),S((0,_.uO)({...L,type:z,parent_id:null===V||void 0===V?void 0:V.parentId,shop_id:null===O||void 0===O?void 0:O.shop_id}))}),[]);const Q=e=>({name:e,url:A.sE+e}),W=e=>Object.assign({},...e);(0,l.useEffect)((()=>{var e;e=G,B(!0),j.A.getById(e).then((e=>{var t,a;let l=e.data;const i={...l,title:W(l.translations.map((e=>({[e.locale]:e.title})))),description:W(l.translations.map((e=>({[e.locale]:e.description})))),image:[Q(l.img)],keywords:l.keywords.split(","),id:l.id,parent_id:{label:null===(t=l.parent)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title,value:l.parent_id,key:l.parent_id}};N(l.id),K.setFieldsValue(i),P([Q(l.img)])})).finally((()=>{B(!1),S((0,x.km)(E))}))}),[E.refetch,G,null===V||void 0===V?void 0:V.parentId]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(n.A,{title:null!==V&&void 0!==V&&V.parentId?a("edit.sub.category"):a("edit.category"),extra:(0,I.jsx)(h.A,{}),children:M?(0,I.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,I.jsx)(m.A,{size:"large",className:"mt-5 pt-5"})}):(0,I.jsxs)(i.A,{name:"basic",layout:"vertical",onFinish:e=>{var t,l;T(!0);const i={id:e.id,type:"category",data:{...e,type:null!==(t=e.parent_id)&&void 0!==t&&t.value?z:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(l=e.parent_id)||void 0===l?void 0:l.value,images:null===D||void 0===D?void 0:D.map((e=>e.name))}},n="seller/categories";k.A.requestChange(i).then((()=>{p.oR.success(a("successfully.updated")),S((0,x.EK)({...E,nextUrl:n})),q("/".concat(n),{state:{tab:"request"}})})).catch((e=>Z(e.response.data.params))).finally((()=>T(!1)))},initialValues:{active:!0,...E.data},form:K,children:[(0,I.jsxs)(s.A,{gutter:12,children:[(0,I.jsx)(i.A.Item,{name:"id",hidden:!0,children:(0,I.jsx)(d.A,{})}),(0,I.jsx)(r.A,{span:12,children:J.map(((e,t)=>(0,I.jsx)(i.A.Item,{label:a("name"),name:["title",e.locale],help:U&&U.title[H]?U.title[H][0]:null,validateStatus:U?"error":"success",rules:[{required:e.locale===H,message:a("required")}],hidden:e.locale!==H,children:(0,I.jsx)(u.A,{})},e.title+t)))}),(0,I.jsx)(r.A,{span:12,children:J.map(((e,t)=>(0,I.jsx)(i.A.Item,{label:a("description"),name:["description",e.locale],rules:[{required:e.locale===H,message:a("required")}],hidden:e.locale!==H,children:(0,I.jsx)(g.A,{rows:4})},e.locale+t)))}),(0,I.jsx)(r.A,{span:12,children:(0,I.jsx)(i.A.Item,{label:a("keywords"),name:"keywords",rules:[{required:!0,message:a("required")}],children:(0,I.jsx)(o.A,{mode:"tags",style:{width:"100%"}})})}),(0,I.jsx)(r.A,{span:12,children:(0,I.jsx)(i.A.Item,{label:a("parent.category"),name:"parent_id",rules:[{required:!1,message:a("required")}],children:(0,I.jsx)(w.v,{fetchOptions:async function(){const{id:e}=K.getFieldValue();return j.A.selectPaginate({perPage:100,type:"main"}).then((t=>t.data.filter((t=>t.id!==e)).map((e=>{var t,a;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"main",children:null===(a=e.children)||void 0===a?void 0:a.map((e=>{var t,a;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"sub_main",children:null===(a=e.children)||void 0===a?void 0:a.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,disabled:!0,type:"child"}}))}}))}}))))},onSelect:(e,t,a)=>{const{type:l}=t||{};C("main"===l?"sub_main":"sub_main"===l?"child":"main")},allowClear:!0})})}),(0,I.jsx)(r.A,{span:4,children:(0,I.jsx)(i.A.Item,{label:a("image"),children:(0,I.jsx)(f.A,{type:"categories",imageList:D,setImageList:P,form:K,multiple:!1})})})]}),(0,I.jsx)(c.A,{type:"primary",htmlType:"submit",loading:R,children:a("submit")})]})})})}}}]);