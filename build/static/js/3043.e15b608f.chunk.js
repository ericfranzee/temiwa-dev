"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[3043],{33043:(e,o,t)=>{t.r(o),t.d(o,{default:()=>S});var l=t(9950),n=t(86366),a=t(59233),i=t(23263),d=t(28429),s=t(91854),r=t(70030),u=t(75482),c=t(73364),v=t(70364),m=t(82039),_=t(65820),f=t(74623),p=t(29597),g=t(59051),h=t.n(g),y=t(19689),x=t(33824),A=t(85923),j=t(44414);const{Step:F}=n.A;function S(){var e,o,t,g,S,N,C,b,k,E,M,Y;const{t:w}=(0,r.B)(),[O]=a.A.useForm(),z=(0,_.s)(),D=(0,s.wA)(),H=(0,d.Zp)(),{activeMenu:J}=(0,s.d4)((e=>e.menu),s.bN),{settings:L}=(0,s.d4)((e=>e.globalSettings),s.bN),{defaultCurrency:R}=(0,s.d4)((e=>e.currency),s.bN),T=Number((null===(e=z.values)||void 0===e?void 0:e.step)||0),[V,B]=(0,l.useState)(!1),[I,K]=(0,l.useState)((null===J||void 0===J||null===(o=J.data)||void 0===o?void 0:o.images)||[]),[U,Z]=(0,l.useState)(null!==J&&void 0!==J&&null!==(t=J.data)&&void 0!==t&&t.location_from?{lat:parseFloat(null===J||void 0===J||null===(g=J.data)||void 0===g||null===(S=g.location_from)||void 0===S?void 0:S.latitude),lng:parseFloat(null===J||void 0===J||null===(N=J.data)||void 0===N||null===(C=N.location_from)||void 0===C?void 0:C.longitude)}:(0,p.A)(L)),[q,G]=(0,l.useState)(null!==J&&void 0!==J&&null!==(b=J.data)&&void 0!==b&&b.location_to?{lat:parseFloat(null===J||void 0===J||null===(k=J.data)||void 0===k||null===(E=k.location_to)||void 0===E?void 0:E.latitude),lng:parseFloat(null===J||void 0===J||null===(M=J.data)||void 0===M||null===(Y=M.location_to)||void 0===Y?void 0:Y.longitude)}:(0,p.A)(L));(0,l.useEffect)((()=>()=>{const e=O.getFieldsValue(!0),o=JSON.stringify(e.delivery_date),t=JSON.stringify(e.delivery_time),l={...e,date:o,time:t};D((0,f.Ok)({activeMenu:J,data:l}))}),[]);const P=()=>{const e=T+1;z.set("step",e)},Q=()=>{const e=T-1;z.set("step",e)};return(0,j.jsxs)(i.A,{title:w("add.parcel.order"),children:[(0,j.jsx)(n.A,{current:T,onChange:e=>{z.set("step",e)},children:u.C.map((e=>(0,j.jsx)(F,{title:w(e.title)},e.title)))}),(0,j.jsx)("div",{className:"steps-content",children:(0,j.jsxs)(a.A,{form:O,name:"parcel-create",layout:"vertical",onFinish:e=>{var o,t;B(!0);const l={user_id:null===(o=e.user_from)||void 0===o?void 0:o.value,currency_id:null===R||void 0===R?void 0:R.id,type_id:null===(t=e.type)||void 0===t?void 0:t.value,rate:null===R||void 0===R?void 0:R.rate,phone_from:e.phone_from.toString(),username_from:e.username_from,address_from:{longitude:null===U||void 0===U?void 0:U.lng,latitude:null===U||void 0===U?void 0:U.lat,address:e.address_from,house:e.house_from,stage:e.stage_from,room:e.room_from},phone_to:e.phone_to.toString(),username_to:e.username_to,address_to:{longitude:null===q||void 0===q?void 0:q.lng,latitude:null===q||void 0===q?void 0:q.lat,address:e.address_to,house:e.house_to,stage:e.stage_to,room:e.room_to},delivery_date:h()(e.delivery_date).format("YYYY-MM-DD HH:mm"),note:e.note,images:I.map((e=>e.name)),payment_id:e.payment_type.value},n="parcel-orders";y.A.create(l).then((e=>{(0,s.vA)((()=>{D((0,x.xj)({})),D((0,f.EK)({...J,nextUrl:n}))})),A.oR.success(w("successfully.created")),H("/".concat(n))})).finally((()=>B(!1)))},initialValues:{...J.data},onFinishFailed:e=>{const o=["","",""];e.errorFields.map((e=>e.name[0])).forEach((e=>{e.includes("_from")?o[0]="sender.details.invalid":e.includes("_to")?o[1]="receiver.details.invalid":o[2]="parcel.details.invalid"})),o.forEach((e=>{e&&A.oR.error(w(e))}))},children:[(0,j.jsx)("div",{className:"First-content"===u.C[T].content?"":"d-none",children:(0,j.jsx)(c.A,{form:O,next:P,location:U,setLocation:Z})}),(0,j.jsx)("div",{className:"Second-content"===u.C[T].content?"":"d-none",children:(0,j.jsx)(v.A,{form:O,next:P,prev:Q,location:q,setLocation:G})}),(0,j.jsx)("div",{className:"Third-content"===u.C[T].content?"":"d-none",children:(0,j.jsx)(m.A,{form:O,loading:V,prev:Q,locationFrom:U,locationTo:q,image:I,setImage:K})})]})})]})}}}]);