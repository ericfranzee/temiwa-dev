"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[9649],{69649:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var s=a(9950),l=a(54909),n=a(28429),i=a(70030),d=a(34967),o=a(80737),r=a(72243),c=a(48538),u=a(23263),m=a(52913),v=a(82706),h=a(69554),p=a(24513),x=a(9845),j=a(74623),g=a(91854),A=a(85923),y=a(76083),f=a(55386),k=a(28645),w=a(8168),b=a(88986),C=a(3462),_=a(99324),S=a(98890),I=a(59051),P=a.n(I),q=a(59233),N=a(87094),M=a(41988),z=a(55902),B=a(44414);function K(e){let{data:t,handleCancel:a,handleOk:l,visible:n}=e;const{t:d}=(0,i.B)(),[o]=q.A.useForm(),[r,u]=(0,s.useState)(!1);return(0,B.jsx)(v.A,{title:d(t.title),visible:n,onCancel:a,footer:[(0,B.jsx)(c.A,{type:"primary",onClick:()=>o.submit(),loading:r,children:d("save")}),(0,B.jsx)(c.A,{type:"default",onClick:a,children:d("cancel")})],children:(0,B.jsx)(q.A,{layout:"vertical",onFinish:e=>{u(!0);const t={...e,status:"canceled"};l(t)},form:o,children:(0,B.jsx)(q.A.Item,{children:(0,B.jsx)(N.A,{className:"mt-4",children:(0,B.jsx)(M.A,{span:24,children:(0,B.jsx)(q.A.Item,{name:"status_note",label:d("note"),rules:[{validator:(e,t)=>t?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(d("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(d("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(d("required")))}],children:(0,B.jsx)(z.A.TextArea,{maxLength:250,showCount:!0})})})})})})})}const T={type:"category"};function E(e){var t,a,l;let{parentId:d,type:I="main"}=e;const{t:q}=(0,i.B)(),{setIsModalVisible:N}=(0,s.useContext)(f.o),[M,z]=(0,s.useState)(!1),[E,Y]=(0,s.useState)(!1),[O,R]=(0,s.useState)(!1),[D,F]=(0,s.useState)(""),[H,L]=(0,s.useState)(null),U=(0,g.wA)(),V=(0,n.Zp)(),{activeMenu:X}=(0,g.d4)((e=>e.menu),g.bN),{data:Z,meta:G,loading:J,params:Q}=(0,g.d4)((e=>e.requestModels),g.bN),W=X.data,{uuid:$}=(0,n.g)(),ee={search:null===W||void 0===W?void 0:W.search,sort:null===W||void 0===W?void 0:W.sort,column:null===W||void 0===W?void 0:W.column,perPage:null===W||void 0===W?void 0:W.perPage,page:null===W||void 0===W?void 0:W.page,parent_id:d},[te,ae]=(0,s.useState)([{title:q("created.by"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:e=>(0,B.jsxs)("span",{children:[e.firstname," ",null===e||void 0===e?void 0:e.lastname," ",(0,B.jsx)("a",{href:"tel:".concat(null===e||void 0===e?void 0:e.phone),children:null===e||void 0===e?void 0:e.phone})]})},{title:q("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:e=>P()(e).format("YYYY-MM-DD HH:mm")},{title:q("name"),dataIndex:"name",key:"name",is_show:!0,render:(e,t)=>(0,B.jsxs)(o.A,{children:[t.model.translation.title," ",(0,B.jsx)(_.Kly,{})," ",t.data.title[t.model.translation.locale]]})},{title:q("image"),dataIndex:"img",key:"img",is_show:!0,render:(e,t)=>(0,B.jsxs)(o.A,{children:[(0,B.jsx)(r.A,{src:(0,h.A)(t.model.img),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0}),(0,B.jsx)(_.Kly,{}),(0,B.jsx)(r.A,{src:(0,h.A)(t.data.images.at(0)),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0})]})},{title:q("options"),key:"options",dataIndex:"options",is_show:!0,render:(e,t)=>(0,B.jsxs)(o.A,{children:[(0,B.jsx)(c.A,{icon:(0,B.jsx)(p.A,{}),onClick:()=>(e=>{U((0,j.X4)({url:"category-request/".concat(e.id),id:"request_edit",name:q("request.edit")})),V("/category-request/".concat(e.id),{state:{parentId:d,parentUuid:$}})})(t)}),"canceled"===(null===t||void 0===t?void 0:t.status)&&(null===t||void 0===t?void 0:t.status_note)&&(0,B.jsx)(c.A,{icon:(0,B.jsx)(x.A,{}),onClick:()=>{F(t.status_note),R(!0)}}),(0,B.jsx)(c.A,{type:"primary",onClick:()=>{L([{id:t.id,status:"approved"}]),N(!0)},children:q("accept")}),(0,B.jsx)(c.A,{type:"primary",danger:!0,onClick:()=>{L([{id:t.id,status:"canceled"}]),z(!0)},children:q("decline")})]})}]);(0,s.useEffect)((()=>{U((0,C.uj)(ee)),U((0,j.km)(X))}),[X.refetch]),(0,b.A)((()=>{U((0,C.uj)(ee))}),[X.data]);const se=e=>{Y(!0);const t={status:null===H||void 0===H?void 0:H.at(0).status,status_note:null===e||void 0===e?void 0:e.status_note};S.A.changeStatus(null===H||void 0===H?void 0:H.at(0).id,t).then((()=>{A.oR.success(q("successfully.changed")),U((0,C.uj)(T)),N(!1),L(null)})).finally((()=>{z(!1),Y(!1)}))},le={selectedRowKeys:H,onChange:e=>{L(e)}};return(0,B.jsxs)(u.A,{title:q("requests"),extra:(0,B.jsx)(o.A,{wrap:!0,children:(0,B.jsx)(k.A,{columns:te,setColumns:ae})}),children:[(0,B.jsx)(m.A,{scroll:{x:!0},rowSelection:le,columns:null===te||void 0===te?void 0:te.filter((e=>e.is_show)),dataSource:Z,pagination:{pageSize:Q.perPage,page:(null===(t=X.data)||void 0===t?void 0:t.page)||1,total:G.total,defaultCurrent:null===(a=X.data)||void 0===a?void 0:a.page,current:null===(l=X.data)||void 0===l?void 0:l.page},rowKey:e=>e.key,onChange:function(e,t,a){const{pageSize:s,current:l}=e,{field:n,order:i}=a,d=(0,w.A)(i);U((0,j.Ok)({activeMenu:X,data:{...X.data,perPage:s,page:l,column:n,sort:d}}))},loading:J}),(0,B.jsx)(y.A,{click:se,text:q("change.status"),setText:L,loading:E}),(0,B.jsx)(K,{data:{title:"decline"},visible:M,handleCancel:()=>z(!1),handleOk:se,laoding:E}),(0,B.jsxs)(v.A,{title:"Reject message",closable:!1,visible:O,footer:null,centered:!0,children:[(0,B.jsx)("p",{children:D}),(0,B.jsx)("div",{className:"d-flex justify-content-end",children:(0,B.jsx)(c.A,{type:"primary",className:"mr-2",onClick:()=>R(!1),children:q("close")})})]})]})}function Y(){var e;const{t:t}=(0,i.B)(),a=(0,n.zy)();return(0,B.jsxs)(l.A,{defaultActiveKey:(null===(e=a.state)||void 0===e?void 0:e.tab)||"list",destroyInactiveTabPane:!0,children:[(0,B.jsx)(l.A.TabPane,{tab:t("category.list"),children:(0,B.jsx)(d.A,{})},"list"),(0,B.jsx)(l.A.TabPane,{tab:t("requests"),children:(0,B.jsx)(E,{})},"request")]})}}}]);