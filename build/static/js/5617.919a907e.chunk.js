"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5617],{47992:(e,i,t)=>{t.d(i,{G:()=>d});var l=t(9950),a=t(95491),s=t.n(a),n=t(99674),r=t(90650),o=t(44414);const d=e=>{let{fetchOptions:i,debounceTimeout:t=400,onClear:a,refetchOptions:d=!1,...c}=e;const[u,m]=(0,l.useState)(!1),[p,v]=(0,l.useState)([]),h=(0,l.useMemo)((()=>s()((e=>{v([]),m(!0),i(e).then((e=>{v(e),m(!1)}))}),t)),[i,t]);return(0,o.jsx)(n.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),a&&a()},notFoundContent:u?(0,o.jsx)(r.A,{size:"small"}):"no results",...c,options:p,onFocus:()=>{p.length&&!d||h("")}})}},12196:(e,i,t)=>{t.d(i,{A:()=>j});var l=t(9950),a=t(59233),s=t(72243),n=t(87094),r=t(41988),o=t(80737),d=t(66876),c=t(82706),u=t(48538),m=t(8750),p=t(44070),v=t(48970),h=t(64924),g=t(70030),x=t(44414);const j=e=>{var i;let{mediaList:t,setMediaList:j,name:f="products"}=e;const{t:A}=(0,g.B)(),[b]=a.A.useForm(),[w,y]=(0,l.useState)(null),[N,k]=(0,l.useState)([]),[S,L]=(0,l.useState)(!1),[C,F]=(0,l.useState)(!1),q=async e=>{let{file:i,type:t}=e;i.name?(y("video"===t?(0,x.jsx)("video",{controls:!0,src:i.name,width:450,height:450}):(0,x.jsx)(s.A,{src:i.name,width:"100%",height:450,alt:"preview-img"})),L(!0)):y(null)},I=e=>({uid:e.title,name:e.title,status:"done",url:e.title,created:!0});return(0,x.jsxs)(n.A,{gutter:[24,24],children:[(0,x.jsx)(r.A,{span:24,children:(0,x.jsx)(o.A,{className:"align-items-start",children:(0,x.jsx)(d.A,{customRequest:e=>{let{file:i,onSuccess:t}=e;F(!0);const l=new FormData;l.append("image",i),l.append("type",f),h.A.upload(l).then((e=>{let{data:i}=e;j((e=>({...e,images:[...e.images,{...I(i),isVideo:!0}]}))),t("ok")}))},accept:"video/*",listType:"text",className:"video-upload",multiple:!1,fileList:[],children:(0,x.jsxs)("div",{className:"media-upload",children:[(0,x.jsx)(m.A,{})," ",(0,x.jsx)("span",{children:A("upload.video")})]})})})}),(0,x.jsx)(r.A,{span:24,children:null===t||void 0===t||null===(i=t.previews)||void 0===i?void 0:i.map(((e,i)=>{var l,a;return(0,x.jsxs)(o.A,{className:"uploaded-file",wrap:!0,children:[(0,x.jsx)("span",{className:"media-item",onClick:()=>q({type:"img",file:null===t||void 0===t?void 0:t.previews[i]}),children:null===t||void 0===t||null===(l=t.previews[i])||void 0===l?void 0:l.name}),(0,x.jsx)("span",{className:"media-item",onClick:()=>q({type:"video",file:null===t||void 0===t?void 0:t.images[i]}),children:null===t||void 0===t||null===(a=t.images[i])||void 0===a?void 0:a.name}),(0,x.jsx)(p.A,{className:"delete-media-item",onClick:()=>(e=>{const i=t.images.filter(((i,t)=>{if(t!==e)return i})),l=t.previews.filter(((i,t)=>{if(t!==e)return i}));j({images:i,previews:l})})(i)})]})}))}),(0,x.jsx)(c.A,{title:"Video Preview",visible:S,onCancel:()=>{L(!1)},footer:null,children:w}),(0,x.jsx)(c.A,{title:"Preview image",visible:C,footer:null,onCancel:()=>F(!1),children:(0,x.jsx)(a.A,{form:b,onFinish:()=>{j((e=>({...e,previews:[...e.previews,...N]}))),k([]),F(!1)},layout:"vertical",children:(0,x.jsxs)(n.A,{gutter:[24,24],children:[(0,x.jsx)(r.A,{span:24,children:(0,x.jsx)(a.A.Item,{label:A("preview.image"),name:"preview-image",rules:[{required:!(null!==N&&void 0!==N&&N.length),message:A("required")}],children:(0,x.jsx)(v.A,{type:f,imageList:N,setImageList:k,multiple:!1,text:"upload.image",form:b})})}),(0,x.jsx)(r.A,{span:24,className:"d-flex justify-content-end",children:(0,x.jsx)(u.A,{type:"primary",onClick:()=>b.submit(),children:A("save")})})]})})})]})}},31281:(e,i,t)=>{function l(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const l=e.map((e=>({[e.locale]:""===i["".concat(t,"[").concat(e.locale,"]")]?void 0:i["".concat(t,"[").concat(e.locale,"]")]})));return Object.assign({},...l)}t.d(i,{A:()=>l})},15617:(e,i,t)=>{t.r(i),t.d(i,{default:()=>g});var l=t(9950),a=t(28429),s=t(85923),n=t(59233),r=t(90650),o=t(91854),d=t(74623),c=t(5386),u=t(5302),m=t(70030),p=t(31281),v=t(82035),h=t(44414);const g=()=>{const{t:e}=(0,m.B)(),{activeMenu:i}=(0,o.d4)((e=>e.menu),o.bN),t=(0,o.wA)(),[g]=n.A.useForm(),x=(0,a.Zp)(),{id:j}=(0,a.g)(),[f,A]=(0,l.useState)(!1),{languages:b}=(0,o.d4)((e=>e.formLang),o.bN);(0,l.useEffect)((()=>()=>{const e=g.getFieldsValue(!0);t((0,d.Ok)({activeMenu:i,data:e}))}),[]);const w=e=>{const i={images:[],previews:[]},t=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.preview,url:e.preview}))),l=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:!0})));return i.previews=t,i.images=l,i};function y(e){if(!e)return{};const{translations:i}=e,t=b.map((e=>{var t,l;return{["title[".concat(e.locale,"]")]:null===(t=i.find((i=>i.locale===e.locale)))||void 0===t?void 0:t.title,["description[".concat(e.locale,"]")]:null===(l=i.find((i=>i.locale===e.locale)))||void 0===l?void 0:l.description}}));return Object.assign({},...t)}return(0,l.useEffect)((()=>{var e;i.refetch&&(e=j,A(!0),u.A.getById(e).then((e=>{var l;const a=e.data,s={...a,initialMediaFile:w(e.data.galleries),img:(n=a.galleries,n.map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:Boolean(e.preview)})))),products:null===a||void 0===a||null===(l=a.products)||void 0===l?void 0:l.map((e=>{var i;return{label:null===(i=e.translation)||void 0===i?void 0:i.title,value:e.id}})),...y(a)};var n;g.setFieldsValue(s),t((0,d.Ok)({activeMenu:i,data:s}))})).finally((()=>{t((0,d.km)(i)),A(!1)})))}),[i.refetch]),(0,h.jsx)(h.Fragment,{children:f?(0,h.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,h.jsx)(r.A,{size:"large",className:"py-5"})}):(0,h.jsx)(v.A,{form:g,handleSubmit:(l,a,n)=>{var r;const m=n.images.map((e=>e.name)),v=n.previews.map((e=>e.name)),h={products:null===(r=l.products)||void 0===r?void 0:r.map((e=>e.value)),images:[...m,...a.map((e=>e.name))],previews:v,clickable:!0,title:(0,p.A)(b,l,"title"),description:(0,p.A)(b,l,"description")},g="banners";return u.A.update(j,h).then((()=>{s.oR.success(e("successfully.updated")),(0,o.vA)((()=>{t((0,d.EK)({...i,nextUrl:g})),t((0,c.s)({}))})),x("/".concat(g))}))}})})}},82035:(e,i,t)=>{t.d(i,{A:()=>x});var l=t(9950),a=t(59233),s=t(87094),n=t(41988),r=t(23263),o=t(55902),d=t(48538),c=t(47992),u=t(48970),m=t(70030),p=t(91854),v=t(47933),h=t(12196),g=t(44414);function x(e){var i,t;let{form:x,handleSubmit:j}=e;const{t:f}=(0,m.B)(),{activeMenu:A}=(0,p.d4)((e=>e.menu),p.bN),{languages:b,defaultLang:w}=(0,p.d4)((e=>e.formLang),p.bN),[y,N]=(0,l.useState)((null===(i=A.data)||void 0===i?void 0:i.img.filter((e=>!e.isVideo)))||[]),[k,S]=(0,l.useState)(!1),[L,C]=(0,l.useState)((null===A||void 0===A||null===(t=A.data)||void 0===t?void 0:t.initialMediaFile)||{images:[],previews:[]});return(0,g.jsx)(a.A,{name:"banner-form",layout:"vertical",onFinish:e=>{S(!0),j(e,y,L).finally((()=>S(!1)))},form:x,initialValues:{clickable:!0,...A.data},className:"d-flex flex-column h-100",children:(0,g.jsxs)(s.A,{gutter:[24,24],children:[(0,g.jsx)(n.A,{span:16,children:(0,g.jsxs)(s.A,{gutter:[24,24],children:[(0,g.jsx)(n.A,{span:24,children:(0,g.jsx)(r.A,{title:f("images"),className:"h-100",children:(0,g.jsx)(a.A.Item,{rules:[{required:!y.length,message:f("required")}],label:f("image"),name:"images",children:(0,g.jsx)(u.A,{type:"banners",imageList:y,setImageList:N,form:x,length:"1",multiple:!1})})})}),(0,g.jsx)(n.A,{span:24,children:(0,g.jsx)(r.A,{title:f("video"),className:"h-100",children:(0,g.jsx)(h.A,{name:"banners",form:x,mediaList:L,setMediaList:C})})})]})}),(0,g.jsx)(n.A,{span:8,children:(0,g.jsxs)(r.A,{title:f("basic.info"),className:"h-100",children:[b.map((e=>(0,g.jsx)(a.A.Item,{label:f("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===w,message:f("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(f("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(f("must.be.at.least.2"))):Promise.resolve()}],hidden:e.locale!==w,children:(0,g.jsx)(o.A,{maxLength:50})},"title"+e.locale))),b.map((e=>(0,g.jsx)(a.A.Item,{label:f("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===w,message:f("required")},{validator:(e,i)=>i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(f("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(f("must.be.at.least.5"))):Promise.resolve()}],hidden:e.locale!==w,children:(0,g.jsx)(o.A.TextArea,{maxLength:150})},"description"+e.locale))),(0,g.jsx)(a.A.Item,{label:f("products"),name:"products",rules:[{required:!0,message:f("required")}],children:(0,g.jsx)(c.G,{mode:"multiple",fetchOptions:function(e){const i={search:e,perPage:10,status:"published"};return v.A.getAll(i).then((e=>e.data.map((e=>{var i;return{label:null===e||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title,value:e.id,key:e.id}}))))},debounceTimeout:200})})]})}),(0,g.jsx)(n.A,{span:24,children:(0,g.jsx)("div",{className:"d-flex justify-content-end",children:(0,g.jsx)("div",{className:"pb-5",children:(0,g.jsx)(d.A,{type:"primary",htmlType:"submit",loading:k,children:f("submit")})})})})]})})}}}]);